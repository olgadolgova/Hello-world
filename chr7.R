setwd("~/Dropbox (CRG)/Bioinformatics/PiRNA/populations/new_clusters")
library (PopGenome)

Clusters.all <- readVCF("new_chr7.vcf.gz", numcols=10000, tid="7", from=6198867, to=148956111, include.unknown = TRUE)
Clusters.all <- set.outgroup(Clusters.all,c("Chimp"), diploid=TRUE)
get.sum.data(Clusters.all) 

#Divergence calculation
bial <- get.biallelic.matrix(Clusters.all,1) # Biallelic matrix
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
div <- bial[n+1,] == 1
divsites <- sum (div & !polym,na.rm=T)
divsites
D <- divsites/51255
D

#Neutrality statistics
Clusters.all <- neutrality.stats(Clusters.all, do.R2 = TRUE)
get.neutrality(Clusters.all, theta=TRUE) [[1]]
Mu <- (Clusters.all@theta_Watterson/51255)/40000
Mu

#Diversities
Clusters.all <- diversity.stats(Clusters.all, pi=TRUE) 
get.diversity(Clusters.all) [[1]]

#Pi
individuals <- get.individuals(Clusters.all)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 

bial <- get.biallelic.matrix(Clusters.all,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters.all@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 6198867:148956111))) # N polyallelic sites in that region
m <- 51255 -sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#2.Splitting data into clusters
Clusters.all.split <- splitting.data (Clusters.all, positions = list(c(6198867:6207568), c(6617659:6633659), c(27493034:27502607), c(35732666:35739378), c(56870712:56905707), c(63200389:63215405), c(64293379:64300618), c(66362919:66374773), c(74437156:74447091), c(102908736:102923212), c(117852321:117869066), c(148943506:148956111)), type=2)
Clusters.all.split <- neutrality.stats(Clusters.all.split, do.R2 = TRUE)
get.neutrality(Clusters.all.split, theta=TRUE) [[1]]
Clusters.all.split <- diversity.stats(Clusters.all.split, pi=TRUE)
get.diversity(Clusters.all.split) [[1]]

#3. Establishing populations (only females)
AFR <- c("HG01880", "HG01883", "HG01886", "HG01889", "HG01894", "HG01896", "HG01956", "HG01958", "HG01985", "HG01989", "HG02010", "HG02012", "HG02052", "HG02054", "HG02095", "HG02108", "HG02111", "HG02144", "HG02256", "HG02282", "HG02308", "HG02309", "HG02315", "HG02318", "HG02322", "HG02325", "HG02337", "HG02339", "HG02419", "HG02427", "HG02450", "HG02462", "HG02465", "HG02476", "HG02477", "HG02479", "HG02485", "HG02497", "HG02502", "HG02505", "HG02508", "HG02511", "HG02537", "HG02546", "HG02549", "HG02555", "HG02558", "HG02562", "HG02568", "HG02571", "HG02574", "HG02577", "HG02580", "HG02583", "HG02586", "HG02589", "HG02595", "HG02611", "HG02614", "HG02621", "HG02629", "HG02635", "HG02646", "HG02667", "HG02676", "HG02679", "HG02703", "HG02716", "HG02722", "HG02757", "HG02760", "HG02763", "HG02769", "HG02772", "HG02799", "HG02808", "HG02811", "HG02814", "HG02817", "HG02820", "HG02837", "HG02840", "HG02855", "HG02861", "HG02870", "HG02879", "HG02882", "HG02885", "HG02888", "HG02891", "HG02922", "HG02943", "HG02946", "HG02952", "HG02970", "HG02974", "HG02976", "HG02979", "HG02983", "HG03025", "HG03028", "HG03040", "HG03049", "HG03052", "HG03055", "HG03058", "HG03061", "HG03064", "HG03073", "HG03079", "HG03082", "HG03086", "HG03088", "HG03091", "HG03095", "HG03099", "HG03105", "HG03108", "HG03111", "HG03117", "HG03123", "HG03126", "HG03129", "HG03132", "HG03135", "HG03159", "HG03162", "HG03168", "HG03189", "HG03195", "HG03198", "HG03212", "HG03267", "HG03270", "HG03279", "HG03291", "HG03294", "HG03297", "HG03303", "HG03342", "HG03351", "HG03363", "HG03366", "HG03369", "HG03372", "HG03378", "HG03401", "HG03410", "HG03419", "HG03437", "HG03446", "HG03449", "HG03452", "HG03455", "HG03461", "HG03470", "HG03473", "HG03476", "HG03479", "HG03485", "HG03499", "HG03511", "HG03514", "HG03517", "HG03520", "HG03539", "HG03548", "HG03558", "HG03563", "HG03567", "HG03572", "HG03575", "HG03578", "HG03583", "NA18488", "NA18489", "NA18499", "NA18502", "NA18505", "NA18508", "NA18511", "NA18517", "NA18520", "NA18523", "NA18858", "NA18861", "NA18864", "NA18867", "NA18870", "NA18873", "NA18876", "NA18878", "NA18881", "NA18907", "NA18909", "NA18912", "NA18916", "NA18924", "NA18933", "NA19017", "NA19019", "NA19023", "NA19024", "NA19030", "NA19036", "NA19037", "NA19038", "NA19093", "NA19095", "NA19099", "NA19102", "NA19108", "NA19114", "NA19116", "NA19118", "NA19129", "NA19131", "NA19137", "NA19143", "NA19147", "NA19149", "NA19152", "NA19159", "NA19172", "NA19185", "NA19190", "NA19197", "NA19201", "NA19204", "NA19206", "NA19209", "NA19214", "NA19222", "NA19225", "NA19235", "NA19238", "NA19247", "NA19310", "NA19314", "NA19315", "NA19321", "NA19323", "NA19324", "NA19327", "NA19328", "NA19332", "NA19338", "NA19351", "NA19355", "NA19377", "NA19378", "NA19390", "NA19391", "NA19399", "NA19401", "NA19403", "NA19404", "NA19431", "NA19435", "NA19436", "NA19437", "NA19438", "NA19439", "NA19440", "NA19445", "NA19446", "NA19449", "NA19456", "NA19457", "NA19462", "NA19463", "NA19467", "NA19468", "NA19472", "NA19473", "NA19474", "NA19475", "NA19701", "NA19707", "NA19712", "NA19819", "NA19835", "NA19901", "NA19909", "NA19914", "NA19917", "NA19921", "NA19923", "NA20127", "NA20274", "NA20276", "NA20282", "NA20287", "NA20289", "NA20294", "NA20317", "NA20321", "NA20332", "NA20334", "NA20339", "NA20357", "NA20359", "NA20412")
AMR <- c("HG00551", "HG00554", "HG00638", "HG00641", "HG00732", "HG00734", "HG00737", "HG00740", "HG00743", "HG01049", "HG01052", "HG01055", "HG01058", "HG01064", "HG01067", "HG01070", "HG01073", "HG01077", "HG01080", "HG01086", "HG01089", "HG01092", "HG01095", "HG01098", "HG01102", "HG01105", "HG01108", "HG01111", "HG01113", "HG01119", "HG01122", "HG01125", "HG01131", "HG01137", "HG01140", "HG01149", "HG01162", "HG01168", "HG01171", "HG01174", "HG01177", "HG01183", "HG01188", "HG01191", "HG01205", "HG01242", "HG01248", "HG01251", "HG01254", "HG01257", "HG01269", "HG01272", "HG01281", "HG01284", "HG01303", "HG01312", "HG01323", "HG01326", "HG01342", "HG01345", "HG01351", "HG01357", "HG01360", "HG01363", "HG01366", "HG01369", "HG01372", "HG01375", "HG01378", "HG01384", "HG01390", "HG01393", "HG01396", "HG01403", "HG01414", "HG01432", "HG01435", "HG01441", "HG01444", "HG01447", "HG01456", "HG01459", "HG01462", "HG01474", "HG01486", "HG01489", "HG01492", "HG01495", "HG01551", "HG01566", "HG01572", "HG01578", "HG01893", "HG01918", "HG01921", "HG01924", "HG01927", "HG01933", "HG01936", "HG01939", "HG01942", "HG01945", "HG01948", "HG01954", "HG01965", "HG01968", "HG01971", "HG01973", "HG01976", "HG01980", "HG01992", "HG01997", "HG02003", "HG02006", "HG02089", "HG02102", "HG02105", "HG02147", "HG02252", "HG02260", "HG02266", "HG02272", "HG02275", "HG02278", "HG02286", "HG02292", "HG02298", "HG02301", "HG02312", "HG02345", "HG02348", "HG02425", "NA19651", "NA19654", "NA19663", "NA19669", "NA19678", "NA19681", "NA19684", "NA19716", "NA19719", "NA19722", "NA19725", "NA19728", "NA19731", "NA19734", "NA19740", "NA19746", "NA19749", "NA19752", "NA19755", "NA19758", "NA19761", "NA19764", "NA19770", "NA19773", "NA19776", "NA19779", "NA19782", "NA19785", "NA19788", "NA19794")
EAS <- c("HG00404", "HG00407", "HG00410", "HG00419", "HG00422", "HG00428", "HG00437", "HG00443", "HG00446", "HG00449", "HG00452", "HG00458", "HG00464", "HG00473", "HG00476", "HG00479", "HG00513", "HG00525", "HG00531", "HG00534", "HG00537", "HG00543", "HG00557", "HG00560", "HG00566", "HG00584", "HG00590", "HG00593", "HG00596", "HG00599", "HG00608", "HG00611", "HG00614", "HG00620", "HG00623", "HG00626", "HG00629", "HG00632", "HG00651", "HG00654", "HG00657", "HG00663", "HG00672", "HG00675", "HG00684", "HG00690", "HG00693", "HG00699", "HG00705", "HG00717", "HG00729", "HG00759", "HG00851", "HG00864", "HG00867", "HG00879", "HG00956", "HG00978", "HG01029", "HG01046", "HG01595", "HG01597", "HG01598", "HG01599", "HG01600", "HG01794", "HG01796", "HG01797", "HG01798", "HG01799", "HG01800", "HG01801", "HG01802", "HG01804", "HG01805", "HG01806", "HG01807", "HG01808", "HG01809", "HG01812", "HG01813", "HG01815", "HG01817", "HG01841", "HG01843", "HG01845", "HG01847", "HG01848", "HG01850", "HG01851", "HG01853", "HG01855", "HG01857", "HG01858", "HG01859", "HG01862", "HG01863", "HG01868", "HG01869", "HG01870", "HG01871", "HG01874", "HG01878", "HG02016", "HG02019", "HG02025", "HG02028", "HG02031", "HG02048", "HG02049", "HG02057", "HG02069", "HG02072", "HG02075", "HG02078", "HG02081", "HG02084", "HG02086", "HG02087", "HG02113", "HG02121", "HG02127", "HG02130", "HG02133", "HG02136", "HG02139", "HG02140", "HG02142", "HG02151", "HG02152", "HG02153", "HG02154", "HG02155", "HG02156", "HG02164", "HG02165", "HG02178", "HG02179", "HG02180", "HG02181", "HG02182", "HG02184", "HG02185", "HG02186", "HG02187", "HG02190", "HG02513", "HG02522", "NA18525", "NA18526", "NA18528", "NA18531", "NA18532", "NA18533", "NA18535", "NA18537", "NA18538", "NA18539", "NA18541", "NA18542", "NA18545", "NA18547", "NA18550", "NA18552", "NA18553", "NA18555", "NA18560", "NA18564", "NA18565", "NA18566", "NA18567", "NA18570", "NA18571", "NA18573", "NA18574", "NA18577", "NA18579", "NA18582", "NA18591", "NA18592", "NA18593", "NA18595", "NA18596", "NA18597", "NA18599", "NA18602", "NA18610", "NA18614", "NA18615", "NA18616", "NA18617", "NA18618", "NA18619", "NA18625", "NA18626", "NA18627", "NA18628", "NA18630", "NA18631", "NA18634", "NA18640", "NA18641", "NA18642", "NA18644", "NA18646", "NA18939", "NA18941", "NA18942", "NA18946", "NA18947", "NA18949", "NA18950", "NA18951", "NA18954", "NA18956", "NA18957", "NA18963", "NA18964", "NA18968", "NA18969", "NA18972", "NA18973", "NA18975", "NA18976", "NA18978", "NA18979", "NA18980", "NA18981", "NA18991", "NA18993", "NA18997", "NA18998", "NA18999", "NA19001", "NA19002", "NA19003", "NA19010", "NA19011", "NA19054", "NA19057", "NA19059", "NA19064", "NA19065", "NA19074", "NA19077", "NA19078", "NA19080", "NA19081", "NA19084", "NA19087", "NA19090")
EUR <- c("HG00097", "HG00099", "HG00102", "HG00110", "HG00111", "HG00118", "HG00120", "HG00121", "HG00122", "HG00125", "HG00127", "HG00128", "HG00130", "HG00132", "HG00133", "HG00137", "HG00146", "HG00150", "HG00154", "HG00158", "HG00171", "HG00173", "HG00174", "HG00176", "HG00177", "HG00178", "HG00179", "HG00180", "HG00231", "HG00232", "HG00233", "HG00235", "HG00236", "HG00237", "HG00238", "HG00239", "HG00245", "HG00250", "HG00253", "HG00254", "HG00255", "HG00257", "HG00258", "HG00259", "HG00261", "HG00262", "HG00263", "HG00266", "HG00268", "HG00269", "HG00272", "HG00274", "HG00275", "HG00276", "HG00281", "HG00282", "HG00285", "HG00288", "HG00304", "HG00306", "HG00309", "HG00313", "HG00315", "HG00318", "HG00319", "HG00320", "HG00323", "HG00324", "HG00326", "HG00327", "HG00328", "HG00330", "HG00331", "HG00332", "HG00334", "HG00337", "HG00339", "HG00343", "HG00344", "HG00346", "HG00349", "HG00350", "HG00353", "HG00355", "HG00356", "HG00357", "HG00361", "HG00362", "HG00364", "HG00365", "HG00367", "HG00368", "HG00373", "HG00376", "HG00378", "HG00379", "HG00380", "HG00381", "HG00383", "HG00384", "HG01501", "HG01504", "HG01507", "HG01510", "HG01513", "HG01516", "HG01519", "HG01522", "HG01525", "HG01528", "HG01531", "HG01537", "HG01602", "HG01605", "HG01607", "HG01612", "HG01613", "HG01618", "HG01620", "HG01623", "HG01626", "HG01628", "HG01632", "HG01668", "HG01670", "HG01673", "HG01676", "HG01679", "HG01684", "HG01685", "HG01695", "HG01697", "HG01702", "HG01704", "HG01707", "HG01710", "HG01746", "HG01757", "HG01762", "HG01766", "HG01768", "HG01770", "HG01773", "HG01776", "HG01779", "HG01784", "HG01786", "HG01790", "HG02215", "HG02220", "HG02223", "HG02230", "HG02232", "HG02235", "HG02239", "NA06985", "NA06989", "NA07000", "NA07037", "NA07056", "NA10847", "NA11830", "NA11832", "NA11840", "NA11892", "NA11894", "NA11918", "NA11920", "NA11933", "NA11995", "NA12004", "NA12006", "NA12044", "NA12046", "NA12058", "NA12156", "NA12234", "NA12249", "NA12273", "NA12275", "NA12283", "NA12287", "NA12341", "NA12348", "NA12400", "NA12414", "NA12489", "NA12717", "NA12718", "NA12749", "NA12751", "NA12761", "NA12763", "NA12776", "NA12778", "NA12813", "NA12815", "NA12828", "NA12830", "NA12843", "NA12873", "NA12878", "NA12890", "NA20502", "NA20503", "NA20504", "NA20505", "NA20506", "NA20507", "NA20508", "NA20514", "NA20517", "NA20522", "NA20529", "NA20530", "NA20531", "NA20533", "NA20535", "NA20540", "NA20541", "NA20542", "NA20582", "NA20585", "NA20587", "NA20589", "NA20753", "NA20756", "NA20757", "NA20760", "NA20761", "NA20764", "NA20766", "NA20768", "NA20769", "NA20771", "NA20772", "NA20773", "NA20774", "NA20775", "NA20790", "NA20795", "NA20797", "NA20799", "NA20800", "NA20802", "NA20804", "NA20807", "NA20808", "NA20813", "NA20818", "NA20819", "NA20821", "NA20822", "NA20826", "NA20828", "NA20832")
SAS <- c("HG02491", "HG02494", "HG02601", "HG02652", "HG02661", "HG02688", "HG02697", "HG02725", "HG02728", "HG02731", "HG02737", "HG02775", "HG02778", "HG02784", "HG02787", "HG02790", "HG02793", "HG03007", "HG03016", "HG03235", "HG03238", "HG03488", "HG03491", "HG03589", "HG03595", "HG03598", "HG03604", "HG03607", "HG03611", "HG03616", "HG03631", "HG03634", "HG03640", "HG03642", "HG03643", "HG03645", "HG03653", "HG03668", "HG03673", "HG03684", "HG03689", "HG03692", "HG03698", "HG03703", "HG03706", "HG03709", "HG03714", "HG03717", "HG03730", "HG03731", "HG03736", "HG03757", "HG03760", "HG03762", "HG03765", "HG03770", "HG03772", "HG03774", "HG03780", "HG03781", "HG03782", "HG03787", "HG03789", "HG03793", "HG03796", "HG03802", "HG03805", "HG03808", "HG03814", "HG03817", "HG03823", "HG03826", "HG03829", "HG03832", "HG03849", "HG03857", "HG03861", "HG03863", "HG03868", "HG03874", "HG03882", "HG03886", "HG03888", "HG03897", "HG03907", "HG03910", "HG03913", "HG03916", "HG03919", "HG03922", "HG03925", "HG03928", "HG03931", "HG03934", "HG03937", "HG03940", "HG03945", "HG03947", "HG03949", "HG03951", "HG03968", "HG03973", "HG03977", "HG03986", "HG03989", "HG04001", "HG04014", "HG04018", "HG04025", "HG04026", "HG04042", "HG04047", "HG04059", "HG04062", "HG04063", "HG04075", "HG04076", "HG04090", "HG04099", "HG04118", "HG04141", "HG04144", "HG04153", "HG04156", "HG04159", "HG04171", "HG04177", "HG04180", "HG04183", "HG04186", "HG04189", "HG04195", "HG04200", "HG04202", "HG04212", "HG04214", "HG04216", "HG04227", "NA20847", "NA20849", "NA20851", "NA20853", "NA20854", "NA20856", "NA20859", "NA20862", "NA20868", "NA20869", "NA20872", "NA20874", "NA20875", "NA20876", "NA20877", "NA20878", "NA20881", "NA20882", "NA20888", "NA20892", "NA20894", "NA20896", "NA20899", "NA20902", "NA20906", "NA20908", "NA20910", "NA21086", "NA21088", "NA21089", "NA21097", "NA21101", "NA21102", "NA21103", "NA21106", "NA21108", "NA21110", "NA21120", "NA21122", "NA21125", "NA21137", "NA21141", "NA21143", "NA21144")
Clusters.all <- set.populations(Clusters.all,list(AFR,AMR,EAS,EUR,SAS), diploid = TRUE)
Clusters.all <- set.outgroup(Clusters.all, c("Chimp"), diploid=TRUE)

#F_ST
Clusters.all <- F_ST.stats(Clusters.all, mode="nucleotide")
get.F_ST(Clusters.all, mode="nucleotide", pairwise=TRUE) [[1]]
Clusters.all@nuc.F_ST.vs.all [[1]]
Clusters.all@nuc.F_ST.vs.all [[2]]
Clusters.all@nuc.F_ST.vs.all [[3]]
Clusters.all@nuc.F_ST.vs.all [[4]]
Clusters.all@nuc.F_ST.vs.all [[5]]

#Splitting data
Clusters.all.split <- splitting.data (Clusters.all, positions = list(c(6198867:6207568), c(6617659:6633659), c(27493034:27502607), c(35732666:35739378), c(56870712:56905707), c(63200389:63215405), c(64293379:64300618), c(66362919:66374773), c(74437156:74447091), c(102908736:102923212), c(117852321:117869066), c(148943506:148956111)), type=2)
Clusters.all.split <- F_ST.stats(Clusters.all.split, mode="nucleotide")
get.F_ST(Clusters.all.split, mode="nucleotide", pairwise=TRUE) [[1]]

##################################Analysis per cluster#########################################

#Cluster_1
Clusters_1 <- readVCF("new_chr7.vcf.gz", numcols=10000, tid="7", from=6198867, to=6207568, include.unknown = TRUE)
Clusters_1 <- set.outgroup(Clusters_1, c("Chimp"), diploid=TRUE)
get.sum.data(Clusters_1) 

#Divergence
bial <- get.biallelic.matrix(Clusters_1,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites1 <- sum (div & !polym,na.rm=T)
divsites1
D <- divsites1/212
D

#Mutation rate
Clusters_1 <- neutrality.stats(Clusters_1)
Mu <- (Clusters_1@theta_Watterson/212)/40000
Mu

#Pi_Cluster1
individuals <- get.individuals(Clusters_1)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 

bial <- get.biallelic.matrix(Clusters_1,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters_1@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 6198867:6207568))) # N polyallelic sites in that region
m <- 212-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

AFR <- c("HG01880", "HG01883", "HG01886", "HG01889", "HG01894", "HG01896", "HG01956", "HG01958", "HG01985", "HG01989", "HG02010", "HG02012", "HG02052", "HG02054", "HG02095", "HG02108", "HG02111", "HG02144", "HG02256", "HG02282", "HG02308", "HG02309", "HG02315", "HG02318", "HG02322", "HG02325", "HG02337", "HG02339", "HG02419", "HG02427", "HG02450", "HG02462", "HG02465", "HG02476", "HG02477", "HG02479", "HG02485", "HG02497", "HG02502", "HG02505", "HG02508", "HG02511", "HG02537", "HG02546", "HG02549", "HG02555", "HG02558", "HG02562", "HG02568", "HG02571", "HG02574", "HG02577", "HG02580", "HG02583", "HG02586", "HG02589", "HG02595", "HG02611", "HG02614", "HG02621", "HG02629", "HG02635", "HG02646", "HG02667", "HG02676", "HG02679", "HG02703", "HG02716", "HG02722", "HG02757", "HG02760", "HG02763", "HG02769", "HG02772", "HG02799", "HG02808", "HG02811", "HG02814", "HG02817", "HG02820", "HG02837", "HG02840", "HG02855", "HG02861", "HG02870", "HG02879", "HG02882", "HG02885", "HG02888", "HG02891", "HG02922", "HG02943", "HG02946", "HG02952", "HG02970", "HG02974", "HG02976", "HG02979", "HG02983", "HG03025", "HG03028", "HG03040", "HG03049", "HG03052", "HG03055", "HG03058", "HG03061", "HG03064", "HG03073", "HG03079", "HG03082", "HG03086", "HG03088", "HG03091", "HG03095", "HG03099", "HG03105", "HG03108", "HG03111", "HG03117", "HG03123", "HG03126", "HG03129", "HG03132", "HG03135", "HG03159", "HG03162", "HG03168", "HG03189", "HG03195", "HG03198", "HG03212", "HG03267", "HG03270", "HG03279", "HG03291", "HG03294", "HG03297", "HG03303", "HG03342", "HG03351", "HG03363", "HG03366", "HG03369", "HG03372", "HG03378", "HG03401", "HG03410", "HG03419", "HG03437", "HG03446", "HG03449", "HG03452", "HG03455", "HG03461", "HG03470", "HG03473", "HG03476", "HG03479", "HG03485", "HG03499", "HG03511", "HG03514", "HG03517", "HG03520", "HG03539", "HG03548", "HG03558", "HG03563", "HG03567", "HG03572", "HG03575", "HG03578", "HG03583", "NA18488", "NA18489", "NA18499", "NA18502", "NA18505", "NA18508", "NA18511", "NA18517", "NA18520", "NA18523", "NA18858", "NA18861", "NA18864", "NA18867", "NA18870", "NA18873", "NA18876", "NA18878", "NA18881", "NA18907", "NA18909", "NA18912", "NA18916", "NA18924", "NA18933", "NA19017", "NA19019", "NA19023", "NA19024", "NA19030", "NA19036", "NA19037", "NA19038", "NA19093", "NA19095", "NA19099", "NA19102", "NA19108", "NA19114", "NA19116", "NA19118", "NA19129", "NA19131", "NA19137", "NA19143", "NA19147", "NA19149", "NA19152", "NA19159", "NA19172", "NA19185", "NA19190", "NA19197", "NA19201", "NA19204", "NA19206", "NA19209", "NA19214", "NA19222", "NA19225", "NA19235", "NA19238", "NA19247", "NA19310", "NA19314", "NA19315", "NA19321", "NA19323", "NA19324", "NA19327", "NA19328", "NA19332", "NA19338", "NA19351", "NA19355", "NA19377", "NA19378", "NA19390", "NA19391", "NA19399", "NA19401", "NA19403", "NA19404", "NA19431", "NA19435", "NA19436", "NA19437", "NA19438", "NA19439", "NA19440", "NA19445", "NA19446", "NA19449", "NA19456", "NA19457", "NA19462", "NA19463", "NA19467", "NA19468", "NA19472", "NA19473", "NA19474", "NA19475", "NA19701", "NA19707", "NA19712", "NA19819", "NA19835", "NA19901", "NA19909", "NA19914", "NA19917", "NA19921", "NA19923", "NA20127", "NA20274", "NA20276", "NA20282", "NA20287", "NA20289", "NA20294", "NA20317", "NA20321", "NA20332", "NA20334", "NA20339", "NA20357", "NA20359", "NA20412")
AMR <- c("HG00551", "HG00554", "HG00638", "HG00641", "HG00732", "HG00734", "HG00737", "HG00740", "HG00743", "HG01049", "HG01052", "HG01055", "HG01058", "HG01064", "HG01067", "HG01070", "HG01073", "HG01077", "HG01080", "HG01086", "HG01089", "HG01092", "HG01095", "HG01098", "HG01102", "HG01105", "HG01108", "HG01111", "HG01113", "HG01119", "HG01122", "HG01125", "HG01131", "HG01137", "HG01140", "HG01149", "HG01162", "HG01168", "HG01171", "HG01174", "HG01177", "HG01183", "HG01188", "HG01191", "HG01205", "HG01242", "HG01248", "HG01251", "HG01254", "HG01257", "HG01269", "HG01272", "HG01281", "HG01284", "HG01303", "HG01312", "HG01323", "HG01326", "HG01342", "HG01345", "HG01351", "HG01357", "HG01360", "HG01363", "HG01366", "HG01369", "HG01372", "HG01375", "HG01378", "HG01384", "HG01390", "HG01393", "HG01396", "HG01403", "HG01414", "HG01432", "HG01435", "HG01441", "HG01444", "HG01447", "HG01456", "HG01459", "HG01462", "HG01474", "HG01486", "HG01489", "HG01492", "HG01495", "HG01551", "HG01566", "HG01572", "HG01578", "HG01893", "HG01918", "HG01921", "HG01924", "HG01927", "HG01933", "HG01936", "HG01939", "HG01942", "HG01945", "HG01948", "HG01954", "HG01965", "HG01968", "HG01971", "HG01973", "HG01976", "HG01980", "HG01992", "HG01997", "HG02003", "HG02006", "HG02089", "HG02102", "HG02105", "HG02147", "HG02252", "HG02260", "HG02266", "HG02272", "HG02275", "HG02278", "HG02286", "HG02292", "HG02298", "HG02301", "HG02312", "HG02345", "HG02348", "HG02425", "NA19651", "NA19654", "NA19663", "NA19669", "NA19678", "NA19681", "NA19684", "NA19716", "NA19719", "NA19722", "NA19725", "NA19728", "NA19731", "NA19734", "NA19740", "NA19746", "NA19749", "NA19752", "NA19755", "NA19758", "NA19761", "NA19764", "NA19770", "NA19773", "NA19776", "NA19779", "NA19782", "NA19785", "NA19788", "NA19794")
EAS <- c("HG00404", "HG00407", "HG00410", "HG00419", "HG00422", "HG00428", "HG00437", "HG00443", "HG00446", "HG00449", "HG00452", "HG00458", "HG00464", "HG00473", "HG00476", "HG00479", "HG00513", "HG00525", "HG00531", "HG00534", "HG00537", "HG00543", "HG00557", "HG00560", "HG00566", "HG00584", "HG00590", "HG00593", "HG00596", "HG00599", "HG00608", "HG00611", "HG00614", "HG00620", "HG00623", "HG00626", "HG00629", "HG00632", "HG00651", "HG00654", "HG00657", "HG00663", "HG00672", "HG00675", "HG00684", "HG00690", "HG00693", "HG00699", "HG00705", "HG00717", "HG00729", "HG00759", "HG00851", "HG00864", "HG00867", "HG00879", "HG00956", "HG00978", "HG01029", "HG01046", "HG01595", "HG01597", "HG01598", "HG01599", "HG01600", "HG01794", "HG01796", "HG01797", "HG01798", "HG01799", "HG01800", "HG01801", "HG01802", "HG01804", "HG01805", "HG01806", "HG01807", "HG01808", "HG01809", "HG01812", "HG01813", "HG01815", "HG01817", "HG01841", "HG01843", "HG01845", "HG01847", "HG01848", "HG01850", "HG01851", "HG01853", "HG01855", "HG01857", "HG01858", "HG01859", "HG01862", "HG01863", "HG01868", "HG01869", "HG01870", "HG01871", "HG01874", "HG01878", "HG02016", "HG02019", "HG02025", "HG02028", "HG02031", "HG02048", "HG02049", "HG02057", "HG02069", "HG02072", "HG02075", "HG02078", "HG02081", "HG02084", "HG02086", "HG02087", "HG02113", "HG02121", "HG02127", "HG02130", "HG02133", "HG02136", "HG02139", "HG02140", "HG02142", "HG02151", "HG02152", "HG02153", "HG02154", "HG02155", "HG02156", "HG02164", "HG02165", "HG02178", "HG02179", "HG02180", "HG02181", "HG02182", "HG02184", "HG02185", "HG02186", "HG02187", "HG02190", "HG02513", "HG02522", "NA18525", "NA18526", "NA18528", "NA18531", "NA18532", "NA18533", "NA18535", "NA18537", "NA18538", "NA18539", "NA18541", "NA18542", "NA18545", "NA18547", "NA18550", "NA18552", "NA18553", "NA18555", "NA18560", "NA18564", "NA18565", "NA18566", "NA18567", "NA18570", "NA18571", "NA18573", "NA18574", "NA18577", "NA18579", "NA18582", "NA18591", "NA18592", "NA18593", "NA18595", "NA18596", "NA18597", "NA18599", "NA18602", "NA18610", "NA18614", "NA18615", "NA18616", "NA18617", "NA18618", "NA18619", "NA18625", "NA18626", "NA18627", "NA18628", "NA18630", "NA18631", "NA18634", "NA18640", "NA18641", "NA18642", "NA18644", "NA18646", "NA18939", "NA18941", "NA18942", "NA18946", "NA18947", "NA18949", "NA18950", "NA18951", "NA18954", "NA18956", "NA18957", "NA18963", "NA18964", "NA18968", "NA18969", "NA18972", "NA18973", "NA18975", "NA18976", "NA18978", "NA18979", "NA18980", "NA18981", "NA18991", "NA18993", "NA18997", "NA18998", "NA18999", "NA19001", "NA19002", "NA19003", "NA19010", "NA19011", "NA19054", "NA19057", "NA19059", "NA19064", "NA19065", "NA19074", "NA19077", "NA19078", "NA19080", "NA19081", "NA19084", "NA19087", "NA19090")
EUR <- c("HG00097", "HG00099", "HG00102", "HG00110", "HG00111", "HG00118", "HG00120", "HG00121", "HG00122", "HG00125", "HG00127", "HG00128", "HG00130", "HG00132", "HG00133", "HG00137", "HG00146", "HG00150", "HG00154", "HG00158", "HG00171", "HG00173", "HG00174", "HG00176", "HG00177", "HG00178", "HG00179", "HG00180", "HG00231", "HG00232", "HG00233", "HG00235", "HG00236", "HG00237", "HG00238", "HG00239", "HG00245", "HG00250", "HG00253", "HG00254", "HG00255", "HG00257", "HG00258", "HG00259", "HG00261", "HG00262", "HG00263", "HG00266", "HG00268", "HG00269", "HG00272", "HG00274", "HG00275", "HG00276", "HG00281", "HG00282", "HG00285", "HG00288", "HG00304", "HG00306", "HG00309", "HG00313", "HG00315", "HG00318", "HG00319", "HG00320", "HG00323", "HG00324", "HG00326", "HG00327", "HG00328", "HG00330", "HG00331", "HG00332", "HG00334", "HG00337", "HG00339", "HG00343", "HG00344", "HG00346", "HG00349", "HG00350", "HG00353", "HG00355", "HG00356", "HG00357", "HG00361", "HG00362", "HG00364", "HG00365", "HG00367", "HG00368", "HG00373", "HG00376", "HG00378", "HG00379", "HG00380", "HG00381", "HG00383", "HG00384", "HG01501", "HG01504", "HG01507", "HG01510", "HG01513", "HG01516", "HG01519", "HG01522", "HG01525", "HG01528", "HG01531", "HG01537", "HG01602", "HG01605", "HG01607", "HG01612", "HG01613", "HG01618", "HG01620", "HG01623", "HG01626", "HG01628", "HG01632", "HG01668", "HG01670", "HG01673", "HG01676", "HG01679", "HG01684", "HG01685", "HG01695", "HG01697", "HG01702", "HG01704", "HG01707", "HG01710", "HG01746", "HG01757", "HG01762", "HG01766", "HG01768", "HG01770", "HG01773", "HG01776", "HG01779", "HG01784", "HG01786", "HG01790", "HG02215", "HG02220", "HG02223", "HG02230", "HG02232", "HG02235", "HG02239", "NA06985", "NA06989", "NA07000", "NA07037", "NA07056", "NA10847", "NA11830", "NA11832", "NA11840", "NA11892", "NA11894", "NA11918", "NA11920", "NA11933", "NA11995", "NA12004", "NA12006", "NA12044", "NA12046", "NA12058", "NA12156", "NA12234", "NA12249", "NA12273", "NA12275", "NA12283", "NA12287", "NA12341", "NA12348", "NA12400", "NA12414", "NA12489", "NA12717", "NA12718", "NA12749", "NA12751", "NA12761", "NA12763", "NA12776", "NA12778", "NA12813", "NA12815", "NA12828", "NA12830", "NA12843", "NA12873", "NA12878", "NA12890", "NA20502", "NA20503", "NA20504", "NA20505", "NA20506", "NA20507", "NA20508", "NA20514", "NA20517", "NA20522", "NA20529", "NA20530", "NA20531", "NA20533", "NA20535", "NA20540", "NA20541", "NA20542", "NA20582", "NA20585", "NA20587", "NA20589", "NA20753", "NA20756", "NA20757", "NA20760", "NA20761", "NA20764", "NA20766", "NA20768", "NA20769", "NA20771", "NA20772", "NA20773", "NA20774", "NA20775", "NA20790", "NA20795", "NA20797", "NA20799", "NA20800", "NA20802", "NA20804", "NA20807", "NA20808", "NA20813", "NA20818", "NA20819", "NA20821", "NA20822", "NA20826", "NA20828", "NA20832")
SAS <- c("HG02491", "HG02494", "HG02601", "HG02652", "HG02661", "HG02688", "HG02697", "HG02725", "HG02728", "HG02731", "HG02737", "HG02775", "HG02778", "HG02784", "HG02787", "HG02790", "HG02793", "HG03007", "HG03016", "HG03235", "HG03238", "HG03488", "HG03491", "HG03589", "HG03595", "HG03598", "HG03604", "HG03607", "HG03611", "HG03616", "HG03631", "HG03634", "HG03640", "HG03642", "HG03643", "HG03645", "HG03653", "HG03668", "HG03673", "HG03684", "HG03689", "HG03692", "HG03698", "HG03703", "HG03706", "HG03709", "HG03714", "HG03717", "HG03730", "HG03731", "HG03736", "HG03757", "HG03760", "HG03762", "HG03765", "HG03770", "HG03772", "HG03774", "HG03780", "HG03781", "HG03782", "HG03787", "HG03789", "HG03793", "HG03796", "HG03802", "HG03805", "HG03808", "HG03814", "HG03817", "HG03823", "HG03826", "HG03829", "HG03832", "HG03849", "HG03857", "HG03861", "HG03863", "HG03868", "HG03874", "HG03882", "HG03886", "HG03888", "HG03897", "HG03907", "HG03910", "HG03913", "HG03916", "HG03919", "HG03922", "HG03925", "HG03928", "HG03931", "HG03934", "HG03937", "HG03940", "HG03945", "HG03947", "HG03949", "HG03951", "HG03968", "HG03973", "HG03977", "HG03986", "HG03989", "HG04001", "HG04014", "HG04018", "HG04025", "HG04026", "HG04042", "HG04047", "HG04059", "HG04062", "HG04063", "HG04075", "HG04076", "HG04090", "HG04099", "HG04118", "HG04141", "HG04144", "HG04153", "HG04156", "HG04159", "HG04171", "HG04177", "HG04180", "HG04183", "HG04186", "HG04189", "HG04195", "HG04200", "HG04202", "HG04212", "HG04214", "HG04216", "HG04227", "NA20847", "NA20849", "NA20851", "NA20853", "NA20854", "NA20856", "NA20859", "NA20862", "NA20868", "NA20869", "NA20872", "NA20874", "NA20875", "NA20876", "NA20877", "NA20878", "NA20881", "NA20882", "NA20888", "NA20892", "NA20894", "NA20896", "NA20899", "NA20902", "NA20906", "NA20908", "NA20910", "NA21086", "NA21088", "NA21089", "NA21097", "NA21101", "NA21102", "NA21103", "NA21106", "NA21108", "NA21110", "NA21120", "NA21122", "NA21125", "NA21137", "NA21141", "NA21143", "NA21144")
Clusters_1 <- set.populations(Clusters_1, list(AFR,AMR,EAS,EUR,SAS), diploid = TRUE)
Clusters_1 <- set.outgroup(Clusters_1, c("Chimp"), diploid=TRUE)

#F_ST
Clusters_1 <- F_ST.stats(Clusters_1, mode="nucleotide")
Clusters_1@nuc.F_ST.vs.all [[1]]
Clusters_1@nuc.F_ST.vs.all [[2]]
Clusters_1@nuc.F_ST.vs.all [[3]]
Clusters_1@nuc.F_ST.vs.all [[4]]
Clusters_1@nuc.F_ST.vs.all [[5]]

#Cluster_2
Clusters_2 <- readVCF("new_chr7.vcf.gz", numcols=10000, tid="7", from=6617659, to=6633659, include.unknown = TRUE)
Clusters_2 <- set.outgroup(Clusters_2, c("Chimp"), diploid=TRUE)
get.sum.data(Clusters_2) 

#Divergence
bial <- get.biallelic.matrix(Clusters_2,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites2 <- sum (div & !polym,na.rm=T)
divsites2
D <- divsites2/643
D

#Mutation rate
Clusters_2 <- neutrality.stats(Clusters_2)
Mu <- (Clusters_2@theta_Watterson/643)/40000
Mu

#Pi_Cluster2
individuals <- get.individuals(Clusters_2)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 

bial <- get.biallelic.matrix(Clusters_2,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters_2@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 6617659:6633659))) # N polyallelic sites in that region
m <- 643-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

AFR <- c("HG01880", "HG01883", "HG01886", "HG01889", "HG01894", "HG01896", "HG01956", "HG01958", "HG01985", "HG01989", "HG02010", "HG02012", "HG02052", "HG02054", "HG02095", "HG02108", "HG02111", "HG02144", "HG02256", "HG02282", "HG02308", "HG02309", "HG02315", "HG02318", "HG02322", "HG02325", "HG02337", "HG02339", "HG02419", "HG02427", "HG02450", "HG02462", "HG02465", "HG02476", "HG02477", "HG02479", "HG02485", "HG02497", "HG02502", "HG02505", "HG02508", "HG02511", "HG02537", "HG02546", "HG02549", "HG02555", "HG02558", "HG02562", "HG02568", "HG02571", "HG02574", "HG02577", "HG02580", "HG02583", "HG02586", "HG02589", "HG02595", "HG02611", "HG02614", "HG02621", "HG02629", "HG02635", "HG02646", "HG02667", "HG02676", "HG02679", "HG02703", "HG02716", "HG02722", "HG02757", "HG02760", "HG02763", "HG02769", "HG02772", "HG02799", "HG02808", "HG02811", "HG02814", "HG02817", "HG02820", "HG02837", "HG02840", "HG02855", "HG02861", "HG02870", "HG02879", "HG02882", "HG02885", "HG02888", "HG02891", "HG02922", "HG02943", "HG02946", "HG02952", "HG02970", "HG02974", "HG02976", "HG02979", "HG02983", "HG03025", "HG03028", "HG03040", "HG03049", "HG03052", "HG03055", "HG03058", "HG03061", "HG03064", "HG03073", "HG03079", "HG03082", "HG03086", "HG03088", "HG03091", "HG03095", "HG03099", "HG03105", "HG03108", "HG03111", "HG03117", "HG03123", "HG03126", "HG03129", "HG03132", "HG03135", "HG03159", "HG03162", "HG03168", "HG03189", "HG03195", "HG03198", "HG03212", "HG03267", "HG03270", "HG03279", "HG03291", "HG03294", "HG03297", "HG03303", "HG03342", "HG03351", "HG03363", "HG03366", "HG03369", "HG03372", "HG03378", "HG03401", "HG03410", "HG03419", "HG03437", "HG03446", "HG03449", "HG03452", "HG03455", "HG03461", "HG03470", "HG03473", "HG03476", "HG03479", "HG03485", "HG03499", "HG03511", "HG03514", "HG03517", "HG03520", "HG03539", "HG03548", "HG03558", "HG03563", "HG03567", "HG03572", "HG03575", "HG03578", "HG03583", "NA18488", "NA18489", "NA18499", "NA18502", "NA18505", "NA18508", "NA18511", "NA18517", "NA18520", "NA18523", "NA18858", "NA18861", "NA18864", "NA18867", "NA18870", "NA18873", "NA18876", "NA18878", "NA18881", "NA18907", "NA18909", "NA18912", "NA18916", "NA18924", "NA18933", "NA19017", "NA19019", "NA19023", "NA19024", "NA19030", "NA19036", "NA19037", "NA19038", "NA19093", "NA19095", "NA19099", "NA19102", "NA19108", "NA19114", "NA19116", "NA19118", "NA19129", "NA19131", "NA19137", "NA19143", "NA19147", "NA19149", "NA19152", "NA19159", "NA19172", "NA19185", "NA19190", "NA19197", "NA19201", "NA19204", "NA19206", "NA19209", "NA19214", "NA19222", "NA19225", "NA19235", "NA19238", "NA19247", "NA19310", "NA19314", "NA19315", "NA19321", "NA19323", "NA19324", "NA19327", "NA19328", "NA19332", "NA19338", "NA19351", "NA19355", "NA19377", "NA19378", "NA19390", "NA19391", "NA19399", "NA19401", "NA19403", "NA19404", "NA19431", "NA19435", "NA19436", "NA19437", "NA19438", "NA19439", "NA19440", "NA19445", "NA19446", "NA19449", "NA19456", "NA19457", "NA19462", "NA19463", "NA19467", "NA19468", "NA19472", "NA19473", "NA19474", "NA19475", "NA19701", "NA19707", "NA19712", "NA19819", "NA19835", "NA19901", "NA19909", "NA19914", "NA19917", "NA19921", "NA19923", "NA20127", "NA20274", "NA20276", "NA20282", "NA20287", "NA20289", "NA20294", "NA20317", "NA20321", "NA20332", "NA20334", "NA20339", "NA20357", "NA20359", "NA20412")
AMR <- c("HG00551", "HG00554", "HG00638", "HG00641", "HG00732", "HG00734", "HG00737", "HG00740", "HG00743", "HG01049", "HG01052", "HG01055", "HG01058", "HG01064", "HG01067", "HG01070", "HG01073", "HG01077", "HG01080", "HG01086", "HG01089", "HG01092", "HG01095", "HG01098", "HG01102", "HG01105", "HG01108", "HG01111", "HG01113", "HG01119", "HG01122", "HG01125", "HG01131", "HG01137", "HG01140", "HG01149", "HG01162", "HG01168", "HG01171", "HG01174", "HG01177", "HG01183", "HG01188", "HG01191", "HG01205", "HG01242", "HG01248", "HG01251", "HG01254", "HG01257", "HG01269", "HG01272", "HG01281", "HG01284", "HG01303", "HG01312", "HG01323", "HG01326", "HG01342", "HG01345", "HG01351", "HG01357", "HG01360", "HG01363", "HG01366", "HG01369", "HG01372", "HG01375", "HG01378", "HG01384", "HG01390", "HG01393", "HG01396", "HG01403", "HG01414", "HG01432", "HG01435", "HG01441", "HG01444", "HG01447", "HG01456", "HG01459", "HG01462", "HG01474", "HG01486", "HG01489", "HG01492", "HG01495", "HG01551", "HG01566", "HG01572", "HG01578", "HG01893", "HG01918", "HG01921", "HG01924", "HG01927", "HG01933", "HG01936", "HG01939", "HG01942", "HG01945", "HG01948", "HG01954", "HG01965", "HG01968", "HG01971", "HG01973", "HG01976", "HG01980", "HG01992", "HG01997", "HG02003", "HG02006", "HG02089", "HG02102", "HG02105", "HG02147", "HG02252", "HG02260", "HG02266", "HG02272", "HG02275", "HG02278", "HG02286", "HG02292", "HG02298", "HG02301", "HG02312", "HG02345", "HG02348", "HG02425", "NA19651", "NA19654", "NA19663", "NA19669", "NA19678", "NA19681", "NA19684", "NA19716", "NA19719", "NA19722", "NA19725", "NA19728", "NA19731", "NA19734", "NA19740", "NA19746", "NA19749", "NA19752", "NA19755", "NA19758", "NA19761", "NA19764", "NA19770", "NA19773", "NA19776", "NA19779", "NA19782", "NA19785", "NA19788", "NA19794")
EAS <- c("HG00404", "HG00407", "HG00410", "HG00419", "HG00422", "HG00428", "HG00437", "HG00443", "HG00446", "HG00449", "HG00452", "HG00458", "HG00464", "HG00473", "HG00476", "HG00479", "HG00513", "HG00525", "HG00531", "HG00534", "HG00537", "HG00543", "HG00557", "HG00560", "HG00566", "HG00584", "HG00590", "HG00593", "HG00596", "HG00599", "HG00608", "HG00611", "HG00614", "HG00620", "HG00623", "HG00626", "HG00629", "HG00632", "HG00651", "HG00654", "HG00657", "HG00663", "HG00672", "HG00675", "HG00684", "HG00690", "HG00693", "HG00699", "HG00705", "HG00717", "HG00729", "HG00759", "HG00851", "HG00864", "HG00867", "HG00879", "HG00956", "HG00978", "HG01029", "HG01046", "HG01595", "HG01597", "HG01598", "HG01599", "HG01600", "HG01794", "HG01796", "HG01797", "HG01798", "HG01799", "HG01800", "HG01801", "HG01802", "HG01804", "HG01805", "HG01806", "HG01807", "HG01808", "HG01809", "HG01812", "HG01813", "HG01815", "HG01817", "HG01841", "HG01843", "HG01845", "HG01847", "HG01848", "HG01850", "HG01851", "HG01853", "HG01855", "HG01857", "HG01858", "HG01859", "HG01862", "HG01863", "HG01868", "HG01869", "HG01870", "HG01871", "HG01874", "HG01878", "HG02016", "HG02019", "HG02025", "HG02028", "HG02031", "HG02048", "HG02049", "HG02057", "HG02069", "HG02072", "HG02075", "HG02078", "HG02081", "HG02084", "HG02086", "HG02087", "HG02113", "HG02121", "HG02127", "HG02130", "HG02133", "HG02136", "HG02139", "HG02140", "HG02142", "HG02151", "HG02152", "HG02153", "HG02154", "HG02155", "HG02156", "HG02164", "HG02165", "HG02178", "HG02179", "HG02180", "HG02181", "HG02182", "HG02184", "HG02185", "HG02186", "HG02187", "HG02190", "HG02513", "HG02522", "NA18525", "NA18526", "NA18528", "NA18531", "NA18532", "NA18533", "NA18535", "NA18537", "NA18538", "NA18539", "NA18541", "NA18542", "NA18545", "NA18547", "NA18550", "NA18552", "NA18553", "NA18555", "NA18560", "NA18564", "NA18565", "NA18566", "NA18567", "NA18570", "NA18571", "NA18573", "NA18574", "NA18577", "NA18579", "NA18582", "NA18591", "NA18592", "NA18593", "NA18595", "NA18596", "NA18597", "NA18599", "NA18602", "NA18610", "NA18614", "NA18615", "NA18616", "NA18617", "NA18618", "NA18619", "NA18625", "NA18626", "NA18627", "NA18628", "NA18630", "NA18631", "NA18634", "NA18640", "NA18641", "NA18642", "NA18644", "NA18646", "NA18939", "NA18941", "NA18942", "NA18946", "NA18947", "NA18949", "NA18950", "NA18951", "NA18954", "NA18956", "NA18957", "NA18963", "NA18964", "NA18968", "NA18969", "NA18972", "NA18973", "NA18975", "NA18976", "NA18978", "NA18979", "NA18980", "NA18981", "NA18991", "NA18993", "NA18997", "NA18998", "NA18999", "NA19001", "NA19002", "NA19003", "NA19010", "NA19011", "NA19054", "NA19057", "NA19059", "NA19064", "NA19065", "NA19074", "NA19077", "NA19078", "NA19080", "NA19081", "NA19084", "NA19087", "NA19090")
EUR <- c("HG00097", "HG00099", "HG00102", "HG00110", "HG00111", "HG00118", "HG00120", "HG00121", "HG00122", "HG00125", "HG00127", "HG00128", "HG00130", "HG00132", "HG00133", "HG00137", "HG00146", "HG00150", "HG00154", "HG00158", "HG00171", "HG00173", "HG00174", "HG00176", "HG00177", "HG00178", "HG00179", "HG00180", "HG00231", "HG00232", "HG00233", "HG00235", "HG00236", "HG00237", "HG00238", "HG00239", "HG00245", "HG00250", "HG00253", "HG00254", "HG00255", "HG00257", "HG00258", "HG00259", "HG00261", "HG00262", "HG00263", "HG00266", "HG00268", "HG00269", "HG00272", "HG00274", "HG00275", "HG00276", "HG00281", "HG00282", "HG00285", "HG00288", "HG00304", "HG00306", "HG00309", "HG00313", "HG00315", "HG00318", "HG00319", "HG00320", "HG00323", "HG00324", "HG00326", "HG00327", "HG00328", "HG00330", "HG00331", "HG00332", "HG00334", "HG00337", "HG00339", "HG00343", "HG00344", "HG00346", "HG00349", "HG00350", "HG00353", "HG00355", "HG00356", "HG00357", "HG00361", "HG00362", "HG00364", "HG00365", "HG00367", "HG00368", "HG00373", "HG00376", "HG00378", "HG00379", "HG00380", "HG00381", "HG00383", "HG00384", "HG01501", "HG01504", "HG01507", "HG01510", "HG01513", "HG01516", "HG01519", "HG01522", "HG01525", "HG01528", "HG01531", "HG01537", "HG01602", "HG01605", "HG01607", "HG01612", "HG01613", "HG01618", "HG01620", "HG01623", "HG01626", "HG01628", "HG01632", "HG01668", "HG01670", "HG01673", "HG01676", "HG01679", "HG01684", "HG01685", "HG01695", "HG01697", "HG01702", "HG01704", "HG01707", "HG01710", "HG01746", "HG01757", "HG01762", "HG01766", "HG01768", "HG01770", "HG01773", "HG01776", "HG01779", "HG01784", "HG01786", "HG01790", "HG02215", "HG02220", "HG02223", "HG02230", "HG02232", "HG02235", "HG02239", "NA06985", "NA06989", "NA07000", "NA07037", "NA07056", "NA10847", "NA11830", "NA11832", "NA11840", "NA11892", "NA11894", "NA11918", "NA11920", "NA11933", "NA11995", "NA12004", "NA12006", "NA12044", "NA12046", "NA12058", "NA12156", "NA12234", "NA12249", "NA12273", "NA12275", "NA12283", "NA12287", "NA12341", "NA12348", "NA12400", "NA12414", "NA12489", "NA12717", "NA12718", "NA12749", "NA12751", "NA12761", "NA12763", "NA12776", "NA12778", "NA12813", "NA12815", "NA12828", "NA12830", "NA12843", "NA12873", "NA12878", "NA12890", "NA20502", "NA20503", "NA20504", "NA20505", "NA20506", "NA20507", "NA20508", "NA20514", "NA20517", "NA20522", "NA20529", "NA20530", "NA20531", "NA20533", "NA20535", "NA20540", "NA20541", "NA20542", "NA20582", "NA20585", "NA20587", "NA20589", "NA20753", "NA20756", "NA20757", "NA20760", "NA20761", "NA20764", "NA20766", "NA20768", "NA20769", "NA20771", "NA20772", "NA20773", "NA20774", "NA20775", "NA20790", "NA20795", "NA20797", "NA20799", "NA20800", "NA20802", "NA20804", "NA20807", "NA20808", "NA20813", "NA20818", "NA20819", "NA20821", "NA20822", "NA20826", "NA20828", "NA20832")
SAS <- c("HG02491", "HG02494", "HG02601", "HG02652", "HG02661", "HG02688", "HG02697", "HG02725", "HG02728", "HG02731", "HG02737", "HG02775", "HG02778", "HG02784", "HG02787", "HG02790", "HG02793", "HG03007", "HG03016", "HG03235", "HG03238", "HG03488", "HG03491", "HG03589", "HG03595", "HG03598", "HG03604", "HG03607", "HG03611", "HG03616", "HG03631", "HG03634", "HG03640", "HG03642", "HG03643", "HG03645", "HG03653", "HG03668", "HG03673", "HG03684", "HG03689", "HG03692", "HG03698", "HG03703", "HG03706", "HG03709", "HG03714", "HG03717", "HG03730", "HG03731", "HG03736", "HG03757", "HG03760", "HG03762", "HG03765", "HG03770", "HG03772", "HG03774", "HG03780", "HG03781", "HG03782", "HG03787", "HG03789", "HG03793", "HG03796", "HG03802", "HG03805", "HG03808", "HG03814", "HG03817", "HG03823", "HG03826", "HG03829", "HG03832", "HG03849", "HG03857", "HG03861", "HG03863", "HG03868", "HG03874", "HG03882", "HG03886", "HG03888", "HG03897", "HG03907", "HG03910", "HG03913", "HG03916", "HG03919", "HG03922", "HG03925", "HG03928", "HG03931", "HG03934", "HG03937", "HG03940", "HG03945", "HG03947", "HG03949", "HG03951", "HG03968", "HG03973", "HG03977", "HG03986", "HG03989", "HG04001", "HG04014", "HG04018", "HG04025", "HG04026", "HG04042", "HG04047", "HG04059", "HG04062", "HG04063", "HG04075", "HG04076", "HG04090", "HG04099", "HG04118", "HG04141", "HG04144", "HG04153", "HG04156", "HG04159", "HG04171", "HG04177", "HG04180", "HG04183", "HG04186", "HG04189", "HG04195", "HG04200", "HG04202", "HG04212", "HG04214", "HG04216", "HG04227", "NA20847", "NA20849", "NA20851", "NA20853", "NA20854", "NA20856", "NA20859", "NA20862", "NA20868", "NA20869", "NA20872", "NA20874", "NA20875", "NA20876", "NA20877", "NA20878", "NA20881", "NA20882", "NA20888", "NA20892", "NA20894", "NA20896", "NA20899", "NA20902", "NA20906", "NA20908", "NA20910", "NA21086", "NA21088", "NA21089", "NA21097", "NA21101", "NA21102", "NA21103", "NA21106", "NA21108", "NA21110", "NA21120", "NA21122", "NA21125", "NA21137", "NA21141", "NA21143", "NA21144")
Clusters_2 <- set.populations(Clusters_2, list(AFR,AMR,EAS,EUR,SAS), diploid = TRUE)
Clusters_2 <- set.outgroup(Clusters_2, c("Chimp"), diploid=TRUE)

#F_ST
Clusters_2 <- F_ST.stats(Clusters_2, mode="nucleotide")
Clusters_2@nuc.F_ST.vs.all [[1]]
Clusters_2@nuc.F_ST.vs.all [[2]]
Clusters_2@nuc.F_ST.vs.all [[3]]
Clusters_2@nuc.F_ST.vs.all [[4]]
Clusters_2@nuc.F_ST.vs.all [[5]]

#Cluster_3
Clusters_3 <- readVCF("new_chr7.vcf.gz", numcols=10000, tid="7", from=27493034, to=27502607, include.unknown = TRUE)
Clusters_3 <- set.outgroup(Clusters_3, c("Chimp"), diploid=TRUE)
get.sum.data(Clusters_3) 

#Divergence
bial <- get.biallelic.matrix(Clusters_3,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites3 <- sum (div & !polym,na.rm=T)
divsites3
D <- divsites3/7684
D

#Mutation rate
Clusters_3 <- neutrality.stats(Clusters_3)
Mu <- (Clusters_3@theta_Watterson/7684)/40000
Mu

#Pi_Cluster3
individuals <- get.individuals(Clusters_3)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 

bial <- get.biallelic.matrix(Clusters_3,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters_3@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 27493034:27502607))) # N polyallelic sites in that region
m <- 7684-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

AFR <- c("HG01880", "HG01883", "HG01886", "HG01889", "HG01894", "HG01896", "HG01956", "HG01958", "HG01985", "HG01989", "HG02010", "HG02012", "HG02052", "HG02054", "HG02095", "HG02108", "HG02111", "HG02144", "HG02256", "HG02282", "HG02308", "HG02309", "HG02315", "HG02318", "HG02322", "HG02325", "HG02337", "HG02339", "HG02419", "HG02427", "HG02450", "HG02462", "HG02465", "HG02476", "HG02477", "HG02479", "HG02485", "HG02497", "HG02502", "HG02505", "HG02508", "HG02511", "HG02537", "HG02546", "HG02549", "HG02555", "HG02558", "HG02562", "HG02568", "HG02571", "HG02574", "HG02577", "HG02580", "HG02583", "HG02586", "HG02589", "HG02595", "HG02611", "HG02614", "HG02621", "HG02629", "HG02635", "HG02646", "HG02667", "HG02676", "HG02679", "HG02703", "HG02716", "HG02722", "HG02757", "HG02760", "HG02763", "HG02769", "HG02772", "HG02799", "HG02808", "HG02811", "HG02814", "HG02817", "HG02820", "HG02837", "HG02840", "HG02855", "HG02861", "HG02870", "HG02879", "HG02882", "HG02885", "HG02888", "HG02891", "HG02922", "HG02943", "HG02946", "HG02952", "HG02970", "HG02974", "HG02976", "HG02979", "HG02983", "HG03025", "HG03028", "HG03040", "HG03049", "HG03052", "HG03055", "HG03058", "HG03061", "HG03064", "HG03073", "HG03079", "HG03082", "HG03086", "HG03088", "HG03091", "HG03095", "HG03099", "HG03105", "HG03108", "HG03111", "HG03117", "HG03123", "HG03126", "HG03129", "HG03132", "HG03135", "HG03159", "HG03162", "HG03168", "HG03189", "HG03195", "HG03198", "HG03212", "HG03267", "HG03270", "HG03279", "HG03291", "HG03294", "HG03297", "HG03303", "HG03342", "HG03351", "HG03363", "HG03366", "HG03369", "HG03372", "HG03378", "HG03401", "HG03410", "HG03419", "HG03437", "HG03446", "HG03449", "HG03452", "HG03455", "HG03461", "HG03470", "HG03473", "HG03476", "HG03479", "HG03485", "HG03499", "HG03511", "HG03514", "HG03517", "HG03520", "HG03539", "HG03548", "HG03558", "HG03563", "HG03567", "HG03572", "HG03575", "HG03578", "HG03583", "NA18488", "NA18489", "NA18499", "NA18502", "NA18505", "NA18508", "NA18511", "NA18517", "NA18520", "NA18523", "NA18858", "NA18861", "NA18864", "NA18867", "NA18870", "NA18873", "NA18876", "NA18878", "NA18881", "NA18907", "NA18909", "NA18912", "NA18916", "NA18924", "NA18933", "NA19017", "NA19019", "NA19023", "NA19024", "NA19030", "NA19036", "NA19037", "NA19038", "NA19093", "NA19095", "NA19099", "NA19102", "NA19108", "NA19114", "NA19116", "NA19118", "NA19129", "NA19131", "NA19137", "NA19143", "NA19147", "NA19149", "NA19152", "NA19159", "NA19172", "NA19185", "NA19190", "NA19197", "NA19201", "NA19204", "NA19206", "NA19209", "NA19214", "NA19222", "NA19225", "NA19235", "NA19238", "NA19247", "NA19310", "NA19314", "NA19315", "NA19321", "NA19323", "NA19324", "NA19327", "NA19328", "NA19332", "NA19338", "NA19351", "NA19355", "NA19377", "NA19378", "NA19390", "NA19391", "NA19399", "NA19401", "NA19403", "NA19404", "NA19431", "NA19435", "NA19436", "NA19437", "NA19438", "NA19439", "NA19440", "NA19445", "NA19446", "NA19449", "NA19456", "NA19457", "NA19462", "NA19463", "NA19467", "NA19468", "NA19472", "NA19473", "NA19474", "NA19475", "NA19701", "NA19707", "NA19712", "NA19819", "NA19835", "NA19901", "NA19909", "NA19914", "NA19917", "NA19921", "NA19923", "NA20127", "NA20274", "NA20276", "NA20282", "NA20287", "NA20289", "NA20294", "NA20317", "NA20321", "NA20332", "NA20334", "NA20339", "NA20357", "NA20359", "NA20412")
AMR <- c("HG00551", "HG00554", "HG00638", "HG00641", "HG00732", "HG00734", "HG00737", "HG00740", "HG00743", "HG01049", "HG01052", "HG01055", "HG01058", "HG01064", "HG01067", "HG01070", "HG01073", "HG01077", "HG01080", "HG01086", "HG01089", "HG01092", "HG01095", "HG01098", "HG01102", "HG01105", "HG01108", "HG01111", "HG01113", "HG01119", "HG01122", "HG01125", "HG01131", "HG01137", "HG01140", "HG01149", "HG01162", "HG01168", "HG01171", "HG01174", "HG01177", "HG01183", "HG01188", "HG01191", "HG01205", "HG01242", "HG01248", "HG01251", "HG01254", "HG01257", "HG01269", "HG01272", "HG01281", "HG01284", "HG01303", "HG01312", "HG01323", "HG01326", "HG01342", "HG01345", "HG01351", "HG01357", "HG01360", "HG01363", "HG01366", "HG01369", "HG01372", "HG01375", "HG01378", "HG01384", "HG01390", "HG01393", "HG01396", "HG01403", "HG01414", "HG01432", "HG01435", "HG01441", "HG01444", "HG01447", "HG01456", "HG01459", "HG01462", "HG01474", "HG01486", "HG01489", "HG01492", "HG01495", "HG01551", "HG01566", "HG01572", "HG01578", "HG01893", "HG01918", "HG01921", "HG01924", "HG01927", "HG01933", "HG01936", "HG01939", "HG01942", "HG01945", "HG01948", "HG01954", "HG01965", "HG01968", "HG01971", "HG01973", "HG01976", "HG01980", "HG01992", "HG01997", "HG02003", "HG02006", "HG02089", "HG02102", "HG02105", "HG02147", "HG02252", "HG02260", "HG02266", "HG02272", "HG02275", "HG02278", "HG02286", "HG02292", "HG02298", "HG02301", "HG02312", "HG02345", "HG02348", "HG02425", "NA19651", "NA19654", "NA19663", "NA19669", "NA19678", "NA19681", "NA19684", "NA19716", "NA19719", "NA19722", "NA19725", "NA19728", "NA19731", "NA19734", "NA19740", "NA19746", "NA19749", "NA19752", "NA19755", "NA19758", "NA19761", "NA19764", "NA19770", "NA19773", "NA19776", "NA19779", "NA19782", "NA19785", "NA19788", "NA19794")
EAS <- c("HG00404", "HG00407", "HG00410", "HG00419", "HG00422", "HG00428", "HG00437", "HG00443", "HG00446", "HG00449", "HG00452", "HG00458", "HG00464", "HG00473", "HG00476", "HG00479", "HG00513", "HG00525", "HG00531", "HG00534", "HG00537", "HG00543", "HG00557", "HG00560", "HG00566", "HG00584", "HG00590", "HG00593", "HG00596", "HG00599", "HG00608", "HG00611", "HG00614", "HG00620", "HG00623", "HG00626", "HG00629", "HG00632", "HG00651", "HG00654", "HG00657", "HG00663", "HG00672", "HG00675", "HG00684", "HG00690", "HG00693", "HG00699", "HG00705", "HG00717", "HG00729", "HG00759", "HG00851", "HG00864", "HG00867", "HG00879", "HG00956", "HG00978", "HG01029", "HG01046", "HG01595", "HG01597", "HG01598", "HG01599", "HG01600", "HG01794", "HG01796", "HG01797", "HG01798", "HG01799", "HG01800", "HG01801", "HG01802", "HG01804", "HG01805", "HG01806", "HG01807", "HG01808", "HG01809", "HG01812", "HG01813", "HG01815", "HG01817", "HG01841", "HG01843", "HG01845", "HG01847", "HG01848", "HG01850", "HG01851", "HG01853", "HG01855", "HG01857", "HG01858", "HG01859", "HG01862", "HG01863", "HG01868", "HG01869", "HG01870", "HG01871", "HG01874", "HG01878", "HG02016", "HG02019", "HG02025", "HG02028", "HG02031", "HG02048", "HG02049", "HG02057", "HG02069", "HG02072", "HG02075", "HG02078", "HG02081", "HG02084", "HG02086", "HG02087", "HG02113", "HG02121", "HG02127", "HG02130", "HG02133", "HG02136", "HG02139", "HG02140", "HG02142", "HG02151", "HG02152", "HG02153", "HG02154", "HG02155", "HG02156", "HG02164", "HG02165", "HG02178", "HG02179", "HG02180", "HG02181", "HG02182", "HG02184", "HG02185", "HG02186", "HG02187", "HG02190", "HG02513", "HG02522", "NA18525", "NA18526", "NA18528", "NA18531", "NA18532", "NA18533", "NA18535", "NA18537", "NA18538", "NA18539", "NA18541", "NA18542", "NA18545", "NA18547", "NA18550", "NA18552", "NA18553", "NA18555", "NA18560", "NA18564", "NA18565", "NA18566", "NA18567", "NA18570", "NA18571", "NA18573", "NA18574", "NA18577", "NA18579", "NA18582", "NA18591", "NA18592", "NA18593", "NA18595", "NA18596", "NA18597", "NA18599", "NA18602", "NA18610", "NA18614", "NA18615", "NA18616", "NA18617", "NA18618", "NA18619", "NA18625", "NA18626", "NA18627", "NA18628", "NA18630", "NA18631", "NA18634", "NA18640", "NA18641", "NA18642", "NA18644", "NA18646", "NA18939", "NA18941", "NA18942", "NA18946", "NA18947", "NA18949", "NA18950", "NA18951", "NA18954", "NA18956", "NA18957", "NA18963", "NA18964", "NA18968", "NA18969", "NA18972", "NA18973", "NA18975", "NA18976", "NA18978", "NA18979", "NA18980", "NA18981", "NA18991", "NA18993", "NA18997", "NA18998", "NA18999", "NA19001", "NA19002", "NA19003", "NA19010", "NA19011", "NA19054", "NA19057", "NA19059", "NA19064", "NA19065", "NA19074", "NA19077", "NA19078", "NA19080", "NA19081", "NA19084", "NA19087", "NA19090")
EUR <- c("HG00097", "HG00099", "HG00102", "HG00110", "HG00111", "HG00118", "HG00120", "HG00121", "HG00122", "HG00125", "HG00127", "HG00128", "HG00130", "HG00132", "HG00133", "HG00137", "HG00146", "HG00150", "HG00154", "HG00158", "HG00171", "HG00173", "HG00174", "HG00176", "HG00177", "HG00178", "HG00179", "HG00180", "HG00231", "HG00232", "HG00233", "HG00235", "HG00236", "HG00237", "HG00238", "HG00239", "HG00245", "HG00250", "HG00253", "HG00254", "HG00255", "HG00257", "HG00258", "HG00259", "HG00261", "HG00262", "HG00263", "HG00266", "HG00268", "HG00269", "HG00272", "HG00274", "HG00275", "HG00276", "HG00281", "HG00282", "HG00285", "HG00288", "HG00304", "HG00306", "HG00309", "HG00313", "HG00315", "HG00318", "HG00319", "HG00320", "HG00323", "HG00324", "HG00326", "HG00327", "HG00328", "HG00330", "HG00331", "HG00332", "HG00334", "HG00337", "HG00339", "HG00343", "HG00344", "HG00346", "HG00349", "HG00350", "HG00353", "HG00355", "HG00356", "HG00357", "HG00361", "HG00362", "HG00364", "HG00365", "HG00367", "HG00368", "HG00373", "HG00376", "HG00378", "HG00379", "HG00380", "HG00381", "HG00383", "HG00384", "HG01501", "HG01504", "HG01507", "HG01510", "HG01513", "HG01516", "HG01519", "HG01522", "HG01525", "HG01528", "HG01531", "HG01537", "HG01602", "HG01605", "HG01607", "HG01612", "HG01613", "HG01618", "HG01620", "HG01623", "HG01626", "HG01628", "HG01632", "HG01668", "HG01670", "HG01673", "HG01676", "HG01679", "HG01684", "HG01685", "HG01695", "HG01697", "HG01702", "HG01704", "HG01707", "HG01710", "HG01746", "HG01757", "HG01762", "HG01766", "HG01768", "HG01770", "HG01773", "HG01776", "HG01779", "HG01784", "HG01786", "HG01790", "HG02215", "HG02220", "HG02223", "HG02230", "HG02232", "HG02235", "HG02239", "NA06985", "NA06989", "NA07000", "NA07037", "NA07056", "NA10847", "NA11830", "NA11832", "NA11840", "NA11892", "NA11894", "NA11918", "NA11920", "NA11933", "NA11995", "NA12004", "NA12006", "NA12044", "NA12046", "NA12058", "NA12156", "NA12234", "NA12249", "NA12273", "NA12275", "NA12283", "NA12287", "NA12341", "NA12348", "NA12400", "NA12414", "NA12489", "NA12717", "NA12718", "NA12749", "NA12751", "NA12761", "NA12763", "NA12776", "NA12778", "NA12813", "NA12815", "NA12828", "NA12830", "NA12843", "NA12873", "NA12878", "NA12890", "NA20502", "NA20503", "NA20504", "NA20505", "NA20506", "NA20507", "NA20508", "NA20514", "NA20517", "NA20522", "NA20529", "NA20530", "NA20531", "NA20533", "NA20535", "NA20540", "NA20541", "NA20542", "NA20582", "NA20585", "NA20587", "NA20589", "NA20753", "NA20756", "NA20757", "NA20760", "NA20761", "NA20764", "NA20766", "NA20768", "NA20769", "NA20771", "NA20772", "NA20773", "NA20774", "NA20775", "NA20790", "NA20795", "NA20797", "NA20799", "NA20800", "NA20802", "NA20804", "NA20807", "NA20808", "NA20813", "NA20818", "NA20819", "NA20821", "NA20822", "NA20826", "NA20828", "NA20832")
SAS <- c("HG02491", "HG02494", "HG02601", "HG02652", "HG02661", "HG02688", "HG02697", "HG02725", "HG02728", "HG02731", "HG02737", "HG02775", "HG02778", "HG02784", "HG02787", "HG02790", "HG02793", "HG03007", "HG03016", "HG03235", "HG03238", "HG03488", "HG03491", "HG03589", "HG03595", "HG03598", "HG03604", "HG03607", "HG03611", "HG03616", "HG03631", "HG03634", "HG03640", "HG03642", "HG03643", "HG03645", "HG03653", "HG03668", "HG03673", "HG03684", "HG03689", "HG03692", "HG03698", "HG03703", "HG03706", "HG03709", "HG03714", "HG03717", "HG03730", "HG03731", "HG03736", "HG03757", "HG03760", "HG03762", "HG03765", "HG03770", "HG03772", "HG03774", "HG03780", "HG03781", "HG03782", "HG03787", "HG03789", "HG03793", "HG03796", "HG03802", "HG03805", "HG03808", "HG03814", "HG03817", "HG03823", "HG03826", "HG03829", "HG03832", "HG03849", "HG03857", "HG03861", "HG03863", "HG03868", "HG03874", "HG03882", "HG03886", "HG03888", "HG03897", "HG03907", "HG03910", "HG03913", "HG03916", "HG03919", "HG03922", "HG03925", "HG03928", "HG03931", "HG03934", "HG03937", "HG03940", "HG03945", "HG03947", "HG03949", "HG03951", "HG03968", "HG03973", "HG03977", "HG03986", "HG03989", "HG04001", "HG04014", "HG04018", "HG04025", "HG04026", "HG04042", "HG04047", "HG04059", "HG04062", "HG04063", "HG04075", "HG04076", "HG04090", "HG04099", "HG04118", "HG04141", "HG04144", "HG04153", "HG04156", "HG04159", "HG04171", "HG04177", "HG04180", "HG04183", "HG04186", "HG04189", "HG04195", "HG04200", "HG04202", "HG04212", "HG04214", "HG04216", "HG04227", "NA20847", "NA20849", "NA20851", "NA20853", "NA20854", "NA20856", "NA20859", "NA20862", "NA20868", "NA20869", "NA20872", "NA20874", "NA20875", "NA20876", "NA20877", "NA20878", "NA20881", "NA20882", "NA20888", "NA20892", "NA20894", "NA20896", "NA20899", "NA20902", "NA20906", "NA20908", "NA20910", "NA21086", "NA21088", "NA21089", "NA21097", "NA21101", "NA21102", "NA21103", "NA21106", "NA21108", "NA21110", "NA21120", "NA21122", "NA21125", "NA21137", "NA21141", "NA21143", "NA21144")
Clusters_3 <- set.populations(Clusters_3, list(AFR,AMR,EAS,EUR,SAS), diploid = TRUE)
Clusters_3 <- set.outgroup(Clusters_3, c("Chimp"), diploid=TRUE)

#F_ST
Clusters_3 <- F_ST.stats(Clusters_3, mode="nucleotide")
Clusters_3@nuc.F_ST.vs.all [[1]]
Clusters_3@nuc.F_ST.vs.all [[2]]
Clusters_3@nuc.F_ST.vs.all [[3]]
Clusters_3@nuc.F_ST.vs.all [[4]]
Clusters_3@nuc.F_ST.vs.all [[5]]

#Cluster_4
Clusters_4 <- readVCF("new_chr7.vcf.gz", numcols=10000, tid="7", from=35732666, to=35739378, include.unknown = TRUE)
Clusters_4 <- set.outgroup(Clusters_4, c("Chimp"), diploid=TRUE)
get.sum.data(Clusters_4) 

#Divergence
bial <- get.biallelic.matrix(Clusters_4,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites4 <- sum (div & !polym,na.rm=T)
divsites4
D <- divsites4/355
D

#Mutation rate
Clusters_4 <- neutrality.stats(Clusters_4)
Mu <- (Clusters_4@theta_Watterson/355)/40000
Mu

#Pi_Cluster4
individuals <- get.individuals(Clusters_4)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 

bial <- get.biallelic.matrix(Clusters_4,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters_4@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 35732666:35739378))) # N polyallelic sites in that region
m <- 355-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

AFR <- c("HG01880", "HG01883", "HG01886", "HG01889", "HG01894", "HG01896", "HG01956", "HG01958", "HG01985", "HG01989", "HG02010", "HG02012", "HG02052", "HG02054", "HG02095", "HG02108", "HG02111", "HG02144", "HG02256", "HG02282", "HG02308", "HG02309", "HG02315", "HG02318", "HG02322", "HG02325", "HG02337", "HG02339", "HG02419", "HG02427", "HG02450", "HG02462", "HG02465", "HG02476", "HG02477", "HG02479", "HG02485", "HG02497", "HG02502", "HG02505", "HG02508", "HG02511", "HG02537", "HG02546", "HG02549", "HG02555", "HG02558", "HG02562", "HG02568", "HG02571", "HG02574", "HG02577", "HG02580", "HG02583", "HG02586", "HG02589", "HG02595", "HG02611", "HG02614", "HG02621", "HG02629", "HG02635", "HG02646", "HG02667", "HG02676", "HG02679", "HG02703", "HG02716", "HG02722", "HG02757", "HG02760", "HG02763", "HG02769", "HG02772", "HG02799", "HG02808", "HG02811", "HG02814", "HG02817", "HG02820", "HG02837", "HG02840", "HG02855", "HG02861", "HG02870", "HG02879", "HG02882", "HG02885", "HG02888", "HG02891", "HG02922", "HG02943", "HG02946", "HG02952", "HG02970", "HG02974", "HG02976", "HG02979", "HG02983", "HG03025", "HG03028", "HG03040", "HG03049", "HG03052", "HG03055", "HG03058", "HG03061", "HG03064", "HG03073", "HG03079", "HG03082", "HG03086", "HG03088", "HG03091", "HG03095", "HG03099", "HG03105", "HG03108", "HG03111", "HG03117", "HG03123", "HG03126", "HG03129", "HG03132", "HG03135", "HG03159", "HG03162", "HG03168", "HG03189", "HG03195", "HG03198", "HG03212", "HG03267", "HG03270", "HG03279", "HG03291", "HG03294", "HG03297", "HG03303", "HG03342", "HG03351", "HG03363", "HG03366", "HG03369", "HG03372", "HG03378", "HG03401", "HG03410", "HG03419", "HG03437", "HG03446", "HG03449", "HG03452", "HG03455", "HG03461", "HG03470", "HG03473", "HG03476", "HG03479", "HG03485", "HG03499", "HG03511", "HG03514", "HG03517", "HG03520", "HG03539", "HG03548", "HG03558", "HG03563", "HG03567", "HG03572", "HG03575", "HG03578", "HG03583", "NA18488", "NA18489", "NA18499", "NA18502", "NA18505", "NA18508", "NA18511", "NA18517", "NA18520", "NA18523", "NA18858", "NA18861", "NA18864", "NA18867", "NA18870", "NA18873", "NA18876", "NA18878", "NA18881", "NA18907", "NA18909", "NA18912", "NA18916", "NA18924", "NA18933", "NA19017", "NA19019", "NA19023", "NA19024", "NA19030", "NA19036", "NA19037", "NA19038", "NA19093", "NA19095", "NA19099", "NA19102", "NA19108", "NA19114", "NA19116", "NA19118", "NA19129", "NA19131", "NA19137", "NA19143", "NA19147", "NA19149", "NA19152", "NA19159", "NA19172", "NA19185", "NA19190", "NA19197", "NA19201", "NA19204", "NA19206", "NA19209", "NA19214", "NA19222", "NA19225", "NA19235", "NA19238", "NA19247", "NA19310", "NA19314", "NA19315", "NA19321", "NA19323", "NA19324", "NA19327", "NA19328", "NA19332", "NA19338", "NA19351", "NA19355", "NA19377", "NA19378", "NA19390", "NA19391", "NA19399", "NA19401", "NA19403", "NA19404", "NA19431", "NA19435", "NA19436", "NA19437", "NA19438", "NA19439", "NA19440", "NA19445", "NA19446", "NA19449", "NA19456", "NA19457", "NA19462", "NA19463", "NA19467", "NA19468", "NA19472", "NA19473", "NA19474", "NA19475", "NA19701", "NA19707", "NA19712", "NA19819", "NA19835", "NA19901", "NA19909", "NA19914", "NA19917", "NA19921", "NA19923", "NA20127", "NA20274", "NA20276", "NA20282", "NA20287", "NA20289", "NA20294", "NA20317", "NA20321", "NA20332", "NA20334", "NA20339", "NA20357", "NA20359", "NA20412")
AMR <- c("HG00551", "HG00554", "HG00638", "HG00641", "HG00732", "HG00734", "HG00737", "HG00740", "HG00743", "HG01049", "HG01052", "HG01055", "HG01058", "HG01064", "HG01067", "HG01070", "HG01073", "HG01077", "HG01080", "HG01086", "HG01089", "HG01092", "HG01095", "HG01098", "HG01102", "HG01105", "HG01108", "HG01111", "HG01113", "HG01119", "HG01122", "HG01125", "HG01131", "HG01137", "HG01140", "HG01149", "HG01162", "HG01168", "HG01171", "HG01174", "HG01177", "HG01183", "HG01188", "HG01191", "HG01205", "HG01242", "HG01248", "HG01251", "HG01254", "HG01257", "HG01269", "HG01272", "HG01281", "HG01284", "HG01303", "HG01312", "HG01323", "HG01326", "HG01342", "HG01345", "HG01351", "HG01357", "HG01360", "HG01363", "HG01366", "HG01369", "HG01372", "HG01375", "HG01378", "HG01384", "HG01390", "HG01393", "HG01396", "HG01403", "HG01414", "HG01432", "HG01435", "HG01441", "HG01444", "HG01447", "HG01456", "HG01459", "HG01462", "HG01474", "HG01486", "HG01489", "HG01492", "HG01495", "HG01551", "HG01566", "HG01572", "HG01578", "HG01893", "HG01918", "HG01921", "HG01924", "HG01927", "HG01933", "HG01936", "HG01939", "HG01942", "HG01945", "HG01948", "HG01954", "HG01965", "HG01968", "HG01971", "HG01973", "HG01976", "HG01980", "HG01992", "HG01997", "HG02003", "HG02006", "HG02089", "HG02102", "HG02105", "HG02147", "HG02252", "HG02260", "HG02266", "HG02272", "HG02275", "HG02278", "HG02286", "HG02292", "HG02298", "HG02301", "HG02312", "HG02345", "HG02348", "HG02425", "NA19651", "NA19654", "NA19663", "NA19669", "NA19678", "NA19681", "NA19684", "NA19716", "NA19719", "NA19722", "NA19725", "NA19728", "NA19731", "NA19734", "NA19740", "NA19746", "NA19749", "NA19752", "NA19755", "NA19758", "NA19761", "NA19764", "NA19770", "NA19773", "NA19776", "NA19779", "NA19782", "NA19785", "NA19788", "NA19794")
EAS <- c("HG00404", "HG00407", "HG00410", "HG00419", "HG00422", "HG00428", "HG00437", "HG00443", "HG00446", "HG00449", "HG00452", "HG00458", "HG00464", "HG00473", "HG00476", "HG00479", "HG00513", "HG00525", "HG00531", "HG00534", "HG00537", "HG00543", "HG00557", "HG00560", "HG00566", "HG00584", "HG00590", "HG00593", "HG00596", "HG00599", "HG00608", "HG00611", "HG00614", "HG00620", "HG00623", "HG00626", "HG00629", "HG00632", "HG00651", "HG00654", "HG00657", "HG00663", "HG00672", "HG00675", "HG00684", "HG00690", "HG00693", "HG00699", "HG00705", "HG00717", "HG00729", "HG00759", "HG00851", "HG00864", "HG00867", "HG00879", "HG00956", "HG00978", "HG01029", "HG01046", "HG01595", "HG01597", "HG01598", "HG01599", "HG01600", "HG01794", "HG01796", "HG01797", "HG01798", "HG01799", "HG01800", "HG01801", "HG01802", "HG01804", "HG01805", "HG01806", "HG01807", "HG01808", "HG01809", "HG01812", "HG01813", "HG01815", "HG01817", "HG01841", "HG01843", "HG01845", "HG01847", "HG01848", "HG01850", "HG01851", "HG01853", "HG01855", "HG01857", "HG01858", "HG01859", "HG01862", "HG01863", "HG01868", "HG01869", "HG01870", "HG01871", "HG01874", "HG01878", "HG02016", "HG02019", "HG02025", "HG02028", "HG02031", "HG02048", "HG02049", "HG02057", "HG02069", "HG02072", "HG02075", "HG02078", "HG02081", "HG02084", "HG02086", "HG02087", "HG02113", "HG02121", "HG02127", "HG02130", "HG02133", "HG02136", "HG02139", "HG02140", "HG02142", "HG02151", "HG02152", "HG02153", "HG02154", "HG02155", "HG02156", "HG02164", "HG02165", "HG02178", "HG02179", "HG02180", "HG02181", "HG02182", "HG02184", "HG02185", "HG02186", "HG02187", "HG02190", "HG02513", "HG02522", "NA18525", "NA18526", "NA18528", "NA18531", "NA18532", "NA18533", "NA18535", "NA18537", "NA18538", "NA18539", "NA18541", "NA18542", "NA18545", "NA18547", "NA18550", "NA18552", "NA18553", "NA18555", "NA18560", "NA18564", "NA18565", "NA18566", "NA18567", "NA18570", "NA18571", "NA18573", "NA18574", "NA18577", "NA18579", "NA18582", "NA18591", "NA18592", "NA18593", "NA18595", "NA18596", "NA18597", "NA18599", "NA18602", "NA18610", "NA18614", "NA18615", "NA18616", "NA18617", "NA18618", "NA18619", "NA18625", "NA18626", "NA18627", "NA18628", "NA18630", "NA18631", "NA18634", "NA18640", "NA18641", "NA18642", "NA18644", "NA18646", "NA18939", "NA18941", "NA18942", "NA18946", "NA18947", "NA18949", "NA18950", "NA18951", "NA18954", "NA18956", "NA18957", "NA18963", "NA18964", "NA18968", "NA18969", "NA18972", "NA18973", "NA18975", "NA18976", "NA18978", "NA18979", "NA18980", "NA18981", "NA18991", "NA18993", "NA18997", "NA18998", "NA18999", "NA19001", "NA19002", "NA19003", "NA19010", "NA19011", "NA19054", "NA19057", "NA19059", "NA19064", "NA19065", "NA19074", "NA19077", "NA19078", "NA19080", "NA19081", "NA19084", "NA19087", "NA19090")
EUR <- c("HG00097", "HG00099", "HG00102", "HG00110", "HG00111", "HG00118", "HG00120", "HG00121", "HG00122", "HG00125", "HG00127", "HG00128", "HG00130", "HG00132", "HG00133", "HG00137", "HG00146", "HG00150", "HG00154", "HG00158", "HG00171", "HG00173", "HG00174", "HG00176", "HG00177", "HG00178", "HG00179", "HG00180", "HG00231", "HG00232", "HG00233", "HG00235", "HG00236", "HG00237", "HG00238", "HG00239", "HG00245", "HG00250", "HG00253", "HG00254", "HG00255", "HG00257", "HG00258", "HG00259", "HG00261", "HG00262", "HG00263", "HG00266", "HG00268", "HG00269", "HG00272", "HG00274", "HG00275", "HG00276", "HG00281", "HG00282", "HG00285", "HG00288", "HG00304", "HG00306", "HG00309", "HG00313", "HG00315", "HG00318", "HG00319", "HG00320", "HG00323", "HG00324", "HG00326", "HG00327", "HG00328", "HG00330", "HG00331", "HG00332", "HG00334", "HG00337", "HG00339", "HG00343", "HG00344", "HG00346", "HG00349", "HG00350", "HG00353", "HG00355", "HG00356", "HG00357", "HG00361", "HG00362", "HG00364", "HG00365", "HG00367", "HG00368", "HG00373", "HG00376", "HG00378", "HG00379", "HG00380", "HG00381", "HG00383", "HG00384", "HG01501", "HG01504", "HG01507", "HG01510", "HG01513", "HG01516", "HG01519", "HG01522", "HG01525", "HG01528", "HG01531", "HG01537", "HG01602", "HG01605", "HG01607", "HG01612", "HG01613", "HG01618", "HG01620", "HG01623", "HG01626", "HG01628", "HG01632", "HG01668", "HG01670", "HG01673", "HG01676", "HG01679", "HG01684", "HG01685", "HG01695", "HG01697", "HG01702", "HG01704", "HG01707", "HG01710", "HG01746", "HG01757", "HG01762", "HG01766", "HG01768", "HG01770", "HG01773", "HG01776", "HG01779", "HG01784", "HG01786", "HG01790", "HG02215", "HG02220", "HG02223", "HG02230", "HG02232", "HG02235", "HG02239", "NA06985", "NA06989", "NA07000", "NA07037", "NA07056", "NA10847", "NA11830", "NA11832", "NA11840", "NA11892", "NA11894", "NA11918", "NA11920", "NA11933", "NA11995", "NA12004", "NA12006", "NA12044", "NA12046", "NA12058", "NA12156", "NA12234", "NA12249", "NA12273", "NA12275", "NA12283", "NA12287", "NA12341", "NA12348", "NA12400", "NA12414", "NA12489", "NA12717", "NA12718", "NA12749", "NA12751", "NA12761", "NA12763", "NA12776", "NA12778", "NA12813", "NA12815", "NA12828", "NA12830", "NA12843", "NA12873", "NA12878", "NA12890", "NA20502", "NA20503", "NA20504", "NA20505", "NA20506", "NA20507", "NA20508", "NA20514", "NA20517", "NA20522", "NA20529", "NA20530", "NA20531", "NA20533", "NA20535", "NA20540", "NA20541", "NA20542", "NA20582", "NA20585", "NA20587", "NA20589", "NA20753", "NA20756", "NA20757", "NA20760", "NA20761", "NA20764", "NA20766", "NA20768", "NA20769", "NA20771", "NA20772", "NA20773", "NA20774", "NA20775", "NA20790", "NA20795", "NA20797", "NA20799", "NA20800", "NA20802", "NA20804", "NA20807", "NA20808", "NA20813", "NA20818", "NA20819", "NA20821", "NA20822", "NA20826", "NA20828", "NA20832")
SAS <- c("HG02491", "HG02494", "HG02601", "HG02652", "HG02661", "HG02688", "HG02697", "HG02725", "HG02728", "HG02731", "HG02737", "HG02775", "HG02778", "HG02784", "HG02787", "HG02790", "HG02793", "HG03007", "HG03016", "HG03235", "HG03238", "HG03488", "HG03491", "HG03589", "HG03595", "HG03598", "HG03604", "HG03607", "HG03611", "HG03616", "HG03631", "HG03634", "HG03640", "HG03642", "HG03643", "HG03645", "HG03653", "HG03668", "HG03673", "HG03684", "HG03689", "HG03692", "HG03698", "HG03703", "HG03706", "HG03709", "HG03714", "HG03717", "HG03730", "HG03731", "HG03736", "HG03757", "HG03760", "HG03762", "HG03765", "HG03770", "HG03772", "HG03774", "HG03780", "HG03781", "HG03782", "HG03787", "HG03789", "HG03793", "HG03796", "HG03802", "HG03805", "HG03808", "HG03814", "HG03817", "HG03823", "HG03826", "HG03829", "HG03832", "HG03849", "HG03857", "HG03861", "HG03863", "HG03868", "HG03874", "HG03882", "HG03886", "HG03888", "HG03897", "HG03907", "HG03910", "HG03913", "HG03916", "HG03919", "HG03922", "HG03925", "HG03928", "HG03931", "HG03934", "HG03937", "HG03940", "HG03945", "HG03947", "HG03949", "HG03951", "HG03968", "HG03973", "HG03977", "HG03986", "HG03989", "HG04001", "HG04014", "HG04018", "HG04025", "HG04026", "HG04042", "HG04047", "HG04059", "HG04062", "HG04063", "HG04075", "HG04076", "HG04090", "HG04099", "HG04118", "HG04141", "HG04144", "HG04153", "HG04156", "HG04159", "HG04171", "HG04177", "HG04180", "HG04183", "HG04186", "HG04189", "HG04195", "HG04200", "HG04202", "HG04212", "HG04214", "HG04216", "HG04227", "NA20847", "NA20849", "NA20851", "NA20853", "NA20854", "NA20856", "NA20859", "NA20862", "NA20868", "NA20869", "NA20872", "NA20874", "NA20875", "NA20876", "NA20877", "NA20878", "NA20881", "NA20882", "NA20888", "NA20892", "NA20894", "NA20896", "NA20899", "NA20902", "NA20906", "NA20908", "NA20910", "NA21086", "NA21088", "NA21089", "NA21097", "NA21101", "NA21102", "NA21103", "NA21106", "NA21108", "NA21110", "NA21120", "NA21122", "NA21125", "NA21137", "NA21141", "NA21143", "NA21144")
Clusters_4 <- set.populations(Clusters_4, list(AFR,AMR,EAS,EUR,SAS), diploid = TRUE)
Clusters_4 <- set.outgroup(Clusters_4, c("Chimp"), diploid=TRUE)

#F_ST
Clusters_4 <- F_ST.stats(Clusters_4, mode="nucleotide")
Clusters_4@nuc.F_ST.vs.all [[1]]
Clusters_4@nuc.F_ST.vs.all [[2]]
Clusters_4@nuc.F_ST.vs.all [[3]]
Clusters_4@nuc.F_ST.vs.all [[4]]
Clusters_4@nuc.F_ST.vs.all [[5]]

#Cluster_5
Clusters_5 <- readVCF("new_chr7.vcf.gz", numcols=10000, tid="7", from=56870712, to=56905707, include.unknown = TRUE)
Clusters_5 <- set.outgroup(Clusters_5, c("Chimp"), diploid=TRUE)
get.sum.data(Clusters_5) 

#Divergence
bial <- get.biallelic.matrix(Clusters_5,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites5 <- sum (div & !polym,na.rm=T)
divsites5
D <- divsites5/3383
D

#Mutation rate
Clusters_5 <- neutrality.stats(Clusters_5)
Mu <- (Clusters_5@theta_Watterson/3383)/40000
Mu

#Pi_Cluster5
individuals <- get.individuals(Clusters_5)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 

bial <- get.biallelic.matrix(Clusters_5,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters_5@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 56870712:56905707))) # N polyallelic sites in that region
m <- 3383-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

AFR <- c("HG01880", "HG01883", "HG01886", "HG01889", "HG01894", "HG01896", "HG01956", "HG01958", "HG01985", "HG01989", "HG02010", "HG02012", "HG02052", "HG02054", "HG02095", "HG02108", "HG02111", "HG02144", "HG02256", "HG02282", "HG02308", "HG02309", "HG02315", "HG02318", "HG02322", "HG02325", "HG02337", "HG02339", "HG02419", "HG02427", "HG02450", "HG02462", "HG02465", "HG02476", "HG02477", "HG02479", "HG02485", "HG02497", "HG02502", "HG02505", "HG02508", "HG02511", "HG02537", "HG02546", "HG02549", "HG02555", "HG02558", "HG02562", "HG02568", "HG02571", "HG02574", "HG02577", "HG02580", "HG02583", "HG02586", "HG02589", "HG02595", "HG02611", "HG02614", "HG02621", "HG02629", "HG02635", "HG02646", "HG02667", "HG02676", "HG02679", "HG02703", "HG02716", "HG02722", "HG02757", "HG02760", "HG02763", "HG02769", "HG02772", "HG02799", "HG02808", "HG02811", "HG02814", "HG02817", "HG02820", "HG02837", "HG02840", "HG02855", "HG02861", "HG02870", "HG02879", "HG02882", "HG02885", "HG02888", "HG02891", "HG02922", "HG02943", "HG02946", "HG02952", "HG02970", "HG02974", "HG02976", "HG02979", "HG02983", "HG03025", "HG03028", "HG03040", "HG03049", "HG03052", "HG03055", "HG03058", "HG03061", "HG03064", "HG03073", "HG03079", "HG03082", "HG03086", "HG03088", "HG03091", "HG03095", "HG03099", "HG03105", "HG03108", "HG03111", "HG03117", "HG03123", "HG03126", "HG03129", "HG03132", "HG03135", "HG03159", "HG03162", "HG03168", "HG03189", "HG03195", "HG03198", "HG03212", "HG03267", "HG03270", "HG03279", "HG03291", "HG03294", "HG03297", "HG03303", "HG03342", "HG03351", "HG03363", "HG03366", "HG03369", "HG03372", "HG03378", "HG03401", "HG03410", "HG03419", "HG03437", "HG03446", "HG03449", "HG03452", "HG03455", "HG03461", "HG03470", "HG03473", "HG03476", "HG03479", "HG03485", "HG03499", "HG03511", "HG03514", "HG03517", "HG03520", "HG03539", "HG03548", "HG03558", "HG03563", "HG03567", "HG03572", "HG03575", "HG03578", "HG03583", "NA18488", "NA18489", "NA18499", "NA18502", "NA18505", "NA18508", "NA18511", "NA18517", "NA18520", "NA18523", "NA18858", "NA18861", "NA18864", "NA18867", "NA18870", "NA18873", "NA18876", "NA18878", "NA18881", "NA18907", "NA18909", "NA18912", "NA18916", "NA18924", "NA18933", "NA19017", "NA19019", "NA19023", "NA19024", "NA19030", "NA19036", "NA19037", "NA19038", "NA19093", "NA19095", "NA19099", "NA19102", "NA19108", "NA19114", "NA19116", "NA19118", "NA19129", "NA19131", "NA19137", "NA19143", "NA19147", "NA19149", "NA19152", "NA19159", "NA19172", "NA19185", "NA19190", "NA19197", "NA19201", "NA19204", "NA19206", "NA19209", "NA19214", "NA19222", "NA19225", "NA19235", "NA19238", "NA19247", "NA19310", "NA19314", "NA19315", "NA19321", "NA19323", "NA19324", "NA19327", "NA19328", "NA19332", "NA19338", "NA19351", "NA19355", "NA19377", "NA19378", "NA19390", "NA19391", "NA19399", "NA19401", "NA19403", "NA19404", "NA19431", "NA19435", "NA19436", "NA19437", "NA19438", "NA19439", "NA19440", "NA19445", "NA19446", "NA19449", "NA19456", "NA19457", "NA19462", "NA19463", "NA19467", "NA19468", "NA19472", "NA19473", "NA19474", "NA19475", "NA19701", "NA19707", "NA19712", "NA19819", "NA19835", "NA19901", "NA19909", "NA19914", "NA19917", "NA19921", "NA19923", "NA20127", "NA20274", "NA20276", "NA20282", "NA20287", "NA20289", "NA20294", "NA20317", "NA20321", "NA20332", "NA20334", "NA20339", "NA20357", "NA20359", "NA20412")
AMR <- c("HG00551", "HG00554", "HG00638", "HG00641", "HG00732", "HG00734", "HG00737", "HG00740", "HG00743", "HG01049", "HG01052", "HG01055", "HG01058", "HG01064", "HG01067", "HG01070", "HG01073", "HG01077", "HG01080", "HG01086", "HG01089", "HG01092", "HG01095", "HG01098", "HG01102", "HG01105", "HG01108", "HG01111", "HG01113", "HG01119", "HG01122", "HG01125", "HG01131", "HG01137", "HG01140", "HG01149", "HG01162", "HG01168", "HG01171", "HG01174", "HG01177", "HG01183", "HG01188", "HG01191", "HG01205", "HG01242", "HG01248", "HG01251", "HG01254", "HG01257", "HG01269", "HG01272", "HG01281", "HG01284", "HG01303", "HG01312", "HG01323", "HG01326", "HG01342", "HG01345", "HG01351", "HG01357", "HG01360", "HG01363", "HG01366", "HG01369", "HG01372", "HG01375", "HG01378", "HG01384", "HG01390", "HG01393", "HG01396", "HG01403", "HG01414", "HG01432", "HG01435", "HG01441", "HG01444", "HG01447", "HG01456", "HG01459", "HG01462", "HG01474", "HG01486", "HG01489", "HG01492", "HG01495", "HG01551", "HG01566", "HG01572", "HG01578", "HG01893", "HG01918", "HG01921", "HG01924", "HG01927", "HG01933", "HG01936", "HG01939", "HG01942", "HG01945", "HG01948", "HG01954", "HG01965", "HG01968", "HG01971", "HG01973", "HG01976", "HG01980", "HG01992", "HG01997", "HG02003", "HG02006", "HG02089", "HG02102", "HG02105", "HG02147", "HG02252", "HG02260", "HG02266", "HG02272", "HG02275", "HG02278", "HG02286", "HG02292", "HG02298", "HG02301", "HG02312", "HG02345", "HG02348", "HG02425", "NA19651", "NA19654", "NA19663", "NA19669", "NA19678", "NA19681", "NA19684", "NA19716", "NA19719", "NA19722", "NA19725", "NA19728", "NA19731", "NA19734", "NA19740", "NA19746", "NA19749", "NA19752", "NA19755", "NA19758", "NA19761", "NA19764", "NA19770", "NA19773", "NA19776", "NA19779", "NA19782", "NA19785", "NA19788", "NA19794")
EAS <- c("HG00404", "HG00407", "HG00410", "HG00419", "HG00422", "HG00428", "HG00437", "HG00443", "HG00446", "HG00449", "HG00452", "HG00458", "HG00464", "HG00473", "HG00476", "HG00479", "HG00513", "HG00525", "HG00531", "HG00534", "HG00537", "HG00543", "HG00557", "HG00560", "HG00566", "HG00584", "HG00590", "HG00593", "HG00596", "HG00599", "HG00608", "HG00611", "HG00614", "HG00620", "HG00623", "HG00626", "HG00629", "HG00632", "HG00651", "HG00654", "HG00657", "HG00663", "HG00672", "HG00675", "HG00684", "HG00690", "HG00693", "HG00699", "HG00705", "HG00717", "HG00729", "HG00759", "HG00851", "HG00864", "HG00867", "HG00879", "HG00956", "HG00978", "HG01029", "HG01046", "HG01595", "HG01597", "HG01598", "HG01599", "HG01600", "HG01794", "HG01796", "HG01797", "HG01798", "HG01799", "HG01800", "HG01801", "HG01802", "HG01804", "HG01805", "HG01806", "HG01807", "HG01808", "HG01809", "HG01812", "HG01813", "HG01815", "HG01817", "HG01841", "HG01843", "HG01845", "HG01847", "HG01848", "HG01850", "HG01851", "HG01853", "HG01855", "HG01857", "HG01858", "HG01859", "HG01862", "HG01863", "HG01868", "HG01869", "HG01870", "HG01871", "HG01874", "HG01878", "HG02016", "HG02019", "HG02025", "HG02028", "HG02031", "HG02048", "HG02049", "HG02057", "HG02069", "HG02072", "HG02075", "HG02078", "HG02081", "HG02084", "HG02086", "HG02087", "HG02113", "HG02121", "HG02127", "HG02130", "HG02133", "HG02136", "HG02139", "HG02140", "HG02142", "HG02151", "HG02152", "HG02153", "HG02154", "HG02155", "HG02156", "HG02164", "HG02165", "HG02178", "HG02179", "HG02180", "HG02181", "HG02182", "HG02184", "HG02185", "HG02186", "HG02187", "HG02190", "HG02513", "HG02522", "NA18525", "NA18526", "NA18528", "NA18531", "NA18532", "NA18533", "NA18535", "NA18537", "NA18538", "NA18539", "NA18541", "NA18542", "NA18545", "NA18547", "NA18550", "NA18552", "NA18553", "NA18555", "NA18560", "NA18564", "NA18565", "NA18566", "NA18567", "NA18570", "NA18571", "NA18573", "NA18574", "NA18577", "NA18579", "NA18582", "NA18591", "NA18592", "NA18593", "NA18595", "NA18596", "NA18597", "NA18599", "NA18602", "NA18610", "NA18614", "NA18615", "NA18616", "NA18617", "NA18618", "NA18619", "NA18625", "NA18626", "NA18627", "NA18628", "NA18630", "NA18631", "NA18634", "NA18640", "NA18641", "NA18642", "NA18644", "NA18646", "NA18939", "NA18941", "NA18942", "NA18946", "NA18947", "NA18949", "NA18950", "NA18951", "NA18954", "NA18956", "NA18957", "NA18963", "NA18964", "NA18968", "NA18969", "NA18972", "NA18973", "NA18975", "NA18976", "NA18978", "NA18979", "NA18980", "NA18981", "NA18991", "NA18993", "NA18997", "NA18998", "NA18999", "NA19001", "NA19002", "NA19003", "NA19010", "NA19011", "NA19054", "NA19057", "NA19059", "NA19064", "NA19065", "NA19074", "NA19077", "NA19078", "NA19080", "NA19081", "NA19084", "NA19087", "NA19090")
EUR <- c("HG00097", "HG00099", "HG00102", "HG00110", "HG00111", "HG00118", "HG00120", "HG00121", "HG00122", "HG00125", "HG00127", "HG00128", "HG00130", "HG00132", "HG00133", "HG00137", "HG00146", "HG00150", "HG00154", "HG00158", "HG00171", "HG00173", "HG00174", "HG00176", "HG00177", "HG00178", "HG00179", "HG00180", "HG00231", "HG00232", "HG00233", "HG00235", "HG00236", "HG00237", "HG00238", "HG00239", "HG00245", "HG00250", "HG00253", "HG00254", "HG00255", "HG00257", "HG00258", "HG00259", "HG00261", "HG00262", "HG00263", "HG00266", "HG00268", "HG00269", "HG00272", "HG00274", "HG00275", "HG00276", "HG00281", "HG00282", "HG00285", "HG00288", "HG00304", "HG00306", "HG00309", "HG00313", "HG00315", "HG00318", "HG00319", "HG00320", "HG00323", "HG00324", "HG00326", "HG00327", "HG00328", "HG00330", "HG00331", "HG00332", "HG00334", "HG00337", "HG00339", "HG00343", "HG00344", "HG00346", "HG00349", "HG00350", "HG00353", "HG00355", "HG00356", "HG00357", "HG00361", "HG00362", "HG00364", "HG00365", "HG00367", "HG00368", "HG00373", "HG00376", "HG00378", "HG00379", "HG00380", "HG00381", "HG00383", "HG00384", "HG01501", "HG01504", "HG01507", "HG01510", "HG01513", "HG01516", "HG01519", "HG01522", "HG01525", "HG01528", "HG01531", "HG01537", "HG01602", "HG01605", "HG01607", "HG01612", "HG01613", "HG01618", "HG01620", "HG01623", "HG01626", "HG01628", "HG01632", "HG01668", "HG01670", "HG01673", "HG01676", "HG01679", "HG01684", "HG01685", "HG01695", "HG01697", "HG01702", "HG01704", "HG01707", "HG01710", "HG01746", "HG01757", "HG01762", "HG01766", "HG01768", "HG01770", "HG01773", "HG01776", "HG01779", "HG01784", "HG01786", "HG01790", "HG02215", "HG02220", "HG02223", "HG02230", "HG02232", "HG02235", "HG02239", "NA06985", "NA06989", "NA07000", "NA07037", "NA07056", "NA10847", "NA11830", "NA11832", "NA11840", "NA11892", "NA11894", "NA11918", "NA11920", "NA11933", "NA11995", "NA12004", "NA12006", "NA12044", "NA12046", "NA12058", "NA12156", "NA12234", "NA12249", "NA12273", "NA12275", "NA12283", "NA12287", "NA12341", "NA12348", "NA12400", "NA12414", "NA12489", "NA12717", "NA12718", "NA12749", "NA12751", "NA12761", "NA12763", "NA12776", "NA12778", "NA12813", "NA12815", "NA12828", "NA12830", "NA12843", "NA12873", "NA12878", "NA12890", "NA20502", "NA20503", "NA20504", "NA20505", "NA20506", "NA20507", "NA20508", "NA20514", "NA20517", "NA20522", "NA20529", "NA20530", "NA20531", "NA20533", "NA20535", "NA20540", "NA20541", "NA20542", "NA20582", "NA20585", "NA20587", "NA20589", "NA20753", "NA20756", "NA20757", "NA20760", "NA20761", "NA20764", "NA20766", "NA20768", "NA20769", "NA20771", "NA20772", "NA20773", "NA20774", "NA20775", "NA20790", "NA20795", "NA20797", "NA20799", "NA20800", "NA20802", "NA20804", "NA20807", "NA20808", "NA20813", "NA20818", "NA20819", "NA20821", "NA20822", "NA20826", "NA20828", "NA20832")
SAS <- c("HG02491", "HG02494", "HG02601", "HG02652", "HG02661", "HG02688", "HG02697", "HG02725", "HG02728", "HG02731", "HG02737", "HG02775", "HG02778", "HG02784", "HG02787", "HG02790", "HG02793", "HG03007", "HG03016", "HG03235", "HG03238", "HG03488", "HG03491", "HG03589", "HG03595", "HG03598", "HG03604", "HG03607", "HG03611", "HG03616", "HG03631", "HG03634", "HG03640", "HG03642", "HG03643", "HG03645", "HG03653", "HG03668", "HG03673", "HG03684", "HG03689", "HG03692", "HG03698", "HG03703", "HG03706", "HG03709", "HG03714", "HG03717", "HG03730", "HG03731", "HG03736", "HG03757", "HG03760", "HG03762", "HG03765", "HG03770", "HG03772", "HG03774", "HG03780", "HG03781", "HG03782", "HG03787", "HG03789", "HG03793", "HG03796", "HG03802", "HG03805", "HG03808", "HG03814", "HG03817", "HG03823", "HG03826", "HG03829", "HG03832", "HG03849", "HG03857", "HG03861", "HG03863", "HG03868", "HG03874", "HG03882", "HG03886", "HG03888", "HG03897", "HG03907", "HG03910", "HG03913", "HG03916", "HG03919", "HG03922", "HG03925", "HG03928", "HG03931", "HG03934", "HG03937", "HG03940", "HG03945", "HG03947", "HG03949", "HG03951", "HG03968", "HG03973", "HG03977", "HG03986", "HG03989", "HG04001", "HG04014", "HG04018", "HG04025", "HG04026", "HG04042", "HG04047", "HG04059", "HG04062", "HG04063", "HG04075", "HG04076", "HG04090", "HG04099", "HG04118", "HG04141", "HG04144", "HG04153", "HG04156", "HG04159", "HG04171", "HG04177", "HG04180", "HG04183", "HG04186", "HG04189", "HG04195", "HG04200", "HG04202", "HG04212", "HG04214", "HG04216", "HG04227", "NA20847", "NA20849", "NA20851", "NA20853", "NA20854", "NA20856", "NA20859", "NA20862", "NA20868", "NA20869", "NA20872", "NA20874", "NA20875", "NA20876", "NA20877", "NA20878", "NA20881", "NA20882", "NA20888", "NA20892", "NA20894", "NA20896", "NA20899", "NA20902", "NA20906", "NA20908", "NA20910", "NA21086", "NA21088", "NA21089", "NA21097", "NA21101", "NA21102", "NA21103", "NA21106", "NA21108", "NA21110", "NA21120", "NA21122", "NA21125", "NA21137", "NA21141", "NA21143", "NA21144")
Clusters_5 <- set.populations(Clusters_5, list(AFR,AMR,EAS,EUR,SAS), diploid = TRUE)
Clusters_5 <- set.outgroup(Clusters_5, c("Chimp"), diploid=TRUE)

#F_ST
Clusters_5 <- F_ST.stats(Clusters_5, mode="nucleotide")
Clusters_5@nuc.F_ST.vs.all [[1]]
Clusters_5@nuc.F_ST.vs.all [[2]]
Clusters_5@nuc.F_ST.vs.all [[3]]
Clusters_5@nuc.F_ST.vs.all [[4]]
Clusters_5@nuc.F_ST.vs.all [[5]]

#Cluster_6
Clusters_6 <- readVCF("new_chr7.vcf.gz", numcols=10000, tid="7", from=63200389, to=63215405, include.unknown = TRUE)
Clusters_6 <- set.outgroup(Clusters_6, c("Chimp"), diploid=TRUE)
get.sum.data(Clusters_6) 

#Divergence
bial <- get.biallelic.matrix(Clusters_6,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites6 <- sum (div & !polym,na.rm=T)
divsites6
D <- divsites6/15016
D

#Mutation rate
Clusters_6 <- neutrality.stats(Clusters_6)
Mu <- (Clusters_6@theta_Watterson/15016)/40000
Mu

#Pi_Cluster6
individuals <- get.individuals(Clusters_6)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 

bial <- get.biallelic.matrix(Clusters_6,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters_6@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 63200389:63215405))) # N polyallelic sites in that region
m <- 15016-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

AFR <- c("HG01880", "HG01883", "HG01886", "HG01889", "HG01894", "HG01896", "HG01956", "HG01958", "HG01985", "HG01989", "HG02010", "HG02012", "HG02052", "HG02054", "HG02095", "HG02108", "HG02111", "HG02144", "HG02256", "HG02282", "HG02308", "HG02309", "HG02315", "HG02318", "HG02322", "HG02325", "HG02337", "HG02339", "HG02419", "HG02427", "HG02450", "HG02462", "HG02465", "HG02476", "HG02477", "HG02479", "HG02485", "HG02497", "HG02502", "HG02505", "HG02508", "HG02511", "HG02537", "HG02546", "HG02549", "HG02555", "HG02558", "HG02562", "HG02568", "HG02571", "HG02574", "HG02577", "HG02580", "HG02583", "HG02586", "HG02589", "HG02595", "HG02611", "HG02614", "HG02621", "HG02629", "HG02635", "HG02646", "HG02667", "HG02676", "HG02679", "HG02703", "HG02716", "HG02722", "HG02757", "HG02760", "HG02763", "HG02769", "HG02772", "HG02799", "HG02808", "HG02811", "HG02814", "HG02817", "HG02820", "HG02837", "HG02840", "HG02855", "HG02861", "HG02870", "HG02879", "HG02882", "HG02885", "HG02888", "HG02891", "HG02922", "HG02943", "HG02946", "HG02952", "HG02970", "HG02974", "HG02976", "HG02979", "HG02983", "HG03025", "HG03028", "HG03040", "HG03049", "HG03052", "HG03055", "HG03058", "HG03061", "HG03064", "HG03073", "HG03079", "HG03082", "HG03086", "HG03088", "HG03091", "HG03095", "HG03099", "HG03105", "HG03108", "HG03111", "HG03117", "HG03123", "HG03126", "HG03129", "HG03132", "HG03135", "HG03159", "HG03162", "HG03168", "HG03189", "HG03195", "HG03198", "HG03212", "HG03267", "HG03270", "HG03279", "HG03291", "HG03294", "HG03297", "HG03303", "HG03342", "HG03351", "HG03363", "HG03366", "HG03369", "HG03372", "HG03378", "HG03401", "HG03410", "HG03419", "HG03437", "HG03446", "HG03449", "HG03452", "HG03455", "HG03461", "HG03470", "HG03473", "HG03476", "HG03479", "HG03485", "HG03499", "HG03511", "HG03514", "HG03517", "HG03520", "HG03539", "HG03548", "HG03558", "HG03563", "HG03567", "HG03572", "HG03575", "HG03578", "HG03583", "NA18488", "NA18489", "NA18499", "NA18502", "NA18505", "NA18508", "NA18511", "NA18517", "NA18520", "NA18523", "NA18858", "NA18861", "NA18864", "NA18867", "NA18870", "NA18873", "NA18876", "NA18878", "NA18881", "NA18907", "NA18909", "NA18912", "NA18916", "NA18924", "NA18933", "NA19017", "NA19019", "NA19023", "NA19024", "NA19030", "NA19036", "NA19037", "NA19038", "NA19093", "NA19095", "NA19099", "NA19102", "NA19108", "NA19114", "NA19116", "NA19118", "NA19129", "NA19131", "NA19137", "NA19143", "NA19147", "NA19149", "NA19152", "NA19159", "NA19172", "NA19185", "NA19190", "NA19197", "NA19201", "NA19204", "NA19206", "NA19209", "NA19214", "NA19222", "NA19225", "NA19235", "NA19238", "NA19247", "NA19310", "NA19314", "NA19315", "NA19321", "NA19323", "NA19324", "NA19327", "NA19328", "NA19332", "NA19338", "NA19351", "NA19355", "NA19377", "NA19378", "NA19390", "NA19391", "NA19399", "NA19401", "NA19403", "NA19404", "NA19431", "NA19435", "NA19436", "NA19437", "NA19438", "NA19439", "NA19440", "NA19445", "NA19446", "NA19449", "NA19456", "NA19457", "NA19462", "NA19463", "NA19467", "NA19468", "NA19472", "NA19473", "NA19474", "NA19475", "NA19701", "NA19707", "NA19712", "NA19819", "NA19835", "NA19901", "NA19909", "NA19914", "NA19917", "NA19921", "NA19923", "NA20127", "NA20274", "NA20276", "NA20282", "NA20287", "NA20289", "NA20294", "NA20317", "NA20321", "NA20332", "NA20334", "NA20339", "NA20357", "NA20359", "NA20412")
AMR <- c("HG00551", "HG00554", "HG00638", "HG00641", "HG00732", "HG00734", "HG00737", "HG00740", "HG00743", "HG01049", "HG01052", "HG01055", "HG01058", "HG01064", "HG01067", "HG01070", "HG01073", "HG01077", "HG01080", "HG01086", "HG01089", "HG01092", "HG01095", "HG01098", "HG01102", "HG01105", "HG01108", "HG01111", "HG01113", "HG01119", "HG01122", "HG01125", "HG01131", "HG01137", "HG01140", "HG01149", "HG01162", "HG01168", "HG01171", "HG01174", "HG01177", "HG01183", "HG01188", "HG01191", "HG01205", "HG01242", "HG01248", "HG01251", "HG01254", "HG01257", "HG01269", "HG01272", "HG01281", "HG01284", "HG01303", "HG01312", "HG01323", "HG01326", "HG01342", "HG01345", "HG01351", "HG01357", "HG01360", "HG01363", "HG01366", "HG01369", "HG01372", "HG01375", "HG01378", "HG01384", "HG01390", "HG01393", "HG01396", "HG01403", "HG01414", "HG01432", "HG01435", "HG01441", "HG01444", "HG01447", "HG01456", "HG01459", "HG01462", "HG01474", "HG01486", "HG01489", "HG01492", "HG01495", "HG01551", "HG01566", "HG01572", "HG01578", "HG01893", "HG01918", "HG01921", "HG01924", "HG01927", "HG01933", "HG01936", "HG01939", "HG01942", "HG01945", "HG01948", "HG01954", "HG01965", "HG01968", "HG01971", "HG01973", "HG01976", "HG01980", "HG01992", "HG01997", "HG02003", "HG02006", "HG02089", "HG02102", "HG02105", "HG02147", "HG02252", "HG02260", "HG02266", "HG02272", "HG02275", "HG02278", "HG02286", "HG02292", "HG02298", "HG02301", "HG02312", "HG02345", "HG02348", "HG02425", "NA19651", "NA19654", "NA19663", "NA19669", "NA19678", "NA19681", "NA19684", "NA19716", "NA19719", "NA19722", "NA19725", "NA19728", "NA19731", "NA19734", "NA19740", "NA19746", "NA19749", "NA19752", "NA19755", "NA19758", "NA19761", "NA19764", "NA19770", "NA19773", "NA19776", "NA19779", "NA19782", "NA19785", "NA19788", "NA19794")
EAS <- c("HG00404", "HG00407", "HG00410", "HG00419", "HG00422", "HG00428", "HG00437", "HG00443", "HG00446", "HG00449", "HG00452", "HG00458", "HG00464", "HG00473", "HG00476", "HG00479", "HG00513", "HG00525", "HG00531", "HG00534", "HG00537", "HG00543", "HG00557", "HG00560", "HG00566", "HG00584", "HG00590", "HG00593", "HG00596", "HG00599", "HG00608", "HG00611", "HG00614", "HG00620", "HG00623", "HG00626", "HG00629", "HG00632", "HG00651", "HG00654", "HG00657", "HG00663", "HG00672", "HG00675", "HG00684", "HG00690", "HG00693", "HG00699", "HG00705", "HG00717", "HG00729", "HG00759", "HG00851", "HG00864", "HG00867", "HG00879", "HG00956", "HG00978", "HG01029", "HG01046", "HG01595", "HG01597", "HG01598", "HG01599", "HG01600", "HG01794", "HG01796", "HG01797", "HG01798", "HG01799", "HG01800", "HG01801", "HG01802", "HG01804", "HG01805", "HG01806", "HG01807", "HG01808", "HG01809", "HG01812", "HG01813", "HG01815", "HG01817", "HG01841", "HG01843", "HG01845", "HG01847", "HG01848", "HG01850", "HG01851", "HG01853", "HG01855", "HG01857", "HG01858", "HG01859", "HG01862", "HG01863", "HG01868", "HG01869", "HG01870", "HG01871", "HG01874", "HG01878", "HG02016", "HG02019", "HG02025", "HG02028", "HG02031", "HG02048", "HG02049", "HG02057", "HG02069", "HG02072", "HG02075", "HG02078", "HG02081", "HG02084", "HG02086", "HG02087", "HG02113", "HG02121", "HG02127", "HG02130", "HG02133", "HG02136", "HG02139", "HG02140", "HG02142", "HG02151", "HG02152", "HG02153", "HG02154", "HG02155", "HG02156", "HG02164", "HG02165", "HG02178", "HG02179", "HG02180", "HG02181", "HG02182", "HG02184", "HG02185", "HG02186", "HG02187", "HG02190", "HG02513", "HG02522", "NA18525", "NA18526", "NA18528", "NA18531", "NA18532", "NA18533", "NA18535", "NA18537", "NA18538", "NA18539", "NA18541", "NA18542", "NA18545", "NA18547", "NA18550", "NA18552", "NA18553", "NA18555", "NA18560", "NA18564", "NA18565", "NA18566", "NA18567", "NA18570", "NA18571", "NA18573", "NA18574", "NA18577", "NA18579", "NA18582", "NA18591", "NA18592", "NA18593", "NA18595", "NA18596", "NA18597", "NA18599", "NA18602", "NA18610", "NA18614", "NA18615", "NA18616", "NA18617", "NA18618", "NA18619", "NA18625", "NA18626", "NA18627", "NA18628", "NA18630", "NA18631", "NA18634", "NA18640", "NA18641", "NA18642", "NA18644", "NA18646", "NA18939", "NA18941", "NA18942", "NA18946", "NA18947", "NA18949", "NA18950", "NA18951", "NA18954", "NA18956", "NA18957", "NA18963", "NA18964", "NA18968", "NA18969", "NA18972", "NA18973", "NA18975", "NA18976", "NA18978", "NA18979", "NA18980", "NA18981", "NA18991", "NA18993", "NA18997", "NA18998", "NA18999", "NA19001", "NA19002", "NA19003", "NA19010", "NA19011", "NA19054", "NA19057", "NA19059", "NA19064", "NA19065", "NA19074", "NA19077", "NA19078", "NA19080", "NA19081", "NA19084", "NA19087", "NA19090")
EUR <- c("HG00097", "HG00099", "HG00102", "HG00110", "HG00111", "HG00118", "HG00120", "HG00121", "HG00122", "HG00125", "HG00127", "HG00128", "HG00130", "HG00132", "HG00133", "HG00137", "HG00146", "HG00150", "HG00154", "HG00158", "HG00171", "HG00173", "HG00174", "HG00176", "HG00177", "HG00178", "HG00179", "HG00180", "HG00231", "HG00232", "HG00233", "HG00235", "HG00236", "HG00237", "HG00238", "HG00239", "HG00245", "HG00250", "HG00253", "HG00254", "HG00255", "HG00257", "HG00258", "HG00259", "HG00261", "HG00262", "HG00263", "HG00266", "HG00268", "HG00269", "HG00272", "HG00274", "HG00275", "HG00276", "HG00281", "HG00282", "HG00285", "HG00288", "HG00304", "HG00306", "HG00309", "HG00313", "HG00315", "HG00318", "HG00319", "HG00320", "HG00323", "HG00324", "HG00326", "HG00327", "HG00328", "HG00330", "HG00331", "HG00332", "HG00334", "HG00337", "HG00339", "HG00343", "HG00344", "HG00346", "HG00349", "HG00350", "HG00353", "HG00355", "HG00356", "HG00357", "HG00361", "HG00362", "HG00364", "HG00365", "HG00367", "HG00368", "HG00373", "HG00376", "HG00378", "HG00379", "HG00380", "HG00381", "HG00383", "HG00384", "HG01501", "HG01504", "HG01507", "HG01510", "HG01513", "HG01516", "HG01519", "HG01522", "HG01525", "HG01528", "HG01531", "HG01537", "HG01602", "HG01605", "HG01607", "HG01612", "HG01613", "HG01618", "HG01620", "HG01623", "HG01626", "HG01628", "HG01632", "HG01668", "HG01670", "HG01673", "HG01676", "HG01679", "HG01684", "HG01685", "HG01695", "HG01697", "HG01702", "HG01704", "HG01707", "HG01710", "HG01746", "HG01757", "HG01762", "HG01766", "HG01768", "HG01770", "HG01773", "HG01776", "HG01779", "HG01784", "HG01786", "HG01790", "HG02215", "HG02220", "HG02223", "HG02230", "HG02232", "HG02235", "HG02239", "NA06985", "NA06989", "NA07000", "NA07037", "NA07056", "NA10847", "NA11830", "NA11832", "NA11840", "NA11892", "NA11894", "NA11918", "NA11920", "NA11933", "NA11995", "NA12004", "NA12006", "NA12044", "NA12046", "NA12058", "NA12156", "NA12234", "NA12249", "NA12273", "NA12275", "NA12283", "NA12287", "NA12341", "NA12348", "NA12400", "NA12414", "NA12489", "NA12717", "NA12718", "NA12749", "NA12751", "NA12761", "NA12763", "NA12776", "NA12778", "NA12813", "NA12815", "NA12828", "NA12830", "NA12843", "NA12873", "NA12878", "NA12890", "NA20502", "NA20503", "NA20504", "NA20505", "NA20506", "NA20507", "NA20508", "NA20514", "NA20517", "NA20522", "NA20529", "NA20530", "NA20531", "NA20533", "NA20535", "NA20540", "NA20541", "NA20542", "NA20582", "NA20585", "NA20587", "NA20589", "NA20753", "NA20756", "NA20757", "NA20760", "NA20761", "NA20764", "NA20766", "NA20768", "NA20769", "NA20771", "NA20772", "NA20773", "NA20774", "NA20775", "NA20790", "NA20795", "NA20797", "NA20799", "NA20800", "NA20802", "NA20804", "NA20807", "NA20808", "NA20813", "NA20818", "NA20819", "NA20821", "NA20822", "NA20826", "NA20828", "NA20832")
SAS <- c("HG02491", "HG02494", "HG02601", "HG02652", "HG02661", "HG02688", "HG02697", "HG02725", "HG02728", "HG02731", "HG02737", "HG02775", "HG02778", "HG02784", "HG02787", "HG02790", "HG02793", "HG03007", "HG03016", "HG03235", "HG03238", "HG03488", "HG03491", "HG03589", "HG03595", "HG03598", "HG03604", "HG03607", "HG03611", "HG03616", "HG03631", "HG03634", "HG03640", "HG03642", "HG03643", "HG03645", "HG03653", "HG03668", "HG03673", "HG03684", "HG03689", "HG03692", "HG03698", "HG03703", "HG03706", "HG03709", "HG03714", "HG03717", "HG03730", "HG03731", "HG03736", "HG03757", "HG03760", "HG03762", "HG03765", "HG03770", "HG03772", "HG03774", "HG03780", "HG03781", "HG03782", "HG03787", "HG03789", "HG03793", "HG03796", "HG03802", "HG03805", "HG03808", "HG03814", "HG03817", "HG03823", "HG03826", "HG03829", "HG03832", "HG03849", "HG03857", "HG03861", "HG03863", "HG03868", "HG03874", "HG03882", "HG03886", "HG03888", "HG03897", "HG03907", "HG03910", "HG03913", "HG03916", "HG03919", "HG03922", "HG03925", "HG03928", "HG03931", "HG03934", "HG03937", "HG03940", "HG03945", "HG03947", "HG03949", "HG03951", "HG03968", "HG03973", "HG03977", "HG03986", "HG03989", "HG04001", "HG04014", "HG04018", "HG04025", "HG04026", "HG04042", "HG04047", "HG04059", "HG04062", "HG04063", "HG04075", "HG04076", "HG04090", "HG04099", "HG04118", "HG04141", "HG04144", "HG04153", "HG04156", "HG04159", "HG04171", "HG04177", "HG04180", "HG04183", "HG04186", "HG04189", "HG04195", "HG04200", "HG04202", "HG04212", "HG04214", "HG04216", "HG04227", "NA20847", "NA20849", "NA20851", "NA20853", "NA20854", "NA20856", "NA20859", "NA20862", "NA20868", "NA20869", "NA20872", "NA20874", "NA20875", "NA20876", "NA20877", "NA20878", "NA20881", "NA20882", "NA20888", "NA20892", "NA20894", "NA20896", "NA20899", "NA20902", "NA20906", "NA20908", "NA20910", "NA21086", "NA21088", "NA21089", "NA21097", "NA21101", "NA21102", "NA21103", "NA21106", "NA21108", "NA21110", "NA21120", "NA21122", "NA21125", "NA21137", "NA21141", "NA21143", "NA21144")
Clusters_6 <- set.populations(Clusters_6, list(AFR,AMR,EAS,EUR,SAS), diploid = TRUE)
Clusters_6 <- set.outgroup(Clusters_6, c("Chimp"), diploid=TRUE)

#F_ST
Clusters_6 <- F_ST.stats(Clusters_6, mode="nucleotide")
Clusters_6@nuc.F_ST.vs.all [[1]]
Clusters_6@nuc.F_ST.vs.all [[2]]
Clusters_6@nuc.F_ST.vs.all [[3]]
Clusters_6@nuc.F_ST.vs.all [[4]]
Clusters_6@nuc.F_ST.vs.all [[5]]

#Cluster_7
Clusters_7 <- readVCF("new_chr7.vcf.gz", numcols=10000, tid="7", from=64293379, to=64300618, include.unknown = TRUE)
Clusters_7 <- set.outgroup(Clusters_7, c("Chimp"), diploid=TRUE)
get.sum.data(Clusters_7) 

#Divergence
bial <- get.biallelic.matrix(Clusters_7,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites7 <- sum (div & !polym,na.rm=T)
divsites7
D <- divsites7/4957
D

#Mutation rate
Clusters_7 <- neutrality.stats(Clusters_7)
Mu <- (Clusters_7@theta_Watterson/4957)/40000
Mu

#Pi_Cluster7
individuals <- get.individuals(Clusters_7)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 

bial <- get.biallelic.matrix(Clusters_7,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters_7@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 64293379:64300618))) # N polyallelic sites in that region
m <- 4957-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

AFR <- c("HG01880", "HG01883", "HG01886", "HG01889", "HG01894", "HG01896", "HG01956", "HG01958", "HG01985", "HG01989", "HG02010", "HG02012", "HG02052", "HG02054", "HG02095", "HG02108", "HG02111", "HG02144", "HG02256", "HG02282", "HG02308", "HG02309", "HG02315", "HG02318", "HG02322", "HG02325", "HG02337", "HG02339", "HG02419", "HG02427", "HG02450", "HG02462", "HG02465", "HG02476", "HG02477", "HG02479", "HG02485", "HG02497", "HG02502", "HG02505", "HG02508", "HG02511", "HG02537", "HG02546", "HG02549", "HG02555", "HG02558", "HG02562", "HG02568", "HG02571", "HG02574", "HG02577", "HG02580", "HG02583", "HG02586", "HG02589", "HG02595", "HG02611", "HG02614", "HG02621", "HG02629", "HG02635", "HG02646", "HG02667", "HG02676", "HG02679", "HG02703", "HG02716", "HG02722", "HG02757", "HG02760", "HG02763", "HG02769", "HG02772", "HG02799", "HG02808", "HG02811", "HG02814", "HG02817", "HG02820", "HG02837", "HG02840", "HG02855", "HG02861", "HG02870", "HG02879", "HG02882", "HG02885", "HG02888", "HG02891", "HG02922", "HG02943", "HG02946", "HG02952", "HG02970", "HG02974", "HG02976", "HG02979", "HG02983", "HG03025", "HG03028", "HG03040", "HG03049", "HG03052", "HG03055", "HG03058", "HG03061", "HG03064", "HG03073", "HG03079", "HG03082", "HG03086", "HG03088", "HG03091", "HG03095", "HG03099", "HG03105", "HG03108", "HG03111", "HG03117", "HG03123", "HG03126", "HG03129", "HG03132", "HG03135", "HG03159", "HG03162", "HG03168", "HG03189", "HG03195", "HG03198", "HG03212", "HG03267", "HG03270", "HG03279", "HG03291", "HG03294", "HG03297", "HG03303", "HG03342", "HG03351", "HG03363", "HG03366", "HG03369", "HG03372", "HG03378", "HG03401", "HG03410", "HG03419", "HG03437", "HG03446", "HG03449", "HG03452", "HG03455", "HG03461", "HG03470", "HG03473", "HG03476", "HG03479", "HG03485", "HG03499", "HG03511", "HG03514", "HG03517", "HG03520", "HG03539", "HG03548", "HG03558", "HG03563", "HG03567", "HG03572", "HG03575", "HG03578", "HG03583", "NA18488", "NA18489", "NA18499", "NA18502", "NA18505", "NA18508", "NA18511", "NA18517", "NA18520", "NA18523", "NA18858", "NA18861", "NA18864", "NA18867", "NA18870", "NA18873", "NA18876", "NA18878", "NA18881", "NA18907", "NA18909", "NA18912", "NA18916", "NA18924", "NA18933", "NA19017", "NA19019", "NA19023", "NA19024", "NA19030", "NA19036", "NA19037", "NA19038", "NA19093", "NA19095", "NA19099", "NA19102", "NA19108", "NA19114", "NA19116", "NA19118", "NA19129", "NA19131", "NA19137", "NA19143", "NA19147", "NA19149", "NA19152", "NA19159", "NA19172", "NA19185", "NA19190", "NA19197", "NA19201", "NA19204", "NA19206", "NA19209", "NA19214", "NA19222", "NA19225", "NA19235", "NA19238", "NA19247", "NA19310", "NA19314", "NA19315", "NA19321", "NA19323", "NA19324", "NA19327", "NA19328", "NA19332", "NA19338", "NA19351", "NA19355", "NA19377", "NA19378", "NA19390", "NA19391", "NA19399", "NA19401", "NA19403", "NA19404", "NA19431", "NA19435", "NA19436", "NA19437", "NA19438", "NA19439", "NA19440", "NA19445", "NA19446", "NA19449", "NA19456", "NA19457", "NA19462", "NA19463", "NA19467", "NA19468", "NA19472", "NA19473", "NA19474", "NA19475", "NA19701", "NA19707", "NA19712", "NA19819", "NA19835", "NA19901", "NA19909", "NA19914", "NA19917", "NA19921", "NA19923", "NA20127", "NA20274", "NA20276", "NA20282", "NA20287", "NA20289", "NA20294", "NA20317", "NA20321", "NA20332", "NA20334", "NA20339", "NA20357", "NA20359", "NA20412")
AMR <- c("HG00551", "HG00554", "HG00638", "HG00641", "HG00732", "HG00734", "HG00737", "HG00740", "HG00743", "HG01049", "HG01052", "HG01055", "HG01058", "HG01064", "HG01067", "HG01070", "HG01073", "HG01077", "HG01080", "HG01086", "HG01089", "HG01092", "HG01095", "HG01098", "HG01102", "HG01105", "HG01108", "HG01111", "HG01113", "HG01119", "HG01122", "HG01125", "HG01131", "HG01137", "HG01140", "HG01149", "HG01162", "HG01168", "HG01171", "HG01174", "HG01177", "HG01183", "HG01188", "HG01191", "HG01205", "HG01242", "HG01248", "HG01251", "HG01254", "HG01257", "HG01269", "HG01272", "HG01281", "HG01284", "HG01303", "HG01312", "HG01323", "HG01326", "HG01342", "HG01345", "HG01351", "HG01357", "HG01360", "HG01363", "HG01366", "HG01369", "HG01372", "HG01375", "HG01378", "HG01384", "HG01390", "HG01393", "HG01396", "HG01403", "HG01414", "HG01432", "HG01435", "HG01441", "HG01444", "HG01447", "HG01456", "HG01459", "HG01462", "HG01474", "HG01486", "HG01489", "HG01492", "HG01495", "HG01551", "HG01566", "HG01572", "HG01578", "HG01893", "HG01918", "HG01921", "HG01924", "HG01927", "HG01933", "HG01936", "HG01939", "HG01942", "HG01945", "HG01948", "HG01954", "HG01965", "HG01968", "HG01971", "HG01973", "HG01976", "HG01980", "HG01992", "HG01997", "HG02003", "HG02006", "HG02089", "HG02102", "HG02105", "HG02147", "HG02252", "HG02260", "HG02266", "HG02272", "HG02275", "HG02278", "HG02286", "HG02292", "HG02298", "HG02301", "HG02312", "HG02345", "HG02348", "HG02425", "NA19651", "NA19654", "NA19663", "NA19669", "NA19678", "NA19681", "NA19684", "NA19716", "NA19719", "NA19722", "NA19725", "NA19728", "NA19731", "NA19734", "NA19740", "NA19746", "NA19749", "NA19752", "NA19755", "NA19758", "NA19761", "NA19764", "NA19770", "NA19773", "NA19776", "NA19779", "NA19782", "NA19785", "NA19788", "NA19794")
EAS <- c("HG00404", "HG00407", "HG00410", "HG00419", "HG00422", "HG00428", "HG00437", "HG00443", "HG00446", "HG00449", "HG00452", "HG00458", "HG00464", "HG00473", "HG00476", "HG00479", "HG00513", "HG00525", "HG00531", "HG00534", "HG00537", "HG00543", "HG00557", "HG00560", "HG00566", "HG00584", "HG00590", "HG00593", "HG00596", "HG00599", "HG00608", "HG00611", "HG00614", "HG00620", "HG00623", "HG00626", "HG00629", "HG00632", "HG00651", "HG00654", "HG00657", "HG00663", "HG00672", "HG00675", "HG00684", "HG00690", "HG00693", "HG00699", "HG00705", "HG00717", "HG00729", "HG00759", "HG00851", "HG00864", "HG00867", "HG00879", "HG00956", "HG00978", "HG01029", "HG01046", "HG01595", "HG01597", "HG01598", "HG01599", "HG01600", "HG01794", "HG01796", "HG01797", "HG01798", "HG01799", "HG01800", "HG01801", "HG01802", "HG01804", "HG01805", "HG01806", "HG01807", "HG01808", "HG01809", "HG01812", "HG01813", "HG01815", "HG01817", "HG01841", "HG01843", "HG01845", "HG01847", "HG01848", "HG01850", "HG01851", "HG01853", "HG01855", "HG01857", "HG01858", "HG01859", "HG01862", "HG01863", "HG01868", "HG01869", "HG01870", "HG01871", "HG01874", "HG01878", "HG02016", "HG02019", "HG02025", "HG02028", "HG02031", "HG02048", "HG02049", "HG02057", "HG02069", "HG02072", "HG02075", "HG02078", "HG02081", "HG02084", "HG02086", "HG02087", "HG02113", "HG02121", "HG02127", "HG02130", "HG02133", "HG02136", "HG02139", "HG02140", "HG02142", "HG02151", "HG02152", "HG02153", "HG02154", "HG02155", "HG02156", "HG02164", "HG02165", "HG02178", "HG02179", "HG02180", "HG02181", "HG02182", "HG02184", "HG02185", "HG02186", "HG02187", "HG02190", "HG02513", "HG02522", "NA18525", "NA18526", "NA18528", "NA18531", "NA18532", "NA18533", "NA18535", "NA18537", "NA18538", "NA18539", "NA18541", "NA18542", "NA18545", "NA18547", "NA18550", "NA18552", "NA18553", "NA18555", "NA18560", "NA18564", "NA18565", "NA18566", "NA18567", "NA18570", "NA18571", "NA18573", "NA18574", "NA18577", "NA18579", "NA18582", "NA18591", "NA18592", "NA18593", "NA18595", "NA18596", "NA18597", "NA18599", "NA18602", "NA18610", "NA18614", "NA18615", "NA18616", "NA18617", "NA18618", "NA18619", "NA18625", "NA18626", "NA18627", "NA18628", "NA18630", "NA18631", "NA18634", "NA18640", "NA18641", "NA18642", "NA18644", "NA18646", "NA18939", "NA18941", "NA18942", "NA18946", "NA18947", "NA18949", "NA18950", "NA18951", "NA18954", "NA18956", "NA18957", "NA18963", "NA18964", "NA18968", "NA18969", "NA18972", "NA18973", "NA18975", "NA18976", "NA18978", "NA18979", "NA18980", "NA18981", "NA18991", "NA18993", "NA18997", "NA18998", "NA18999", "NA19001", "NA19002", "NA19003", "NA19010", "NA19011", "NA19054", "NA19057", "NA19059", "NA19064", "NA19065", "NA19074", "NA19077", "NA19078", "NA19080", "NA19081", "NA19084", "NA19087", "NA19090")
EUR <- c("HG00097", "HG00099", "HG00102", "HG00110", "HG00111", "HG00118", "HG00120", "HG00121", "HG00122", "HG00125", "HG00127", "HG00128", "HG00130", "HG00132", "HG00133", "HG00137", "HG00146", "HG00150", "HG00154", "HG00158", "HG00171", "HG00173", "HG00174", "HG00176", "HG00177", "HG00178", "HG00179", "HG00180", "HG00231", "HG00232", "HG00233", "HG00235", "HG00236", "HG00237", "HG00238", "HG00239", "HG00245", "HG00250", "HG00253", "HG00254", "HG00255", "HG00257", "HG00258", "HG00259", "HG00261", "HG00262", "HG00263", "HG00266", "HG00268", "HG00269", "HG00272", "HG00274", "HG00275", "HG00276", "HG00281", "HG00282", "HG00285", "HG00288", "HG00304", "HG00306", "HG00309", "HG00313", "HG00315", "HG00318", "HG00319", "HG00320", "HG00323", "HG00324", "HG00326", "HG00327", "HG00328", "HG00330", "HG00331", "HG00332", "HG00334", "HG00337", "HG00339", "HG00343", "HG00344", "HG00346", "HG00349", "HG00350", "HG00353", "HG00355", "HG00356", "HG00357", "HG00361", "HG00362", "HG00364", "HG00365", "HG00367", "HG00368", "HG00373", "HG00376", "HG00378", "HG00379", "HG00380", "HG00381", "HG00383", "HG00384", "HG01501", "HG01504", "HG01507", "HG01510", "HG01513", "HG01516", "HG01519", "HG01522", "HG01525", "HG01528", "HG01531", "HG01537", "HG01602", "HG01605", "HG01607", "HG01612", "HG01613", "HG01618", "HG01620", "HG01623", "HG01626", "HG01628", "HG01632", "HG01668", "HG01670", "HG01673", "HG01676", "HG01679", "HG01684", "HG01685", "HG01695", "HG01697", "HG01702", "HG01704", "HG01707", "HG01710", "HG01746", "HG01757", "HG01762", "HG01766", "HG01768", "HG01770", "HG01773", "HG01776", "HG01779", "HG01784", "HG01786", "HG01790", "HG02215", "HG02220", "HG02223", "HG02230", "HG02232", "HG02235", "HG02239", "NA06985", "NA06989", "NA07000", "NA07037", "NA07056", "NA10847", "NA11830", "NA11832", "NA11840", "NA11892", "NA11894", "NA11918", "NA11920", "NA11933", "NA11995", "NA12004", "NA12006", "NA12044", "NA12046", "NA12058", "NA12156", "NA12234", "NA12249", "NA12273", "NA12275", "NA12283", "NA12287", "NA12341", "NA12348", "NA12400", "NA12414", "NA12489", "NA12717", "NA12718", "NA12749", "NA12751", "NA12761", "NA12763", "NA12776", "NA12778", "NA12813", "NA12815", "NA12828", "NA12830", "NA12843", "NA12873", "NA12878", "NA12890", "NA20502", "NA20503", "NA20504", "NA20505", "NA20506", "NA20507", "NA20508", "NA20514", "NA20517", "NA20522", "NA20529", "NA20530", "NA20531", "NA20533", "NA20535", "NA20540", "NA20541", "NA20542", "NA20582", "NA20585", "NA20587", "NA20589", "NA20753", "NA20756", "NA20757", "NA20760", "NA20761", "NA20764", "NA20766", "NA20768", "NA20769", "NA20771", "NA20772", "NA20773", "NA20774", "NA20775", "NA20790", "NA20795", "NA20797", "NA20799", "NA20800", "NA20802", "NA20804", "NA20807", "NA20808", "NA20813", "NA20818", "NA20819", "NA20821", "NA20822", "NA20826", "NA20828", "NA20832")
SAS <- c("HG02491", "HG02494", "HG02601", "HG02652", "HG02661", "HG02688", "HG02697", "HG02725", "HG02728", "HG02731", "HG02737", "HG02775", "HG02778", "HG02784", "HG02787", "HG02790", "HG02793", "HG03007", "HG03016", "HG03235", "HG03238", "HG03488", "HG03491", "HG03589", "HG03595", "HG03598", "HG03604", "HG03607", "HG03611", "HG03616", "HG03631", "HG03634", "HG03640", "HG03642", "HG03643", "HG03645", "HG03653", "HG03668", "HG03673", "HG03684", "HG03689", "HG03692", "HG03698", "HG03703", "HG03706", "HG03709", "HG03714", "HG03717", "HG03730", "HG03731", "HG03736", "HG03757", "HG03760", "HG03762", "HG03765", "HG03770", "HG03772", "HG03774", "HG03780", "HG03781", "HG03782", "HG03787", "HG03789", "HG03793", "HG03796", "HG03802", "HG03805", "HG03808", "HG03814", "HG03817", "HG03823", "HG03826", "HG03829", "HG03832", "HG03849", "HG03857", "HG03861", "HG03863", "HG03868", "HG03874", "HG03882", "HG03886", "HG03888", "HG03897", "HG03907", "HG03910", "HG03913", "HG03916", "HG03919", "HG03922", "HG03925", "HG03928", "HG03931", "HG03934", "HG03937", "HG03940", "HG03945", "HG03947", "HG03949", "HG03951", "HG03968", "HG03973", "HG03977", "HG03986", "HG03989", "HG04001", "HG04014", "HG04018", "HG04025", "HG04026", "HG04042", "HG04047", "HG04059", "HG04062", "HG04063", "HG04075", "HG04076", "HG04090", "HG04099", "HG04118", "HG04141", "HG04144", "HG04153", "HG04156", "HG04159", "HG04171", "HG04177", "HG04180", "HG04183", "HG04186", "HG04189", "HG04195", "HG04200", "HG04202", "HG04212", "HG04214", "HG04216", "HG04227", "NA20847", "NA20849", "NA20851", "NA20853", "NA20854", "NA20856", "NA20859", "NA20862", "NA20868", "NA20869", "NA20872", "NA20874", "NA20875", "NA20876", "NA20877", "NA20878", "NA20881", "NA20882", "NA20888", "NA20892", "NA20894", "NA20896", "NA20899", "NA20902", "NA20906", "NA20908", "NA20910", "NA21086", "NA21088", "NA21089", "NA21097", "NA21101", "NA21102", "NA21103", "NA21106", "NA21108", "NA21110", "NA21120", "NA21122", "NA21125", "NA21137", "NA21141", "NA21143", "NA21144")
Clusters_7 <- set.populations(Clusters_7, list(AFR,AMR,EAS,EUR,SAS), diploid = TRUE)
Clusters_7 <- set.outgroup(Clusters_7, c("Chimp"), diploid=TRUE)

#F_ST
Clusters_7 <- F_ST.stats(Clusters_7, mode="nucleotide")
Clusters_7@nuc.F_ST.vs.all [[1]]
Clusters_7@nuc.F_ST.vs.all [[2]]
Clusters_7@nuc.F_ST.vs.all [[3]]
Clusters_7@nuc.F_ST.vs.all [[4]]
Clusters_7@nuc.F_ST.vs.all [[5]]

#Cluster_8
Clusters_8 <- readVCF("new_chr7.vcf.gz", numcols=10000, tid="7", from=66362919, to=66374773, include.unknown = TRUE)
Clusters_8 <- set.outgroup(Clusters_8, c("Chimp"), diploid=TRUE)
get.sum.data(Clusters_8) 

#Divergence
bial <- get.biallelic.matrix(Clusters_8,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites8 <- sum (div & !polym,na.rm=T)
divsites8
D <- divsites8/8414
D

#Mutation rate
Clusters_8 <- neutrality.stats(Clusters_8)
Mu <- (Clusters_8@theta_Watterson/8414)/40000
Mu

#Pi_Cluster8
individuals <- get.individuals(Clusters_8)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 

bial <- get.biallelic.matrix(Clusters_8,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters_8@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 66362919:66374773))) # N polyallelic sites in that region
m <- 8414-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

AFR <- c("HG01880", "HG01883", "HG01886", "HG01889", "HG01894", "HG01896", "HG01956", "HG01958", "HG01985", "HG01989", "HG02010", "HG02012", "HG02052", "HG02054", "HG02095", "HG02108", "HG02111", "HG02144", "HG02256", "HG02282", "HG02308", "HG02309", "HG02315", "HG02318", "HG02322", "HG02325", "HG02337", "HG02339", "HG02419", "HG02427", "HG02450", "HG02462", "HG02465", "HG02476", "HG02477", "HG02479", "HG02485", "HG02497", "HG02502", "HG02505", "HG02508", "HG02511", "HG02537", "HG02546", "HG02549", "HG02555", "HG02558", "HG02562", "HG02568", "HG02571", "HG02574", "HG02577", "HG02580", "HG02583", "HG02586", "HG02589", "HG02595", "HG02611", "HG02614", "HG02621", "HG02629", "HG02635", "HG02646", "HG02667", "HG02676", "HG02679", "HG02703", "HG02716", "HG02722", "HG02757", "HG02760", "HG02763", "HG02769", "HG02772", "HG02799", "HG02808", "HG02811", "HG02814", "HG02817", "HG02820", "HG02837", "HG02840", "HG02855", "HG02861", "HG02870", "HG02879", "HG02882", "HG02885", "HG02888", "HG02891", "HG02922", "HG02943", "HG02946", "HG02952", "HG02970", "HG02974", "HG02976", "HG02979", "HG02983", "HG03025", "HG03028", "HG03040", "HG03049", "HG03052", "HG03055", "HG03058", "HG03061", "HG03064", "HG03073", "HG03079", "HG03082", "HG03086", "HG03088", "HG03091", "HG03095", "HG03099", "HG03105", "HG03108", "HG03111", "HG03117", "HG03123", "HG03126", "HG03129", "HG03132", "HG03135", "HG03159", "HG03162", "HG03168", "HG03189", "HG03195", "HG03198", "HG03212", "HG03267", "HG03270", "HG03279", "HG03291", "HG03294", "HG03297", "HG03303", "HG03342", "HG03351", "HG03363", "HG03366", "HG03369", "HG03372", "HG03378", "HG03401", "HG03410", "HG03419", "HG03437", "HG03446", "HG03449", "HG03452", "HG03455", "HG03461", "HG03470", "HG03473", "HG03476", "HG03479", "HG03485", "HG03499", "HG03511", "HG03514", "HG03517", "HG03520", "HG03539", "HG03548", "HG03558", "HG03563", "HG03567", "HG03572", "HG03575", "HG03578", "HG03583", "NA18488", "NA18489", "NA18499", "NA18502", "NA18505", "NA18508", "NA18511", "NA18517", "NA18520", "NA18523", "NA18858", "NA18861", "NA18864", "NA18867", "NA18870", "NA18873", "NA18876", "NA18878", "NA18881", "NA18907", "NA18909", "NA18912", "NA18916", "NA18924", "NA18933", "NA19017", "NA19019", "NA19023", "NA19024", "NA19030", "NA19036", "NA19037", "NA19038", "NA19093", "NA19095", "NA19099", "NA19102", "NA19108", "NA19114", "NA19116", "NA19118", "NA19129", "NA19131", "NA19137", "NA19143", "NA19147", "NA19149", "NA19152", "NA19159", "NA19172", "NA19185", "NA19190", "NA19197", "NA19201", "NA19204", "NA19206", "NA19209", "NA19214", "NA19222", "NA19225", "NA19235", "NA19238", "NA19247", "NA19310", "NA19314", "NA19315", "NA19321", "NA19323", "NA19324", "NA19327", "NA19328", "NA19332", "NA19338", "NA19351", "NA19355", "NA19377", "NA19378", "NA19390", "NA19391", "NA19399", "NA19401", "NA19403", "NA19404", "NA19431", "NA19435", "NA19436", "NA19437", "NA19438", "NA19439", "NA19440", "NA19445", "NA19446", "NA19449", "NA19456", "NA19457", "NA19462", "NA19463", "NA19467", "NA19468", "NA19472", "NA19473", "NA19474", "NA19475", "NA19701", "NA19707", "NA19712", "NA19819", "NA19835", "NA19901", "NA19909", "NA19914", "NA19917", "NA19921", "NA19923", "NA20127", "NA20274", "NA20276", "NA20282", "NA20287", "NA20289", "NA20294", "NA20317", "NA20321", "NA20332", "NA20334", "NA20339", "NA20357", "NA20359", "NA20412")
AMR <- c("HG00551", "HG00554", "HG00638", "HG00641", "HG00732", "HG00734", "HG00737", "HG00740", "HG00743", "HG01049", "HG01052", "HG01055", "HG01058", "HG01064", "HG01067", "HG01070", "HG01073", "HG01077", "HG01080", "HG01086", "HG01089", "HG01092", "HG01095", "HG01098", "HG01102", "HG01105", "HG01108", "HG01111", "HG01113", "HG01119", "HG01122", "HG01125", "HG01131", "HG01137", "HG01140", "HG01149", "HG01162", "HG01168", "HG01171", "HG01174", "HG01177", "HG01183", "HG01188", "HG01191", "HG01205", "HG01242", "HG01248", "HG01251", "HG01254", "HG01257", "HG01269", "HG01272", "HG01281", "HG01284", "HG01303", "HG01312", "HG01323", "HG01326", "HG01342", "HG01345", "HG01351", "HG01357", "HG01360", "HG01363", "HG01366", "HG01369", "HG01372", "HG01375", "HG01378", "HG01384", "HG01390", "HG01393", "HG01396", "HG01403", "HG01414", "HG01432", "HG01435", "HG01441", "HG01444", "HG01447", "HG01456", "HG01459", "HG01462", "HG01474", "HG01486", "HG01489", "HG01492", "HG01495", "HG01551", "HG01566", "HG01572", "HG01578", "HG01893", "HG01918", "HG01921", "HG01924", "HG01927", "HG01933", "HG01936", "HG01939", "HG01942", "HG01945", "HG01948", "HG01954", "HG01965", "HG01968", "HG01971", "HG01973", "HG01976", "HG01980", "HG01992", "HG01997", "HG02003", "HG02006", "HG02089", "HG02102", "HG02105", "HG02147", "HG02252", "HG02260", "HG02266", "HG02272", "HG02275", "HG02278", "HG02286", "HG02292", "HG02298", "HG02301", "HG02312", "HG02345", "HG02348", "HG02425", "NA19651", "NA19654", "NA19663", "NA19669", "NA19678", "NA19681", "NA19684", "NA19716", "NA19719", "NA19722", "NA19725", "NA19728", "NA19731", "NA19734", "NA19740", "NA19746", "NA19749", "NA19752", "NA19755", "NA19758", "NA19761", "NA19764", "NA19770", "NA19773", "NA19776", "NA19779", "NA19782", "NA19785", "NA19788", "NA19794")
EAS <- c("HG00404", "HG00407", "HG00410", "HG00419", "HG00422", "HG00428", "HG00437", "HG00443", "HG00446", "HG00449", "HG00452", "HG00458", "HG00464", "HG00473", "HG00476", "HG00479", "HG00513", "HG00525", "HG00531", "HG00534", "HG00537", "HG00543", "HG00557", "HG00560", "HG00566", "HG00584", "HG00590", "HG00593", "HG00596", "HG00599", "HG00608", "HG00611", "HG00614", "HG00620", "HG00623", "HG00626", "HG00629", "HG00632", "HG00651", "HG00654", "HG00657", "HG00663", "HG00672", "HG00675", "HG00684", "HG00690", "HG00693", "HG00699", "HG00705", "HG00717", "HG00729", "HG00759", "HG00851", "HG00864", "HG00867", "HG00879", "HG00956", "HG00978", "HG01029", "HG01046", "HG01595", "HG01597", "HG01598", "HG01599", "HG01600", "HG01794", "HG01796", "HG01797", "HG01798", "HG01799", "HG01800", "HG01801", "HG01802", "HG01804", "HG01805", "HG01806", "HG01807", "HG01808", "HG01809", "HG01812", "HG01813", "HG01815", "HG01817", "HG01841", "HG01843", "HG01845", "HG01847", "HG01848", "HG01850", "HG01851", "HG01853", "HG01855", "HG01857", "HG01858", "HG01859", "HG01862", "HG01863", "HG01868", "HG01869", "HG01870", "HG01871", "HG01874", "HG01878", "HG02016", "HG02019", "HG02025", "HG02028", "HG02031", "HG02048", "HG02049", "HG02057", "HG02069", "HG02072", "HG02075", "HG02078", "HG02081", "HG02084", "HG02086", "HG02087", "HG02113", "HG02121", "HG02127", "HG02130", "HG02133", "HG02136", "HG02139", "HG02140", "HG02142", "HG02151", "HG02152", "HG02153", "HG02154", "HG02155", "HG02156", "HG02164", "HG02165", "HG02178", "HG02179", "HG02180", "HG02181", "HG02182", "HG02184", "HG02185", "HG02186", "HG02187", "HG02190", "HG02513", "HG02522", "NA18525", "NA18526", "NA18528", "NA18531", "NA18532", "NA18533", "NA18535", "NA18537", "NA18538", "NA18539", "NA18541", "NA18542", "NA18545", "NA18547", "NA18550", "NA18552", "NA18553", "NA18555", "NA18560", "NA18564", "NA18565", "NA18566", "NA18567", "NA18570", "NA18571", "NA18573", "NA18574", "NA18577", "NA18579", "NA18582", "NA18591", "NA18592", "NA18593", "NA18595", "NA18596", "NA18597", "NA18599", "NA18602", "NA18610", "NA18614", "NA18615", "NA18616", "NA18617", "NA18618", "NA18619", "NA18625", "NA18626", "NA18627", "NA18628", "NA18630", "NA18631", "NA18634", "NA18640", "NA18641", "NA18642", "NA18644", "NA18646", "NA18939", "NA18941", "NA18942", "NA18946", "NA18947", "NA18949", "NA18950", "NA18951", "NA18954", "NA18956", "NA18957", "NA18963", "NA18964", "NA18968", "NA18969", "NA18972", "NA18973", "NA18975", "NA18976", "NA18978", "NA18979", "NA18980", "NA18981", "NA18991", "NA18993", "NA18997", "NA18998", "NA18999", "NA19001", "NA19002", "NA19003", "NA19010", "NA19011", "NA19054", "NA19057", "NA19059", "NA19064", "NA19065", "NA19074", "NA19077", "NA19078", "NA19080", "NA19081", "NA19084", "NA19087", "NA19090")
EUR <- c("HG00097", "HG00099", "HG00102", "HG00110", "HG00111", "HG00118", "HG00120", "HG00121", "HG00122", "HG00125", "HG00127", "HG00128", "HG00130", "HG00132", "HG00133", "HG00137", "HG00146", "HG00150", "HG00154", "HG00158", "HG00171", "HG00173", "HG00174", "HG00176", "HG00177", "HG00178", "HG00179", "HG00180", "HG00231", "HG00232", "HG00233", "HG00235", "HG00236", "HG00237", "HG00238", "HG00239", "HG00245", "HG00250", "HG00253", "HG00254", "HG00255", "HG00257", "HG00258", "HG00259", "HG00261", "HG00262", "HG00263", "HG00266", "HG00268", "HG00269", "HG00272", "HG00274", "HG00275", "HG00276", "HG00281", "HG00282", "HG00285", "HG00288", "HG00304", "HG00306", "HG00309", "HG00313", "HG00315", "HG00318", "HG00319", "HG00320", "HG00323", "HG00324", "HG00326", "HG00327", "HG00328", "HG00330", "HG00331", "HG00332", "HG00334", "HG00337", "HG00339", "HG00343", "HG00344", "HG00346", "HG00349", "HG00350", "HG00353", "HG00355", "HG00356", "HG00357", "HG00361", "HG00362", "HG00364", "HG00365", "HG00367", "HG00368", "HG00373", "HG00376", "HG00378", "HG00379", "HG00380", "HG00381", "HG00383", "HG00384", "HG01501", "HG01504", "HG01507", "HG01510", "HG01513", "HG01516", "HG01519", "HG01522", "HG01525", "HG01528", "HG01531", "HG01537", "HG01602", "HG01605", "HG01607", "HG01612", "HG01613", "HG01618", "HG01620", "HG01623", "HG01626", "HG01628", "HG01632", "HG01668", "HG01670", "HG01673", "HG01676", "HG01679", "HG01684", "HG01685", "HG01695", "HG01697", "HG01702", "HG01704", "HG01707", "HG01710", "HG01746", "HG01757", "HG01762", "HG01766", "HG01768", "HG01770", "HG01773", "HG01776", "HG01779", "HG01784", "HG01786", "HG01790", "HG02215", "HG02220", "HG02223", "HG02230", "HG02232", "HG02235", "HG02239", "NA06985", "NA06989", "NA07000", "NA07037", "NA07056", "NA10847", "NA11830", "NA11832", "NA11840", "NA11892", "NA11894", "NA11918", "NA11920", "NA11933", "NA11995", "NA12004", "NA12006", "NA12044", "NA12046", "NA12058", "NA12156", "NA12234", "NA12249", "NA12273", "NA12275", "NA12283", "NA12287", "NA12341", "NA12348", "NA12400", "NA12414", "NA12489", "NA12717", "NA12718", "NA12749", "NA12751", "NA12761", "NA12763", "NA12776", "NA12778", "NA12813", "NA12815", "NA12828", "NA12830", "NA12843", "NA12873", "NA12878", "NA12890", "NA20502", "NA20503", "NA20504", "NA20505", "NA20506", "NA20507", "NA20508", "NA20514", "NA20517", "NA20522", "NA20529", "NA20530", "NA20531", "NA20533", "NA20535", "NA20540", "NA20541", "NA20542", "NA20582", "NA20585", "NA20587", "NA20589", "NA20753", "NA20756", "NA20757", "NA20760", "NA20761", "NA20764", "NA20766", "NA20768", "NA20769", "NA20771", "NA20772", "NA20773", "NA20774", "NA20775", "NA20790", "NA20795", "NA20797", "NA20799", "NA20800", "NA20802", "NA20804", "NA20807", "NA20808", "NA20813", "NA20818", "NA20819", "NA20821", "NA20822", "NA20826", "NA20828", "NA20832")
SAS <- c("HG02491", "HG02494", "HG02601", "HG02652", "HG02661", "HG02688", "HG02697", "HG02725", "HG02728", "HG02731", "HG02737", "HG02775", "HG02778", "HG02784", "HG02787", "HG02790", "HG02793", "HG03007", "HG03016", "HG03235", "HG03238", "HG03488", "HG03491", "HG03589", "HG03595", "HG03598", "HG03604", "HG03607", "HG03611", "HG03616", "HG03631", "HG03634", "HG03640", "HG03642", "HG03643", "HG03645", "HG03653", "HG03668", "HG03673", "HG03684", "HG03689", "HG03692", "HG03698", "HG03703", "HG03706", "HG03709", "HG03714", "HG03717", "HG03730", "HG03731", "HG03736", "HG03757", "HG03760", "HG03762", "HG03765", "HG03770", "HG03772", "HG03774", "HG03780", "HG03781", "HG03782", "HG03787", "HG03789", "HG03793", "HG03796", "HG03802", "HG03805", "HG03808", "HG03814", "HG03817", "HG03823", "HG03826", "HG03829", "HG03832", "HG03849", "HG03857", "HG03861", "HG03863", "HG03868", "HG03874", "HG03882", "HG03886", "HG03888", "HG03897", "HG03907", "HG03910", "HG03913", "HG03916", "HG03919", "HG03922", "HG03925", "HG03928", "HG03931", "HG03934", "HG03937", "HG03940", "HG03945", "HG03947", "HG03949", "HG03951", "HG03968", "HG03973", "HG03977", "HG03986", "HG03989", "HG04001", "HG04014", "HG04018", "HG04025", "HG04026", "HG04042", "HG04047", "HG04059", "HG04062", "HG04063", "HG04075", "HG04076", "HG04090", "HG04099", "HG04118", "HG04141", "HG04144", "HG04153", "HG04156", "HG04159", "HG04171", "HG04177", "HG04180", "HG04183", "HG04186", "HG04189", "HG04195", "HG04200", "HG04202", "HG04212", "HG04214", "HG04216", "HG04227", "NA20847", "NA20849", "NA20851", "NA20853", "NA20854", "NA20856", "NA20859", "NA20862", "NA20868", "NA20869", "NA20872", "NA20874", "NA20875", "NA20876", "NA20877", "NA20878", "NA20881", "NA20882", "NA20888", "NA20892", "NA20894", "NA20896", "NA20899", "NA20902", "NA20906", "NA20908", "NA20910", "NA21086", "NA21088", "NA21089", "NA21097", "NA21101", "NA21102", "NA21103", "NA21106", "NA21108", "NA21110", "NA21120", "NA21122", "NA21125", "NA21137", "NA21141", "NA21143", "NA21144")
Clusters_8 <- set.populations(Clusters_8, list(AFR,AMR,EAS,EUR,SAS), diploid = TRUE)
Clusters_8 <- set.outgroup(Clusters_8, c("Chimp"), diploid=TRUE)

#F_ST
Clusters_8 <- F_ST.stats(Clusters_8, mode="nucleotide")
Clusters_8@nuc.F_ST.vs.all [[1]]
Clusters_8@nuc.F_ST.vs.all [[2]]
Clusters_8@nuc.F_ST.vs.all [[3]]
Clusters_8@nuc.F_ST.vs.all [[4]]
Clusters_8@nuc.F_ST.vs.all [[5]]

#Cluster_9
Clusters_9 <- readVCF("new_chr7.vcf.gz", numcols=10000, tid="7", from=74437156, to=74447091, include.unknown = TRUE)
Clusters_9 <- set.outgroup(Clusters_9, c("Chimp"), diploid=TRUE)
get.sum.data(Clusters_9) 

#Divergence
bial <- get.biallelic.matrix(Clusters_9,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites9 <- sum (div & !polym,na.rm=T)
divsites9
D <- divsites9/2423
D

#Mutation rate
Clusters_9 <- neutrality.stats(Clusters_9)
Mu <- (Clusters_9@theta_Watterson/2423)/40000
Mu

#Pi_Cluster9
individuals <- get.individuals(Clusters_9)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 

bial <- get.biallelic.matrix(Clusters_9,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters_9@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 74437156:74447091))) # N polyallelic sites in that region
m <- 2423-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

AFR <- c("HG01880", "HG01883", "HG01886", "HG01889", "HG01894", "HG01896", "HG01956", "HG01958", "HG01985", "HG01989", "HG02010", "HG02012", "HG02052", "HG02054", "HG02095", "HG02108", "HG02111", "HG02144", "HG02256", "HG02282", "HG02308", "HG02309", "HG02315", "HG02318", "HG02322", "HG02325", "HG02337", "HG02339", "HG02419", "HG02427", "HG02450", "HG02462", "HG02465", "HG02476", "HG02477", "HG02479", "HG02485", "HG02497", "HG02502", "HG02505", "HG02508", "HG02511", "HG02537", "HG02546", "HG02549", "HG02555", "HG02558", "HG02562", "HG02568", "HG02571", "HG02574", "HG02577", "HG02580", "HG02583", "HG02586", "HG02589", "HG02595", "HG02611", "HG02614", "HG02621", "HG02629", "HG02635", "HG02646", "HG02667", "HG02676", "HG02679", "HG02703", "HG02716", "HG02722", "HG02757", "HG02760", "HG02763", "HG02769", "HG02772", "HG02799", "HG02808", "HG02811", "HG02814", "HG02817", "HG02820", "HG02837", "HG02840", "HG02855", "HG02861", "HG02870", "HG02879", "HG02882", "HG02885", "HG02888", "HG02891", "HG02922", "HG02943", "HG02946", "HG02952", "HG02970", "HG02974", "HG02976", "HG02979", "HG02983", "HG03025", "HG03028", "HG03040", "HG03049", "HG03052", "HG03055", "HG03058", "HG03061", "HG03064", "HG03073", "HG03079", "HG03082", "HG03086", "HG03088", "HG03091", "HG03095", "HG03099", "HG03105", "HG03108", "HG03111", "HG03117", "HG03123", "HG03126", "HG03129", "HG03132", "HG03135", "HG03159", "HG03162", "HG03168", "HG03189", "HG03195", "HG03198", "HG03212", "HG03267", "HG03270", "HG03279", "HG03291", "HG03294", "HG03297", "HG03303", "HG03342", "HG03351", "HG03363", "HG03366", "HG03369", "HG03372", "HG03378", "HG03401", "HG03410", "HG03419", "HG03437", "HG03446", "HG03449", "HG03452", "HG03455", "HG03461", "HG03470", "HG03473", "HG03476", "HG03479", "HG03485", "HG03499", "HG03511", "HG03514", "HG03517", "HG03520", "HG03539", "HG03548", "HG03558", "HG03563", "HG03567", "HG03572", "HG03575", "HG03578", "HG03583", "NA18488", "NA18489", "NA18499", "NA18502", "NA18505", "NA18508", "NA18511", "NA18517", "NA18520", "NA18523", "NA18858", "NA18861", "NA18864", "NA18867", "NA18870", "NA18873", "NA18876", "NA18878", "NA18881", "NA18907", "NA18909", "NA18912", "NA18916", "NA18924", "NA18933", "NA19017", "NA19019", "NA19023", "NA19024", "NA19030", "NA19036", "NA19037", "NA19038", "NA19093", "NA19095", "NA19099", "NA19102", "NA19108", "NA19114", "NA19116", "NA19118", "NA19129", "NA19131", "NA19137", "NA19143", "NA19147", "NA19149", "NA19152", "NA19159", "NA19172", "NA19185", "NA19190", "NA19197", "NA19201", "NA19204", "NA19206", "NA19209", "NA19214", "NA19222", "NA19225", "NA19235", "NA19238", "NA19247", "NA19310", "NA19314", "NA19315", "NA19321", "NA19323", "NA19324", "NA19327", "NA19328", "NA19332", "NA19338", "NA19351", "NA19355", "NA19377", "NA19378", "NA19390", "NA19391", "NA19399", "NA19401", "NA19403", "NA19404", "NA19431", "NA19435", "NA19436", "NA19437", "NA19438", "NA19439", "NA19440", "NA19445", "NA19446", "NA19449", "NA19456", "NA19457", "NA19462", "NA19463", "NA19467", "NA19468", "NA19472", "NA19473", "NA19474", "NA19475", "NA19701", "NA19707", "NA19712", "NA19819", "NA19835", "NA19901", "NA19909", "NA19914", "NA19917", "NA19921", "NA19923", "NA20127", "NA20274", "NA20276", "NA20282", "NA20287", "NA20289", "NA20294", "NA20317", "NA20321", "NA20332", "NA20334", "NA20339", "NA20357", "NA20359", "NA20412")
AMR <- c("HG00551", "HG00554", "HG00638", "HG00641", "HG00732", "HG00734", "HG00737", "HG00740", "HG00743", "HG01049", "HG01052", "HG01055", "HG01058", "HG01064", "HG01067", "HG01070", "HG01073", "HG01077", "HG01080", "HG01086", "HG01089", "HG01092", "HG01095", "HG01098", "HG01102", "HG01105", "HG01108", "HG01111", "HG01113", "HG01119", "HG01122", "HG01125", "HG01131", "HG01137", "HG01140", "HG01149", "HG01162", "HG01168", "HG01171", "HG01174", "HG01177", "HG01183", "HG01188", "HG01191", "HG01205", "HG01242", "HG01248", "HG01251", "HG01254", "HG01257", "HG01269", "HG01272", "HG01281", "HG01284", "HG01303", "HG01312", "HG01323", "HG01326", "HG01342", "HG01345", "HG01351", "HG01357", "HG01360", "HG01363", "HG01366", "HG01369", "HG01372", "HG01375", "HG01378", "HG01384", "HG01390", "HG01393", "HG01396", "HG01403", "HG01414", "HG01432", "HG01435", "HG01441", "HG01444", "HG01447", "HG01456", "HG01459", "HG01462", "HG01474", "HG01486", "HG01489", "HG01492", "HG01495", "HG01551", "HG01566", "HG01572", "HG01578", "HG01893", "HG01918", "HG01921", "HG01924", "HG01927", "HG01933", "HG01936", "HG01939", "HG01942", "HG01945", "HG01948", "HG01954", "HG01965", "HG01968", "HG01971", "HG01973", "HG01976", "HG01980", "HG01992", "HG01997", "HG02003", "HG02006", "HG02089", "HG02102", "HG02105", "HG02147", "HG02252", "HG02260", "HG02266", "HG02272", "HG02275", "HG02278", "HG02286", "HG02292", "HG02298", "HG02301", "HG02312", "HG02345", "HG02348", "HG02425", "NA19651", "NA19654", "NA19663", "NA19669", "NA19678", "NA19681", "NA19684", "NA19716", "NA19719", "NA19722", "NA19725", "NA19728", "NA19731", "NA19734", "NA19740", "NA19746", "NA19749", "NA19752", "NA19755", "NA19758", "NA19761", "NA19764", "NA19770", "NA19773", "NA19776", "NA19779", "NA19782", "NA19785", "NA19788", "NA19794")
EAS <- c("HG00404", "HG00407", "HG00410", "HG00419", "HG00422", "HG00428", "HG00437", "HG00443", "HG00446", "HG00449", "HG00452", "HG00458", "HG00464", "HG00473", "HG00476", "HG00479", "HG00513", "HG00525", "HG00531", "HG00534", "HG00537", "HG00543", "HG00557", "HG00560", "HG00566", "HG00584", "HG00590", "HG00593", "HG00596", "HG00599", "HG00608", "HG00611", "HG00614", "HG00620", "HG00623", "HG00626", "HG00629", "HG00632", "HG00651", "HG00654", "HG00657", "HG00663", "HG00672", "HG00675", "HG00684", "HG00690", "HG00693", "HG00699", "HG00705", "HG00717", "HG00729", "HG00759", "HG00851", "HG00864", "HG00867", "HG00879", "HG00956", "HG00978", "HG01029", "HG01046", "HG01595", "HG01597", "HG01598", "HG01599", "HG01600", "HG01794", "HG01796", "HG01797", "HG01798", "HG01799", "HG01800", "HG01801", "HG01802", "HG01804", "HG01805", "HG01806", "HG01807", "HG01808", "HG01809", "HG01812", "HG01813", "HG01815", "HG01817", "HG01841", "HG01843", "HG01845", "HG01847", "HG01848", "HG01850", "HG01851", "HG01853", "HG01855", "HG01857", "HG01858", "HG01859", "HG01862", "HG01863", "HG01868", "HG01869", "HG01870", "HG01871", "HG01874", "HG01878", "HG02016", "HG02019", "HG02025", "HG02028", "HG02031", "HG02048", "HG02049", "HG02057", "HG02069", "HG02072", "HG02075", "HG02078", "HG02081", "HG02084", "HG02086", "HG02087", "HG02113", "HG02121", "HG02127", "HG02130", "HG02133", "HG02136", "HG02139", "HG02140", "HG02142", "HG02151", "HG02152", "HG02153", "HG02154", "HG02155", "HG02156", "HG02164", "HG02165", "HG02178", "HG02179", "HG02180", "HG02181", "HG02182", "HG02184", "HG02185", "HG02186", "HG02187", "HG02190", "HG02513", "HG02522", "NA18525", "NA18526", "NA18528", "NA18531", "NA18532", "NA18533", "NA18535", "NA18537", "NA18538", "NA18539", "NA18541", "NA18542", "NA18545", "NA18547", "NA18550", "NA18552", "NA18553", "NA18555", "NA18560", "NA18564", "NA18565", "NA18566", "NA18567", "NA18570", "NA18571", "NA18573", "NA18574", "NA18577", "NA18579", "NA18582", "NA18591", "NA18592", "NA18593", "NA18595", "NA18596", "NA18597", "NA18599", "NA18602", "NA18610", "NA18614", "NA18615", "NA18616", "NA18617", "NA18618", "NA18619", "NA18625", "NA18626", "NA18627", "NA18628", "NA18630", "NA18631", "NA18634", "NA18640", "NA18641", "NA18642", "NA18644", "NA18646", "NA18939", "NA18941", "NA18942", "NA18946", "NA18947", "NA18949", "NA18950", "NA18951", "NA18954", "NA18956", "NA18957", "NA18963", "NA18964", "NA18968", "NA18969", "NA18972", "NA18973", "NA18975", "NA18976", "NA18978", "NA18979", "NA18980", "NA18981", "NA18991", "NA18993", "NA18997", "NA18998", "NA18999", "NA19001", "NA19002", "NA19003", "NA19010", "NA19011", "NA19054", "NA19057", "NA19059", "NA19064", "NA19065", "NA19074", "NA19077", "NA19078", "NA19080", "NA19081", "NA19084", "NA19087", "NA19090")
EUR <- c("HG00097", "HG00099", "HG00102", "HG00110", "HG00111", "HG00118", "HG00120", "HG00121", "HG00122", "HG00125", "HG00127", "HG00128", "HG00130", "HG00132", "HG00133", "HG00137", "HG00146", "HG00150", "HG00154", "HG00158", "HG00171", "HG00173", "HG00174", "HG00176", "HG00177", "HG00178", "HG00179", "HG00180", "HG00231", "HG00232", "HG00233", "HG00235", "HG00236", "HG00237", "HG00238", "HG00239", "HG00245", "HG00250", "HG00253", "HG00254", "HG00255", "HG00257", "HG00258", "HG00259", "HG00261", "HG00262", "HG00263", "HG00266", "HG00268", "HG00269", "HG00272", "HG00274", "HG00275", "HG00276", "HG00281", "HG00282", "HG00285", "HG00288", "HG00304", "HG00306", "HG00309", "HG00313", "HG00315", "HG00318", "HG00319", "HG00320", "HG00323", "HG00324", "HG00326", "HG00327", "HG00328", "HG00330", "HG00331", "HG00332", "HG00334", "HG00337", "HG00339", "HG00343", "HG00344", "HG00346", "HG00349", "HG00350", "HG00353", "HG00355", "HG00356", "HG00357", "HG00361", "HG00362", "HG00364", "HG00365", "HG00367", "HG00368", "HG00373", "HG00376", "HG00378", "HG00379", "HG00380", "HG00381", "HG00383", "HG00384", "HG01501", "HG01504", "HG01507", "HG01510", "HG01513", "HG01516", "HG01519", "HG01522", "HG01525", "HG01528", "HG01531", "HG01537", "HG01602", "HG01605", "HG01607", "HG01612", "HG01613", "HG01618", "HG01620", "HG01623", "HG01626", "HG01628", "HG01632", "HG01668", "HG01670", "HG01673", "HG01676", "HG01679", "HG01684", "HG01685", "HG01695", "HG01697", "HG01702", "HG01704", "HG01707", "HG01710", "HG01746", "HG01757", "HG01762", "HG01766", "HG01768", "HG01770", "HG01773", "HG01776", "HG01779", "HG01784", "HG01786", "HG01790", "HG02215", "HG02220", "HG02223", "HG02230", "HG02232", "HG02235", "HG02239", "NA06985", "NA06989", "NA07000", "NA07037", "NA07056", "NA10847", "NA11830", "NA11832", "NA11840", "NA11892", "NA11894", "NA11918", "NA11920", "NA11933", "NA11995", "NA12004", "NA12006", "NA12044", "NA12046", "NA12058", "NA12156", "NA12234", "NA12249", "NA12273", "NA12275", "NA12283", "NA12287", "NA12341", "NA12348", "NA12400", "NA12414", "NA12489", "NA12717", "NA12718", "NA12749", "NA12751", "NA12761", "NA12763", "NA12776", "NA12778", "NA12813", "NA12815", "NA12828", "NA12830", "NA12843", "NA12873", "NA12878", "NA12890", "NA20502", "NA20503", "NA20504", "NA20505", "NA20506", "NA20507", "NA20508", "NA20514", "NA20517", "NA20522", "NA20529", "NA20530", "NA20531", "NA20533", "NA20535", "NA20540", "NA20541", "NA20542", "NA20582", "NA20585", "NA20587", "NA20589", "NA20753", "NA20756", "NA20757", "NA20760", "NA20761", "NA20764", "NA20766", "NA20768", "NA20769", "NA20771", "NA20772", "NA20773", "NA20774", "NA20775", "NA20790", "NA20795", "NA20797", "NA20799", "NA20800", "NA20802", "NA20804", "NA20807", "NA20808", "NA20813", "NA20818", "NA20819", "NA20821", "NA20822", "NA20826", "NA20828", "NA20832")
SAS <- c("HG02491", "HG02494", "HG02601", "HG02652", "HG02661", "HG02688", "HG02697", "HG02725", "HG02728", "HG02731", "HG02737", "HG02775", "HG02778", "HG02784", "HG02787", "HG02790", "HG02793", "HG03007", "HG03016", "HG03235", "HG03238", "HG03488", "HG03491", "HG03589", "HG03595", "HG03598", "HG03604", "HG03607", "HG03611", "HG03616", "HG03631", "HG03634", "HG03640", "HG03642", "HG03643", "HG03645", "HG03653", "HG03668", "HG03673", "HG03684", "HG03689", "HG03692", "HG03698", "HG03703", "HG03706", "HG03709", "HG03714", "HG03717", "HG03730", "HG03731", "HG03736", "HG03757", "HG03760", "HG03762", "HG03765", "HG03770", "HG03772", "HG03774", "HG03780", "HG03781", "HG03782", "HG03787", "HG03789", "HG03793", "HG03796", "HG03802", "HG03805", "HG03808", "HG03814", "HG03817", "HG03823", "HG03826", "HG03829", "HG03832", "HG03849", "HG03857", "HG03861", "HG03863", "HG03868", "HG03874", "HG03882", "HG03886", "HG03888", "HG03897", "HG03907", "HG03910", "HG03913", "HG03916", "HG03919", "HG03922", "HG03925", "HG03928", "HG03931", "HG03934", "HG03937", "HG03940", "HG03945", "HG03947", "HG03949", "HG03951", "HG03968", "HG03973", "HG03977", "HG03986", "HG03989", "HG04001", "HG04014", "HG04018", "HG04025", "HG04026", "HG04042", "HG04047", "HG04059", "HG04062", "HG04063", "HG04075", "HG04076", "HG04090", "HG04099", "HG04118", "HG04141", "HG04144", "HG04153", "HG04156", "HG04159", "HG04171", "HG04177", "HG04180", "HG04183", "HG04186", "HG04189", "HG04195", "HG04200", "HG04202", "HG04212", "HG04214", "HG04216", "HG04227", "NA20847", "NA20849", "NA20851", "NA20853", "NA20854", "NA20856", "NA20859", "NA20862", "NA20868", "NA20869", "NA20872", "NA20874", "NA20875", "NA20876", "NA20877", "NA20878", "NA20881", "NA20882", "NA20888", "NA20892", "NA20894", "NA20896", "NA20899", "NA20902", "NA20906", "NA20908", "NA20910", "NA21086", "NA21088", "NA21089", "NA21097", "NA21101", "NA21102", "NA21103", "NA21106", "NA21108", "NA21110", "NA21120", "NA21122", "NA21125", "NA21137", "NA21141", "NA21143", "NA21144")
Clusters_9 <- set.populations(Clusters_9, list(AFR,AMR,EAS,EUR,SAS), diploid = TRUE)
Clusters_9 <- set.outgroup(Clusters_9, c("Chimp"), diploid=TRUE)

#F_ST
Clusters_9 <- F_ST.stats(Clusters_9, mode="nucleotide")
Clusters_9@nuc.F_ST.vs.all [[1]]
Clusters_9@nuc.F_ST.vs.all [[2]]
Clusters_9@nuc.F_ST.vs.all [[3]]
Clusters_9@nuc.F_ST.vs.all [[4]]
Clusters_9@nuc.F_ST.vs.all [[5]]

#Cluster_10
Clusters_10 <- readVCF("new_chr7.vcf.gz", numcols=10000, tid="7", from=102908736, to=102923212, include.unknown = TRUE)
Clusters_10 <- set.outgroup(Clusters_10, c("Chimp"), diploid=TRUE)
get.sum.data(Clusters_10) 

#Divergence
bial <- get.biallelic.matrix(Clusters_10,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites10 <- sum (div & !polym,na.rm=T)
divsites10
D <- divsites10/2355
D

#Mutation rate
Clusters_10 <- neutrality.stats(Clusters_10)
Mu <- (Clusters_10@theta_Watterson/2355)/40000
Mu

#Pi_Cluster10
individuals <- get.individuals(Clusters_10)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 

bial <- get.biallelic.matrix(Clusters_10,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters_10@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 102908736:102923212))) # N polyallelic sites in that region
m <- 2355-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

AFR <- c("HG01880", "HG01883", "HG01886", "HG01889", "HG01894", "HG01896", "HG01956", "HG01958", "HG01985", "HG01989", "HG02010", "HG02012", "HG02052", "HG02054", "HG02095", "HG02108", "HG02111", "HG02144", "HG02256", "HG02282", "HG02308", "HG02309", "HG02315", "HG02318", "HG02322", "HG02325", "HG02337", "HG02339", "HG02419", "HG02427", "HG02450", "HG02462", "HG02465", "HG02476", "HG02477", "HG02479", "HG02485", "HG02497", "HG02502", "HG02505", "HG02508", "HG02511", "HG02537", "HG02546", "HG02549", "HG02555", "HG02558", "HG02562", "HG02568", "HG02571", "HG02574", "HG02577", "HG02580", "HG02583", "HG02586", "HG02589", "HG02595", "HG02611", "HG02614", "HG02621", "HG02629", "HG02635", "HG02646", "HG02667", "HG02676", "HG02679", "HG02703", "HG02716", "HG02722", "HG02757", "HG02760", "HG02763", "HG02769", "HG02772", "HG02799", "HG02808", "HG02811", "HG02814", "HG02817", "HG02820", "HG02837", "HG02840", "HG02855", "HG02861", "HG02870", "HG02879", "HG02882", "HG02885", "HG02888", "HG02891", "HG02922", "HG02943", "HG02946", "HG02952", "HG02970", "HG02974", "HG02976", "HG02979", "HG02983", "HG03025", "HG03028", "HG03040", "HG03049", "HG03052", "HG03055", "HG03058", "HG03061", "HG03064", "HG03073", "HG03079", "HG03082", "HG03086", "HG03088", "HG03091", "HG03095", "HG03099", "HG03105", "HG03108", "HG03111", "HG03117", "HG03123", "HG03126", "HG03129", "HG03132", "HG03135", "HG03159", "HG03162", "HG03168", "HG03189", "HG03195", "HG03198", "HG03212", "HG03267", "HG03270", "HG03279", "HG03291", "HG03294", "HG03297", "HG03303", "HG03342", "HG03351", "HG03363", "HG03366", "HG03369", "HG03372", "HG03378", "HG03401", "HG03410", "HG03419", "HG03437", "HG03446", "HG03449", "HG03452", "HG03455", "HG03461", "HG03470", "HG03473", "HG03476", "HG03479", "HG03485", "HG03499", "HG03511", "HG03514", "HG03517", "HG03520", "HG03539", "HG03548", "HG03558", "HG03563", "HG03567", "HG03572", "HG03575", "HG03578", "HG03583", "NA18488", "NA18489", "NA18499", "NA18502", "NA18505", "NA18508", "NA18511", "NA18517", "NA18520", "NA18523", "NA18858", "NA18861", "NA18864", "NA18867", "NA18870", "NA18873", "NA18876", "NA18878", "NA18881", "NA18907", "NA18909", "NA18912", "NA18916", "NA18924", "NA18933", "NA19017", "NA19019", "NA19023", "NA19024", "NA19030", "NA19036", "NA19037", "NA19038", "NA19093", "NA19095", "NA19099", "NA19102", "NA19108", "NA19114", "NA19116", "NA19118", "NA19129", "NA19131", "NA19137", "NA19143", "NA19147", "NA19149", "NA19152", "NA19159", "NA19172", "NA19185", "NA19190", "NA19197", "NA19201", "NA19204", "NA19206", "NA19209", "NA19214", "NA19222", "NA19225", "NA19235", "NA19238", "NA19247", "NA19310", "NA19314", "NA19315", "NA19321", "NA19323", "NA19324", "NA19327", "NA19328", "NA19332", "NA19338", "NA19351", "NA19355", "NA19377", "NA19378", "NA19390", "NA19391", "NA19399", "NA19401", "NA19403", "NA19404", "NA19431", "NA19435", "NA19436", "NA19437", "NA19438", "NA19439", "NA19440", "NA19445", "NA19446", "NA19449", "NA19456", "NA19457", "NA19462", "NA19463", "NA19467", "NA19468", "NA19472", "NA19473", "NA19474", "NA19475", "NA19701", "NA19707", "NA19712", "NA19819", "NA19835", "NA19901", "NA19909", "NA19914", "NA19917", "NA19921", "NA19923", "NA20127", "NA20274", "NA20276", "NA20282", "NA20287", "NA20289", "NA20294", "NA20317", "NA20321", "NA20332", "NA20334", "NA20339", "NA20357", "NA20359", "NA20412")
AMR <- c("HG00551", "HG00554", "HG00638", "HG00641", "HG00732", "HG00734", "HG00737", "HG00740", "HG00743", "HG01049", "HG01052", "HG01055", "HG01058", "HG01064", "HG01067", "HG01070", "HG01073", "HG01077", "HG01080", "HG01086", "HG01089", "HG01092", "HG01095", "HG01098", "HG01102", "HG01105", "HG01108", "HG01111", "HG01113", "HG01119", "HG01122", "HG01125", "HG01131", "HG01137", "HG01140", "HG01149", "HG01162", "HG01168", "HG01171", "HG01174", "HG01177", "HG01183", "HG01188", "HG01191", "HG01205", "HG01242", "HG01248", "HG01251", "HG01254", "HG01257", "HG01269", "HG01272", "HG01281", "HG01284", "HG01303", "HG01312", "HG01323", "HG01326", "HG01342", "HG01345", "HG01351", "HG01357", "HG01360", "HG01363", "HG01366", "HG01369", "HG01372", "HG01375", "HG01378", "HG01384", "HG01390", "HG01393", "HG01396", "HG01403", "HG01414", "HG01432", "HG01435", "HG01441", "HG01444", "HG01447", "HG01456", "HG01459", "HG01462", "HG01474", "HG01486", "HG01489", "HG01492", "HG01495", "HG01551", "HG01566", "HG01572", "HG01578", "HG01893", "HG01918", "HG01921", "HG01924", "HG01927", "HG01933", "HG01936", "HG01939", "HG01942", "HG01945", "HG01948", "HG01954", "HG01965", "HG01968", "HG01971", "HG01973", "HG01976", "HG01980", "HG01992", "HG01997", "HG02003", "HG02006", "HG02089", "HG02102", "HG02105", "HG02147", "HG02252", "HG02260", "HG02266", "HG02272", "HG02275", "HG02278", "HG02286", "HG02292", "HG02298", "HG02301", "HG02312", "HG02345", "HG02348", "HG02425", "NA19651", "NA19654", "NA19663", "NA19669", "NA19678", "NA19681", "NA19684", "NA19716", "NA19719", "NA19722", "NA19725", "NA19728", "NA19731", "NA19734", "NA19740", "NA19746", "NA19749", "NA19752", "NA19755", "NA19758", "NA19761", "NA19764", "NA19770", "NA19773", "NA19776", "NA19779", "NA19782", "NA19785", "NA19788", "NA19794")
EAS <- c("HG00404", "HG00407", "HG00410", "HG00419", "HG00422", "HG00428", "HG00437", "HG00443", "HG00446", "HG00449", "HG00452", "HG00458", "HG00464", "HG00473", "HG00476", "HG00479", "HG00513", "HG00525", "HG00531", "HG00534", "HG00537", "HG00543", "HG00557", "HG00560", "HG00566", "HG00584", "HG00590", "HG00593", "HG00596", "HG00599", "HG00608", "HG00611", "HG00614", "HG00620", "HG00623", "HG00626", "HG00629", "HG00632", "HG00651", "HG00654", "HG00657", "HG00663", "HG00672", "HG00675", "HG00684", "HG00690", "HG00693", "HG00699", "HG00705", "HG00717", "HG00729", "HG00759", "HG00851", "HG00864", "HG00867", "HG00879", "HG00956", "HG00978", "HG01029", "HG01046", "HG01595", "HG01597", "HG01598", "HG01599", "HG01600", "HG01794", "HG01796", "HG01797", "HG01798", "HG01799", "HG01800", "HG01801", "HG01802", "HG01804", "HG01805", "HG01806", "HG01807", "HG01808", "HG01809", "HG01812", "HG01813", "HG01815", "HG01817", "HG01841", "HG01843", "HG01845", "HG01847", "HG01848", "HG01850", "HG01851", "HG01853", "HG01855", "HG01857", "HG01858", "HG01859", "HG01862", "HG01863", "HG01868", "HG01869", "HG01870", "HG01871", "HG01874", "HG01878", "HG02016", "HG02019", "HG02025", "HG02028", "HG02031", "HG02048", "HG02049", "HG02057", "HG02069", "HG02072", "HG02075", "HG02078", "HG02081", "HG02084", "HG02086", "HG02087", "HG02113", "HG02121", "HG02127", "HG02130", "HG02133", "HG02136", "HG02139", "HG02140", "HG02142", "HG02151", "HG02152", "HG02153", "HG02154", "HG02155", "HG02156", "HG02164", "HG02165", "HG02178", "HG02179", "HG02180", "HG02181", "HG02182", "HG02184", "HG02185", "HG02186", "HG02187", "HG02190", "HG02513", "HG02522", "NA18525", "NA18526", "NA18528", "NA18531", "NA18532", "NA18533", "NA18535", "NA18537", "NA18538", "NA18539", "NA18541", "NA18542", "NA18545", "NA18547", "NA18550", "NA18552", "NA18553", "NA18555", "NA18560", "NA18564", "NA18565", "NA18566", "NA18567", "NA18570", "NA18571", "NA18573", "NA18574", "NA18577", "NA18579", "NA18582", "NA18591", "NA18592", "NA18593", "NA18595", "NA18596", "NA18597", "NA18599", "NA18602", "NA18610", "NA18614", "NA18615", "NA18616", "NA18617", "NA18618", "NA18619", "NA18625", "NA18626", "NA18627", "NA18628", "NA18630", "NA18631", "NA18634", "NA18640", "NA18641", "NA18642", "NA18644", "NA18646", "NA18939", "NA18941", "NA18942", "NA18946", "NA18947", "NA18949", "NA18950", "NA18951", "NA18954", "NA18956", "NA18957", "NA18963", "NA18964", "NA18968", "NA18969", "NA18972", "NA18973", "NA18975", "NA18976", "NA18978", "NA18979", "NA18980", "NA18981", "NA18991", "NA18993", "NA18997", "NA18998", "NA18999", "NA19001", "NA19002", "NA19003", "NA19010", "NA19011", "NA19054", "NA19057", "NA19059", "NA19064", "NA19065", "NA19074", "NA19077", "NA19078", "NA19080", "NA19081", "NA19084", "NA19087", "NA19090")
EUR <- c("HG00097", "HG00099", "HG00102", "HG00110", "HG00111", "HG00118", "HG00120", "HG00121", "HG00122", "HG00125", "HG00127", "HG00128", "HG00130", "HG00132", "HG00133", "HG00137", "HG00146", "HG00150", "HG00154", "HG00158", "HG00171", "HG00173", "HG00174", "HG00176", "HG00177", "HG00178", "HG00179", "HG00180", "HG00231", "HG00232", "HG00233", "HG00235", "HG00236", "HG00237", "HG00238", "HG00239", "HG00245", "HG00250", "HG00253", "HG00254", "HG00255", "HG00257", "HG00258", "HG00259", "HG00261", "HG00262", "HG00263", "HG00266", "HG00268", "HG00269", "HG00272", "HG00274", "HG00275", "HG00276", "HG00281", "HG00282", "HG00285", "HG00288", "HG00304", "HG00306", "HG00309", "HG00313", "HG00315", "HG00318", "HG00319", "HG00320", "HG00323", "HG00324", "HG00326", "HG00327", "HG00328", "HG00330", "HG00331", "HG00332", "HG00334", "HG00337", "HG00339", "HG00343", "HG00344", "HG00346", "HG00349", "HG00350", "HG00353", "HG00355", "HG00356", "HG00357", "HG00361", "HG00362", "HG00364", "HG00365", "HG00367", "HG00368", "HG00373", "HG00376", "HG00378", "HG00379", "HG00380", "HG00381", "HG00383", "HG00384", "HG01501", "HG01504", "HG01507", "HG01510", "HG01513", "HG01516", "HG01519", "HG01522", "HG01525", "HG01528", "HG01531", "HG01537", "HG01602", "HG01605", "HG01607", "HG01612", "HG01613", "HG01618", "HG01620", "HG01623", "HG01626", "HG01628", "HG01632", "HG01668", "HG01670", "HG01673", "HG01676", "HG01679", "HG01684", "HG01685", "HG01695", "HG01697", "HG01702", "HG01704", "HG01707", "HG01710", "HG01746", "HG01757", "HG01762", "HG01766", "HG01768", "HG01770", "HG01773", "HG01776", "HG01779", "HG01784", "HG01786", "HG01790", "HG02215", "HG02220", "HG02223", "HG02230", "HG02232", "HG02235", "HG02239", "NA06985", "NA06989", "NA07000", "NA07037", "NA07056", "NA10847", "NA11830", "NA11832", "NA11840", "NA11892", "NA11894", "NA11918", "NA11920", "NA11933", "NA11995", "NA12004", "NA12006", "NA12044", "NA12046", "NA12058", "NA12156", "NA12234", "NA12249", "NA12273", "NA12275", "NA12283", "NA12287", "NA12341", "NA12348", "NA12400", "NA12414", "NA12489", "NA12717", "NA12718", "NA12749", "NA12751", "NA12761", "NA12763", "NA12776", "NA12778", "NA12813", "NA12815", "NA12828", "NA12830", "NA12843", "NA12873", "NA12878", "NA12890", "NA20502", "NA20503", "NA20504", "NA20505", "NA20506", "NA20507", "NA20508", "NA20514", "NA20517", "NA20522", "NA20529", "NA20530", "NA20531", "NA20533", "NA20535", "NA20540", "NA20541", "NA20542", "NA20582", "NA20585", "NA20587", "NA20589", "NA20753", "NA20756", "NA20757", "NA20760", "NA20761", "NA20764", "NA20766", "NA20768", "NA20769", "NA20771", "NA20772", "NA20773", "NA20774", "NA20775", "NA20790", "NA20795", "NA20797", "NA20799", "NA20800", "NA20802", "NA20804", "NA20807", "NA20808", "NA20813", "NA20818", "NA20819", "NA20821", "NA20822", "NA20826", "NA20828", "NA20832")
SAS <- c("HG02491", "HG02494", "HG02601", "HG02652", "HG02661", "HG02688", "HG02697", "HG02725", "HG02728", "HG02731", "HG02737", "HG02775", "HG02778", "HG02784", "HG02787", "HG02790", "HG02793", "HG03007", "HG03016", "HG03235", "HG03238", "HG03488", "HG03491", "HG03589", "HG03595", "HG03598", "HG03604", "HG03607", "HG03611", "HG03616", "HG03631", "HG03634", "HG03640", "HG03642", "HG03643", "HG03645", "HG03653", "HG03668", "HG03673", "HG03684", "HG03689", "HG03692", "HG03698", "HG03703", "HG03706", "HG03709", "HG03714", "HG03717", "HG03730", "HG03731", "HG03736", "HG03757", "HG03760", "HG03762", "HG03765", "HG03770", "HG03772", "HG03774", "HG03780", "HG03781", "HG03782", "HG03787", "HG03789", "HG03793", "HG03796", "HG03802", "HG03805", "HG03808", "HG03814", "HG03817", "HG03823", "HG03826", "HG03829", "HG03832", "HG03849", "HG03857", "HG03861", "HG03863", "HG03868", "HG03874", "HG03882", "HG03886", "HG03888", "HG03897", "HG03907", "HG03910", "HG03913", "HG03916", "HG03919", "HG03922", "HG03925", "HG03928", "HG03931", "HG03934", "HG03937", "HG03940", "HG03945", "HG03947", "HG03949", "HG03951", "HG03968", "HG03973", "HG03977", "HG03986", "HG03989", "HG04001", "HG04014", "HG04018", "HG04025", "HG04026", "HG04042", "HG04047", "HG04059", "HG04062", "HG04063", "HG04075", "HG04076", "HG04090", "HG04099", "HG04118", "HG04141", "HG04144", "HG04153", "HG04156", "HG04159", "HG04171", "HG04177", "HG04180", "HG04183", "HG04186", "HG04189", "HG04195", "HG04200", "HG04202", "HG04212", "HG04214", "HG04216", "HG04227", "NA20847", "NA20849", "NA20851", "NA20853", "NA20854", "NA20856", "NA20859", "NA20862", "NA20868", "NA20869", "NA20872", "NA20874", "NA20875", "NA20876", "NA20877", "NA20878", "NA20881", "NA20882", "NA20888", "NA20892", "NA20894", "NA20896", "NA20899", "NA20902", "NA20906", "NA20908", "NA20910", "NA21086", "NA21088", "NA21089", "NA21097", "NA21101", "NA21102", "NA21103", "NA21106", "NA21108", "NA21110", "NA21120", "NA21122", "NA21125", "NA21137", "NA21141", "NA21143", "NA21144")
Clusters_10 <- set.populations(Clusters_10, list(AFR,AMR,EAS,EUR,SAS), diploid = TRUE)
Clusters_10 <- set.outgroup(Clusters_10, c("Chimp"), diploid=TRUE)

#F_ST
Clusters_10 <- F_ST.stats(Clusters_10, mode="nucleotide")
Clusters_10@nuc.F_ST.vs.all [[1]]
Clusters_10@nuc.F_ST.vs.all [[2]]
Clusters_10@nuc.F_ST.vs.all [[3]]
Clusters_10@nuc.F_ST.vs.all [[4]]
Clusters_10@nuc.F_ST.vs.all [[5]]

#Cluster_11
Clusters_11 <- readVCF("new_chr7.vcf.gz", numcols=10000, tid="7", from=117852321, to=117869066, include.unknown = TRUE)
Clusters_11 <- set.outgroup(Clusters_11, c("Chimp"), diploid=TRUE)
get.sum.data(Clusters_11) 

#Divergence
bial <- get.biallelic.matrix(Clusters_11,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites11 <- sum (div & !polym,na.rm=T)
divsites11
D <- divsites11/2402
D

#Mutation rate
Clusters_11 <- neutrality.stats(Clusters_11)
Mu <- (Clusters_11@theta_Watterson/2402)/40000
Mu

#Pi_Cluster4
individuals <- get.individuals(Clusters_11)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 

bial <- get.biallelic.matrix(Clusters_11,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters_11@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 117852321:117869066))) # N polyallelic sites in that region
m <- 2402-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

AFR <- c("HG01880", "HG01883", "HG01886", "HG01889", "HG01894", "HG01896", "HG01956", "HG01958", "HG01985", "HG01989", "HG02010", "HG02012", "HG02052", "HG02054", "HG02095", "HG02108", "HG02111", "HG02144", "HG02256", "HG02282", "HG02308", "HG02309", "HG02315", "HG02318", "HG02322", "HG02325", "HG02337", "HG02339", "HG02419", "HG02427", "HG02450", "HG02462", "HG02465", "HG02476", "HG02477", "HG02479", "HG02485", "HG02497", "HG02502", "HG02505", "HG02508", "HG02511", "HG02537", "HG02546", "HG02549", "HG02555", "HG02558", "HG02562", "HG02568", "HG02571", "HG02574", "HG02577", "HG02580", "HG02583", "HG02586", "HG02589", "HG02595", "HG02611", "HG02614", "HG02621", "HG02629", "HG02635", "HG02646", "HG02667", "HG02676", "HG02679", "HG02703", "HG02716", "HG02722", "HG02757", "HG02760", "HG02763", "HG02769", "HG02772", "HG02799", "HG02808", "HG02811", "HG02814", "HG02817", "HG02820", "HG02837", "HG02840", "HG02855", "HG02861", "HG02870", "HG02879", "HG02882", "HG02885", "HG02888", "HG02891", "HG02922", "HG02943", "HG02946", "HG02952", "HG02970", "HG02974", "HG02976", "HG02979", "HG02983", "HG03025", "HG03028", "HG03040", "HG03049", "HG03052", "HG03055", "HG03058", "HG03061", "HG03064", "HG03073", "HG03079", "HG03082", "HG03086", "HG03088", "HG03091", "HG03095", "HG03099", "HG03105", "HG03108", "HG03111", "HG03117", "HG03123", "HG03126", "HG03129", "HG03132", "HG03135", "HG03159", "HG03162", "HG03168", "HG03189", "HG03195", "HG03198", "HG03212", "HG03267", "HG03270", "HG03279", "HG03291", "HG03294", "HG03297", "HG03303", "HG03342", "HG03351", "HG03363", "HG03366", "HG03369", "HG03372", "HG03378", "HG03401", "HG03410", "HG03419", "HG03437", "HG03446", "HG03449", "HG03452", "HG03455", "HG03461", "HG03470", "HG03473", "HG03476", "HG03479", "HG03485", "HG03499", "HG03511", "HG03514", "HG03517", "HG03520", "HG03539", "HG03548", "HG03558", "HG03563", "HG03567", "HG03572", "HG03575", "HG03578", "HG03583", "NA18488", "NA18489", "NA18499", "NA18502", "NA18505", "NA18508", "NA18511", "NA18517", "NA18520", "NA18523", "NA18858", "NA18861", "NA18864", "NA18867", "NA18870", "NA18873", "NA18876", "NA18878", "NA18881", "NA18907", "NA18909", "NA18912", "NA18916", "NA18924", "NA18933", "NA19017", "NA19019", "NA19023", "NA19024", "NA19030", "NA19036", "NA19037", "NA19038", "NA19093", "NA19095", "NA19099", "NA19102", "NA19108", "NA19114", "NA19116", "NA19118", "NA19129", "NA19131", "NA19137", "NA19143", "NA19147", "NA19149", "NA19152", "NA19159", "NA19172", "NA19185", "NA19190", "NA19197", "NA19201", "NA19204", "NA19206", "NA19209", "NA19214", "NA19222", "NA19225", "NA19235", "NA19238", "NA19247", "NA19310", "NA19314", "NA19315", "NA19321", "NA19323", "NA19324", "NA19327", "NA19328", "NA19332", "NA19338", "NA19351", "NA19355", "NA19377", "NA19378", "NA19390", "NA19391", "NA19399", "NA19401", "NA19403", "NA19404", "NA19431", "NA19435", "NA19436", "NA19437", "NA19438", "NA19439", "NA19440", "NA19445", "NA19446", "NA19449", "NA19456", "NA19457", "NA19462", "NA19463", "NA19467", "NA19468", "NA19472", "NA19473", "NA19474", "NA19475", "NA19701", "NA19707", "NA19712", "NA19819", "NA19835", "NA19901", "NA19909", "NA19914", "NA19917", "NA19921", "NA19923", "NA20127", "NA20274", "NA20276", "NA20282", "NA20287", "NA20289", "NA20294", "NA20317", "NA20321", "NA20332", "NA20334", "NA20339", "NA20357", "NA20359", "NA20412")
AMR <- c("HG00551", "HG00554", "HG00638", "HG00641", "HG00732", "HG00734", "HG00737", "HG00740", "HG00743", "HG01049", "HG01052", "HG01055", "HG01058", "HG01064", "HG01067", "HG01070", "HG01073", "HG01077", "HG01080", "HG01086", "HG01089", "HG01092", "HG01095", "HG01098", "HG01102", "HG01105", "HG01108", "HG01111", "HG01113", "HG01119", "HG01122", "HG01125", "HG01131", "HG01137", "HG01140", "HG01149", "HG01162", "HG01168", "HG01171", "HG01174", "HG01177", "HG01183", "HG01188", "HG01191", "HG01205", "HG01242", "HG01248", "HG01251", "HG01254", "HG01257", "HG01269", "HG01272", "HG01281", "HG01284", "HG01303", "HG01312", "HG01323", "HG01326", "HG01342", "HG01345", "HG01351", "HG01357", "HG01360", "HG01363", "HG01366", "HG01369", "HG01372", "HG01375", "HG01378", "HG01384", "HG01390", "HG01393", "HG01396", "HG01403", "HG01414", "HG01432", "HG01435", "HG01441", "HG01444", "HG01447", "HG01456", "HG01459", "HG01462", "HG01474", "HG01486", "HG01489", "HG01492", "HG01495", "HG01551", "HG01566", "HG01572", "HG01578", "HG01893", "HG01918", "HG01921", "HG01924", "HG01927", "HG01933", "HG01936", "HG01939", "HG01942", "HG01945", "HG01948", "HG01954", "HG01965", "HG01968", "HG01971", "HG01973", "HG01976", "HG01980", "HG01992", "HG01997", "HG02003", "HG02006", "HG02089", "HG02102", "HG02105", "HG02147", "HG02252", "HG02260", "HG02266", "HG02272", "HG02275", "HG02278", "HG02286", "HG02292", "HG02298", "HG02301", "HG02312", "HG02345", "HG02348", "HG02425", "NA19651", "NA19654", "NA19663", "NA19669", "NA19678", "NA19681", "NA19684", "NA19716", "NA19719", "NA19722", "NA19725", "NA19728", "NA19731", "NA19734", "NA19740", "NA19746", "NA19749", "NA19752", "NA19755", "NA19758", "NA19761", "NA19764", "NA19770", "NA19773", "NA19776", "NA19779", "NA19782", "NA19785", "NA19788", "NA19794")
EAS <- c("HG00404", "HG00407", "HG00410", "HG00419", "HG00422", "HG00428", "HG00437", "HG00443", "HG00446", "HG00449", "HG00452", "HG00458", "HG00464", "HG00473", "HG00476", "HG00479", "HG00513", "HG00525", "HG00531", "HG00534", "HG00537", "HG00543", "HG00557", "HG00560", "HG00566", "HG00584", "HG00590", "HG00593", "HG00596", "HG00599", "HG00608", "HG00611", "HG00614", "HG00620", "HG00623", "HG00626", "HG00629", "HG00632", "HG00651", "HG00654", "HG00657", "HG00663", "HG00672", "HG00675", "HG00684", "HG00690", "HG00693", "HG00699", "HG00705", "HG00717", "HG00729", "HG00759", "HG00851", "HG00864", "HG00867", "HG00879", "HG00956", "HG00978", "HG01029", "HG01046", "HG01595", "HG01597", "HG01598", "HG01599", "HG01600", "HG01794", "HG01796", "HG01797", "HG01798", "HG01799", "HG01800", "HG01801", "HG01802", "HG01804", "HG01805", "HG01806", "HG01807", "HG01808", "HG01809", "HG01812", "HG01813", "HG01815", "HG01817", "HG01841", "HG01843", "HG01845", "HG01847", "HG01848", "HG01850", "HG01851", "HG01853", "HG01855", "HG01857", "HG01858", "HG01859", "HG01862", "HG01863", "HG01868", "HG01869", "HG01870", "HG01871", "HG01874", "HG01878", "HG02016", "HG02019", "HG02025", "HG02028", "HG02031", "HG02048", "HG02049", "HG02057", "HG02069", "HG02072", "HG02075", "HG02078", "HG02081", "HG02084", "HG02086", "HG02087", "HG02113", "HG02121", "HG02127", "HG02130", "HG02133", "HG02136", "HG02139", "HG02140", "HG02142", "HG02151", "HG02152", "HG02153", "HG02154", "HG02155", "HG02156", "HG02164", "HG02165", "HG02178", "HG02179", "HG02180", "HG02181", "HG02182", "HG02184", "HG02185", "HG02186", "HG02187", "HG02190", "HG02513", "HG02522", "NA18525", "NA18526", "NA18528", "NA18531", "NA18532", "NA18533", "NA18535", "NA18537", "NA18538", "NA18539", "NA18541", "NA18542", "NA18545", "NA18547", "NA18550", "NA18552", "NA18553", "NA18555", "NA18560", "NA18564", "NA18565", "NA18566", "NA18567", "NA18570", "NA18571", "NA18573", "NA18574", "NA18577", "NA18579", "NA18582", "NA18591", "NA18592", "NA18593", "NA18595", "NA18596", "NA18597", "NA18599", "NA18602", "NA18610", "NA18614", "NA18615", "NA18616", "NA18617", "NA18618", "NA18619", "NA18625", "NA18626", "NA18627", "NA18628", "NA18630", "NA18631", "NA18634", "NA18640", "NA18641", "NA18642", "NA18644", "NA18646", "NA18939", "NA18941", "NA18942", "NA18946", "NA18947", "NA18949", "NA18950", "NA18951", "NA18954", "NA18956", "NA18957", "NA18963", "NA18964", "NA18968", "NA18969", "NA18972", "NA18973", "NA18975", "NA18976", "NA18978", "NA18979", "NA18980", "NA18981", "NA18991", "NA18993", "NA18997", "NA18998", "NA18999", "NA19001", "NA19002", "NA19003", "NA19010", "NA19011", "NA19054", "NA19057", "NA19059", "NA19064", "NA19065", "NA19074", "NA19077", "NA19078", "NA19080", "NA19081", "NA19084", "NA19087", "NA19090")
EUR <- c("HG00097", "HG00099", "HG00102", "HG00110", "HG00111", "HG00118", "HG00120", "HG00121", "HG00122", "HG00125", "HG00127", "HG00128", "HG00130", "HG00132", "HG00133", "HG00137", "HG00146", "HG00150", "HG00154", "HG00158", "HG00171", "HG00173", "HG00174", "HG00176", "HG00177", "HG00178", "HG00179", "HG00180", "HG00231", "HG00232", "HG00233", "HG00235", "HG00236", "HG00237", "HG00238", "HG00239", "HG00245", "HG00250", "HG00253", "HG00254", "HG00255", "HG00257", "HG00258", "HG00259", "HG00261", "HG00262", "HG00263", "HG00266", "HG00268", "HG00269", "HG00272", "HG00274", "HG00275", "HG00276", "HG00281", "HG00282", "HG00285", "HG00288", "HG00304", "HG00306", "HG00309", "HG00313", "HG00315", "HG00318", "HG00319", "HG00320", "HG00323", "HG00324", "HG00326", "HG00327", "HG00328", "HG00330", "HG00331", "HG00332", "HG00334", "HG00337", "HG00339", "HG00343", "HG00344", "HG00346", "HG00349", "HG00350", "HG00353", "HG00355", "HG00356", "HG00357", "HG00361", "HG00362", "HG00364", "HG00365", "HG00367", "HG00368", "HG00373", "HG00376", "HG00378", "HG00379", "HG00380", "HG00381", "HG00383", "HG00384", "HG01501", "HG01504", "HG01507", "HG01510", "HG01513", "HG01516", "HG01519", "HG01522", "HG01525", "HG01528", "HG01531", "HG01537", "HG01602", "HG01605", "HG01607", "HG01612", "HG01613", "HG01618", "HG01620", "HG01623", "HG01626", "HG01628", "HG01632", "HG01668", "HG01670", "HG01673", "HG01676", "HG01679", "HG01684", "HG01685", "HG01695", "HG01697", "HG01702", "HG01704", "HG01707", "HG01710", "HG01746", "HG01757", "HG01762", "HG01766", "HG01768", "HG01770", "HG01773", "HG01776", "HG01779", "HG01784", "HG01786", "HG01790", "HG02215", "HG02220", "HG02223", "HG02230", "HG02232", "HG02235", "HG02239", "NA06985", "NA06989", "NA07000", "NA07037", "NA07056", "NA10847", "NA11830", "NA11832", "NA11840", "NA11892", "NA11894", "NA11918", "NA11920", "NA11933", "NA11995", "NA12004", "NA12006", "NA12044", "NA12046", "NA12058", "NA12156", "NA12234", "NA12249", "NA12273", "NA12275", "NA12283", "NA12287", "NA12341", "NA12348", "NA12400", "NA12414", "NA12489", "NA12717", "NA12718", "NA12749", "NA12751", "NA12761", "NA12763", "NA12776", "NA12778", "NA12813", "NA12815", "NA12828", "NA12830", "NA12843", "NA12873", "NA12878", "NA12890", "NA20502", "NA20503", "NA20504", "NA20505", "NA20506", "NA20507", "NA20508", "NA20514", "NA20517", "NA20522", "NA20529", "NA20530", "NA20531", "NA20533", "NA20535", "NA20540", "NA20541", "NA20542", "NA20582", "NA20585", "NA20587", "NA20589", "NA20753", "NA20756", "NA20757", "NA20760", "NA20761", "NA20764", "NA20766", "NA20768", "NA20769", "NA20771", "NA20772", "NA20773", "NA20774", "NA20775", "NA20790", "NA20795", "NA20797", "NA20799", "NA20800", "NA20802", "NA20804", "NA20807", "NA20808", "NA20813", "NA20818", "NA20819", "NA20821", "NA20822", "NA20826", "NA20828", "NA20832")
SAS <- c("HG02491", "HG02494", "HG02601", "HG02652", "HG02661", "HG02688", "HG02697", "HG02725", "HG02728", "HG02731", "HG02737", "HG02775", "HG02778", "HG02784", "HG02787", "HG02790", "HG02793", "HG03007", "HG03016", "HG03235", "HG03238", "HG03488", "HG03491", "HG03589", "HG03595", "HG03598", "HG03604", "HG03607", "HG03611", "HG03616", "HG03631", "HG03634", "HG03640", "HG03642", "HG03643", "HG03645", "HG03653", "HG03668", "HG03673", "HG03684", "HG03689", "HG03692", "HG03698", "HG03703", "HG03706", "HG03709", "HG03714", "HG03717", "HG03730", "HG03731", "HG03736", "HG03757", "HG03760", "HG03762", "HG03765", "HG03770", "HG03772", "HG03774", "HG03780", "HG03781", "HG03782", "HG03787", "HG03789", "HG03793", "HG03796", "HG03802", "HG03805", "HG03808", "HG03814", "HG03817", "HG03823", "HG03826", "HG03829", "HG03832", "HG03849", "HG03857", "HG03861", "HG03863", "HG03868", "HG03874", "HG03882", "HG03886", "HG03888", "HG03897", "HG03907", "HG03910", "HG03913", "HG03916", "HG03919", "HG03922", "HG03925", "HG03928", "HG03931", "HG03934", "HG03937", "HG03940", "HG03945", "HG03947", "HG03949", "HG03951", "HG03968", "HG03973", "HG03977", "HG03986", "HG03989", "HG04001", "HG04014", "HG04018", "HG04025", "HG04026", "HG04042", "HG04047", "HG04059", "HG04062", "HG04063", "HG04075", "HG04076", "HG04090", "HG04099", "HG04118", "HG04141", "HG04144", "HG04153", "HG04156", "HG04159", "HG04171", "HG04177", "HG04180", "HG04183", "HG04186", "HG04189", "HG04195", "HG04200", "HG04202", "HG04212", "HG04214", "HG04216", "HG04227", "NA20847", "NA20849", "NA20851", "NA20853", "NA20854", "NA20856", "NA20859", "NA20862", "NA20868", "NA20869", "NA20872", "NA20874", "NA20875", "NA20876", "NA20877", "NA20878", "NA20881", "NA20882", "NA20888", "NA20892", "NA20894", "NA20896", "NA20899", "NA20902", "NA20906", "NA20908", "NA20910", "NA21086", "NA21088", "NA21089", "NA21097", "NA21101", "NA21102", "NA21103", "NA21106", "NA21108", "NA21110", "NA21120", "NA21122", "NA21125", "NA21137", "NA21141", "NA21143", "NA21144")
Clusters_11 <- set.populations(Clusters_11, list(AFR,AMR,EAS,EUR,SAS), diploid = TRUE)
Clusters_11 <- set.outgroup(Clusters_11, c("Chimp"), diploid=TRUE)

#F_ST
Clusters_11 <- F_ST.stats(Clusters_11, mode="nucleotide")
Clusters_11@nuc.F_ST.vs.all [[1]]
Clusters_11@nuc.F_ST.vs.all [[2]]
Clusters_11@nuc.F_ST.vs.all [[3]]
Clusters_11@nuc.F_ST.vs.all [[4]]
Clusters_11@nuc.F_ST.vs.all [[5]]

#Cluster_12
Clusters_12 <- readVCF("new_chr7.vcf.gz", numcols=10000, tid="7", from=148943506, to=148956111, include.unknown = TRUE)
Clusters_12 <- set.outgroup(Clusters_12, c("Chimp"), diploid=TRUE)
get.sum.data(Clusters_12) 

#Divergence
bial <- get.biallelic.matrix(Clusters_12,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites12 <- sum (div & !polym,na.rm=T)
divsites12
D <- divsites12/3411
D

#Mutation rate
Clusters_12 <- neutrality.stats(Clusters_12)
Mu <- (Clusters_12@theta_Watterson/3411)/40000
Mu

#Pi_Cluster12
individuals <- get.individuals(Clusters_12)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 

bial <- get.biallelic.matrix(Clusters_12,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters_12@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 148943506:148956111))) # N polyallelic sites in that region
m <- 3411-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

AFR <- c("HG01880", "HG01883", "HG01886", "HG01889", "HG01894", "HG01896", "HG01956", "HG01958", "HG01985", "HG01989", "HG02010", "HG02012", "HG02052", "HG02054", "HG02095", "HG02108", "HG02111", "HG02144", "HG02256", "HG02282", "HG02308", "HG02309", "HG02315", "HG02318", "HG02322", "HG02325", "HG02337", "HG02339", "HG02419", "HG02427", "HG02450", "HG02462", "HG02465", "HG02476", "HG02477", "HG02479", "HG02485", "HG02497", "HG02502", "HG02505", "HG02508", "HG02511", "HG02537", "HG02546", "HG02549", "HG02555", "HG02558", "HG02562", "HG02568", "HG02571", "HG02574", "HG02577", "HG02580", "HG02583", "HG02586", "HG02589", "HG02595", "HG02611", "HG02614", "HG02621", "HG02629", "HG02635", "HG02646", "HG02667", "HG02676", "HG02679", "HG02703", "HG02716", "HG02722", "HG02757", "HG02760", "HG02763", "HG02769", "HG02772", "HG02799", "HG02808", "HG02811", "HG02814", "HG02817", "HG02820", "HG02837", "HG02840", "HG02855", "HG02861", "HG02870", "HG02879", "HG02882", "HG02885", "HG02888", "HG02891", "HG02922", "HG02943", "HG02946", "HG02952", "HG02970", "HG02974", "HG02976", "HG02979", "HG02983", "HG03025", "HG03028", "HG03040", "HG03049", "HG03052", "HG03055", "HG03058", "HG03061", "HG03064", "HG03073", "HG03079", "HG03082", "HG03086", "HG03088", "HG03091", "HG03095", "HG03099", "HG03105", "HG03108", "HG03111", "HG03117", "HG03123", "HG03126", "HG03129", "HG03132", "HG03135", "HG03159", "HG03162", "HG03168", "HG03189", "HG03195", "HG03198", "HG03212", "HG03267", "HG03270", "HG03279", "HG03291", "HG03294", "HG03297", "HG03303", "HG03342", "HG03351", "HG03363", "HG03366", "HG03369", "HG03372", "HG03378", "HG03401", "HG03410", "HG03419", "HG03437", "HG03446", "HG03449", "HG03452", "HG03455", "HG03461", "HG03470", "HG03473", "HG03476", "HG03479", "HG03485", "HG03499", "HG03511", "HG03514", "HG03517", "HG03520", "HG03539", "HG03548", "HG03558", "HG03563", "HG03567", "HG03572", "HG03575", "HG03578", "HG03583", "NA18488", "NA18489", "NA18499", "NA18502", "NA18505", "NA18508", "NA18511", "NA18517", "NA18520", "NA18523", "NA18858", "NA18861", "NA18864", "NA18867", "NA18870", "NA18873", "NA18876", "NA18878", "NA18881", "NA18907", "NA18909", "NA18912", "NA18916", "NA18924", "NA18933", "NA19017", "NA19019", "NA19023", "NA19024", "NA19030", "NA19036", "NA19037", "NA19038", "NA19093", "NA19095", "NA19099", "NA19102", "NA19108", "NA19114", "NA19116", "NA19118", "NA19129", "NA19131", "NA19137", "NA19143", "NA19147", "NA19149", "NA19152", "NA19159", "NA19172", "NA19185", "NA19190", "NA19197", "NA19201", "NA19204", "NA19206", "NA19209", "NA19214", "NA19222", "NA19225", "NA19235", "NA19238", "NA19247", "NA19310", "NA19314", "NA19315", "NA19321", "NA19323", "NA19324", "NA19327", "NA19328", "NA19332", "NA19338", "NA19351", "NA19355", "NA19377", "NA19378", "NA19390", "NA19391", "NA19399", "NA19401", "NA19403", "NA19404", "NA19431", "NA19435", "NA19436", "NA19437", "NA19438", "NA19439", "NA19440", "NA19445", "NA19446", "NA19449", "NA19456", "NA19457", "NA19462", "NA19463", "NA19467", "NA19468", "NA19472", "NA19473", "NA19474", "NA19475", "NA19701", "NA19707", "NA19712", "NA19819", "NA19835", "NA19901", "NA19909", "NA19914", "NA19917", "NA19921", "NA19923", "NA20127", "NA20274", "NA20276", "NA20282", "NA20287", "NA20289", "NA20294", "NA20317", "NA20321", "NA20332", "NA20334", "NA20339", "NA20357", "NA20359", "NA20412")
AMR <- c("HG00551", "HG00554", "HG00638", "HG00641", "HG00732", "HG00734", "HG00737", "HG00740", "HG00743", "HG01049", "HG01052", "HG01055", "HG01058", "HG01064", "HG01067", "HG01070", "HG01073", "HG01077", "HG01080", "HG01086", "HG01089", "HG01092", "HG01095", "HG01098", "HG01102", "HG01105", "HG01108", "HG01111", "HG01113", "HG01119", "HG01122", "HG01125", "HG01131", "HG01137", "HG01140", "HG01149", "HG01162", "HG01168", "HG01171", "HG01174", "HG01177", "HG01183", "HG01188", "HG01191", "HG01205", "HG01242", "HG01248", "HG01251", "HG01254", "HG01257", "HG01269", "HG01272", "HG01281", "HG01284", "HG01303", "HG01312", "HG01323", "HG01326", "HG01342", "HG01345", "HG01351", "HG01357", "HG01360", "HG01363", "HG01366", "HG01369", "HG01372", "HG01375", "HG01378", "HG01384", "HG01390", "HG01393", "HG01396", "HG01403", "HG01414", "HG01432", "HG01435", "HG01441", "HG01444", "HG01447", "HG01456", "HG01459", "HG01462", "HG01474", "HG01486", "HG01489", "HG01492", "HG01495", "HG01551", "HG01566", "HG01572", "HG01578", "HG01893", "HG01918", "HG01921", "HG01924", "HG01927", "HG01933", "HG01936", "HG01939", "HG01942", "HG01945", "HG01948", "HG01954", "HG01965", "HG01968", "HG01971", "HG01973", "HG01976", "HG01980", "HG01992", "HG01997", "HG02003", "HG02006", "HG02089", "HG02102", "HG02105", "HG02147", "HG02252", "HG02260", "HG02266", "HG02272", "HG02275", "HG02278", "HG02286", "HG02292", "HG02298", "HG02301", "HG02312", "HG02345", "HG02348", "HG02425", "NA19651", "NA19654", "NA19663", "NA19669", "NA19678", "NA19681", "NA19684", "NA19716", "NA19719", "NA19722", "NA19725", "NA19728", "NA19731", "NA19734", "NA19740", "NA19746", "NA19749", "NA19752", "NA19755", "NA19758", "NA19761", "NA19764", "NA19770", "NA19773", "NA19776", "NA19779", "NA19782", "NA19785", "NA19788", "NA19794")
EAS <- c("HG00404", "HG00407", "HG00410", "HG00419", "HG00422", "HG00428", "HG00437", "HG00443", "HG00446", "HG00449", "HG00452", "HG00458", "HG00464", "HG00473", "HG00476", "HG00479", "HG00513", "HG00525", "HG00531", "HG00534", "HG00537", "HG00543", "HG00557", "HG00560", "HG00566", "HG00584", "HG00590", "HG00593", "HG00596", "HG00599", "HG00608", "HG00611", "HG00614", "HG00620", "HG00623", "HG00626", "HG00629", "HG00632", "HG00651", "HG00654", "HG00657", "HG00663", "HG00672", "HG00675", "HG00684", "HG00690", "HG00693", "HG00699", "HG00705", "HG00717", "HG00729", "HG00759", "HG00851", "HG00864", "HG00867", "HG00879", "HG00956", "HG00978", "HG01029", "HG01046", "HG01595", "HG01597", "HG01598", "HG01599", "HG01600", "HG01794", "HG01796", "HG01797", "HG01798", "HG01799", "HG01800", "HG01801", "HG01802", "HG01804", "HG01805", "HG01806", "HG01807", "HG01808", "HG01809", "HG01812", "HG01813", "HG01815", "HG01817", "HG01841", "HG01843", "HG01845", "HG01847", "HG01848", "HG01850", "HG01851", "HG01853", "HG01855", "HG01857", "HG01858", "HG01859", "HG01862", "HG01863", "HG01868", "HG01869", "HG01870", "HG01871", "HG01874", "HG01878", "HG02016", "HG02019", "HG02025", "HG02028", "HG02031", "HG02048", "HG02049", "HG02057", "HG02069", "HG02072", "HG02075", "HG02078", "HG02081", "HG02084", "HG02086", "HG02087", "HG02113", "HG02121", "HG02127", "HG02130", "HG02133", "HG02136", "HG02139", "HG02140", "HG02142", "HG02151", "HG02152", "HG02153", "HG02154", "HG02155", "HG02156", "HG02164", "HG02165", "HG02178", "HG02179", "HG02180", "HG02181", "HG02182", "HG02184", "HG02185", "HG02186", "HG02187", "HG02190", "HG02513", "HG02522", "NA18525", "NA18526", "NA18528", "NA18531", "NA18532", "NA18533", "NA18535", "NA18537", "NA18538", "NA18539", "NA18541", "NA18542", "NA18545", "NA18547", "NA18550", "NA18552", "NA18553", "NA18555", "NA18560", "NA18564", "NA18565", "NA18566", "NA18567", "NA18570", "NA18571", "NA18573", "NA18574", "NA18577", "NA18579", "NA18582", "NA18591", "NA18592", "NA18593", "NA18595", "NA18596", "NA18597", "NA18599", "NA18602", "NA18610", "NA18614", "NA18615", "NA18616", "NA18617", "NA18618", "NA18619", "NA18625", "NA18626", "NA18627", "NA18628", "NA18630", "NA18631", "NA18634", "NA18640", "NA18641", "NA18642", "NA18644", "NA18646", "NA18939", "NA18941", "NA18942", "NA18946", "NA18947", "NA18949", "NA18950", "NA18951", "NA18954", "NA18956", "NA18957", "NA18963", "NA18964", "NA18968", "NA18969", "NA18972", "NA18973", "NA18975", "NA18976", "NA18978", "NA18979", "NA18980", "NA18981", "NA18991", "NA18993", "NA18997", "NA18998", "NA18999", "NA19001", "NA19002", "NA19003", "NA19010", "NA19011", "NA19054", "NA19057", "NA19059", "NA19064", "NA19065", "NA19074", "NA19077", "NA19078", "NA19080", "NA19081", "NA19084", "NA19087", "NA19090")
EUR <- c("HG00097", "HG00099", "HG00102", "HG00110", "HG00111", "HG00118", "HG00120", "HG00121", "HG00122", "HG00125", "HG00127", "HG00128", "HG00130", "HG00132", "HG00133", "HG00137", "HG00146", "HG00150", "HG00154", "HG00158", "HG00171", "HG00173", "HG00174", "HG00176", "HG00177", "HG00178", "HG00179", "HG00180", "HG00231", "HG00232", "HG00233", "HG00235", "HG00236", "HG00237", "HG00238", "HG00239", "HG00245", "HG00250", "HG00253", "HG00254", "HG00255", "HG00257", "HG00258", "HG00259", "HG00261", "HG00262", "HG00263", "HG00266", "HG00268", "HG00269", "HG00272", "HG00274", "HG00275", "HG00276", "HG00281", "HG00282", "HG00285", "HG00288", "HG00304", "HG00306", "HG00309", "HG00313", "HG00315", "HG00318", "HG00319", "HG00320", "HG00323", "HG00324", "HG00326", "HG00327", "HG00328", "HG00330", "HG00331", "HG00332", "HG00334", "HG00337", "HG00339", "HG00343", "HG00344", "HG00346", "HG00349", "HG00350", "HG00353", "HG00355", "HG00356", "HG00357", "HG00361", "HG00362", "HG00364", "HG00365", "HG00367", "HG00368", "HG00373", "HG00376", "HG00378", "HG00379", "HG00380", "HG00381", "HG00383", "HG00384", "HG01501", "HG01504", "HG01507", "HG01510", "HG01513", "HG01516", "HG01519", "HG01522", "HG01525", "HG01528", "HG01531", "HG01537", "HG01602", "HG01605", "HG01607", "HG01612", "HG01613", "HG01618", "HG01620", "HG01623", "HG01626", "HG01628", "HG01632", "HG01668", "HG01670", "HG01673", "HG01676", "HG01679", "HG01684", "HG01685", "HG01695", "HG01697", "HG01702", "HG01704", "HG01707", "HG01710", "HG01746", "HG01757", "HG01762", "HG01766", "HG01768", "HG01770", "HG01773", "HG01776", "HG01779", "HG01784", "HG01786", "HG01790", "HG02215", "HG02220", "HG02223", "HG02230", "HG02232", "HG02235", "HG02239", "NA06985", "NA06989", "NA07000", "NA07037", "NA07056", "NA10847", "NA11830", "NA11832", "NA11840", "NA11892", "NA11894", "NA11918", "NA11920", "NA11933", "NA11995", "NA12004", "NA12006", "NA12044", "NA12046", "NA12058", "NA12156", "NA12234", "NA12249", "NA12273", "NA12275", "NA12283", "NA12287", "NA12341", "NA12348", "NA12400", "NA12414", "NA12489", "NA12717", "NA12718", "NA12749", "NA12751", "NA12761", "NA12763", "NA12776", "NA12778", "NA12813", "NA12815", "NA12828", "NA12830", "NA12843", "NA12873", "NA12878", "NA12890", "NA20502", "NA20503", "NA20504", "NA20505", "NA20506", "NA20507", "NA20508", "NA20514", "NA20517", "NA20522", "NA20529", "NA20530", "NA20531", "NA20533", "NA20535", "NA20540", "NA20541", "NA20542", "NA20582", "NA20585", "NA20587", "NA20589", "NA20753", "NA20756", "NA20757", "NA20760", "NA20761", "NA20764", "NA20766", "NA20768", "NA20769", "NA20771", "NA20772", "NA20773", "NA20774", "NA20775", "NA20790", "NA20795", "NA20797", "NA20799", "NA20800", "NA20802", "NA20804", "NA20807", "NA20808", "NA20813", "NA20818", "NA20819", "NA20821", "NA20822", "NA20826", "NA20828", "NA20832")
SAS <- c("HG02491", "HG02494", "HG02601", "HG02652", "HG02661", "HG02688", "HG02697", "HG02725", "HG02728", "HG02731", "HG02737", "HG02775", "HG02778", "HG02784", "HG02787", "HG02790", "HG02793", "HG03007", "HG03016", "HG03235", "HG03238", "HG03488", "HG03491", "HG03589", "HG03595", "HG03598", "HG03604", "HG03607", "HG03611", "HG03616", "HG03631", "HG03634", "HG03640", "HG03642", "HG03643", "HG03645", "HG03653", "HG03668", "HG03673", "HG03684", "HG03689", "HG03692", "HG03698", "HG03703", "HG03706", "HG03709", "HG03714", "HG03717", "HG03730", "HG03731", "HG03736", "HG03757", "HG03760", "HG03762", "HG03765", "HG03770", "HG03772", "HG03774", "HG03780", "HG03781", "HG03782", "HG03787", "HG03789", "HG03793", "HG03796", "HG03802", "HG03805", "HG03808", "HG03814", "HG03817", "HG03823", "HG03826", "HG03829", "HG03832", "HG03849", "HG03857", "HG03861", "HG03863", "HG03868", "HG03874", "HG03882", "HG03886", "HG03888", "HG03897", "HG03907", "HG03910", "HG03913", "HG03916", "HG03919", "HG03922", "HG03925", "HG03928", "HG03931", "HG03934", "HG03937", "HG03940", "HG03945", "HG03947", "HG03949", "HG03951", "HG03968", "HG03973", "HG03977", "HG03986", "HG03989", "HG04001", "HG04014", "HG04018", "HG04025", "HG04026", "HG04042", "HG04047", "HG04059", "HG04062", "HG04063", "HG04075", "HG04076", "HG04090", "HG04099", "HG04118", "HG04141", "HG04144", "HG04153", "HG04156", "HG04159", "HG04171", "HG04177", "HG04180", "HG04183", "HG04186", "HG04189", "HG04195", "HG04200", "HG04202", "HG04212", "HG04214", "HG04216", "HG04227", "NA20847", "NA20849", "NA20851", "NA20853", "NA20854", "NA20856", "NA20859", "NA20862", "NA20868", "NA20869", "NA20872", "NA20874", "NA20875", "NA20876", "NA20877", "NA20878", "NA20881", "NA20882", "NA20888", "NA20892", "NA20894", "NA20896", "NA20899", "NA20902", "NA20906", "NA20908", "NA20910", "NA21086", "NA21088", "NA21089", "NA21097", "NA21101", "NA21102", "NA21103", "NA21106", "NA21108", "NA21110", "NA21120", "NA21122", "NA21125", "NA21137", "NA21141", "NA21143", "NA21144")
Clusters_12 <- set.populations(Clusters_12, list(AFR,AMR,EAS,EUR,SAS), diploid = TRUE)
Clusters_12 <- set.outgroup(Clusters_12, c("Chimp"), diploid=TRUE)

#F_ST
Clusters_12 <- F_ST.stats(Clusters_12, mode="nucleotide")
Clusters_12@nuc.F_ST.vs.all [[1]]
Clusters_12@nuc.F_ST.vs.all [[2]]
Clusters_12@nuc.F_ST.vs.all [[3]]
Clusters_12@nuc.F_ST.vs.all [[4]]
Clusters_12@nuc.F_ST.vs.all [[5]]

#############################STATISTICS per POPULATION########################################################

#AFR
Clusters.all_AFR <- readVCF("new_chr7_1.vcf.gz", numcols=10000, tid="7", from=6198867, to=148956111, include.unknown = TRUE)
Clusters.all_AFR <- set.outgroup(Clusters.all_AFR,c("Chimp"), diploid=TRUE)
get.sum.data(Clusters.all_AFR)

#Divergence calculation
bial <- get.biallelic.matrix(Clusters.all_AFR,1) # Biallelic matrix
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
div <- bial[n+1,] == 1
divsites_AFR <- sum (div & !polym,na.rm=T)
divsites_AFR
D=divsites_AFR/51255
D

#Neutrality statistics
Clusters.all_AFR <- neutrality.stats(Clusters.all_AFR, do.R2 = TRUE)
get.neutrality(Clusters.all_AFR, theta=TRUE) [[1]]
Mu <- (Clusters.all_AFR@theta_Watterson/51255)/40000
Mu

#Diversities
Clusters.all_AFR <- diversity.stats(Clusters.all_AFR, pi=TRUE) 
get.diversity(Clusters.all_AFR) [[1]]

#Pi
individuals <- get.individuals(Clusters.all_AFR)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 

bial <- get.biallelic.matrix(Clusters.all_AFR,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters.all_AFR@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 6198867:148956111))) # N polyallelic sites in that region
m <- 51255-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

Clusters.all_AFR.split <- splitting.data (Clusters.all_AFR, positions = list(c(6198867:6207568), c(6617659:6633659), c(27493034:27502607), c(35732666:35739378), c(56870712:56905707), c(63200389:63215405), c(64293379:64300618), c(66362919:66374773), c(74437156:74447091), c(102908736:102923212), c(117852321:117869066), c(148943506:148956111)), type=2)
Clusters.all_AFR.split <- neutrality.stats(Clusters.all_AFR.split, do.R2 = TRUE)
get.neutrality(Clusters.all_AFR.split, theta=TRUE) [[1]]
Clusters.all_AFR.split <- diversity.stats(Clusters.all_AFR.split, pi=TRUE)
get.diversity(Clusters.all_AFR.split) [[1]]

#Cluster_1
Clusters1_AFR<- readVCF("new_chr7_1.vcf.gz", numcols=10000, tid="7", from=6198867, to=6207568, include.unknown = TRUE)
Clusters1_AFR <- set.outgroup(Clusters1_AFR,c("Chimp"), diploid=TRUE)
get.sum.data(Clusters1_AFR) 

#Divergence
bial <- get.biallelic.matrix(Clusters1_AFR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites1_AFR <- sum (div & !polym,na.rm=T)
divsites1_AFR
D <- divsites1_AFR/212
D

#Mutation rate
Clusters1_AFR <- neutrality.stats(Clusters1_AFR, FAST = TRUE)
Mu <- (Clusters1_AFR@theta_Watterson/212)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters1_AFR)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters1_AFR,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters1_AFR@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 6198867:6207568))) # N polyallelic sites in that region
m <- 212-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_2
Clusters2_AFR<- readVCF("new_chr7_1.vcf.gz", numcols=10000, tid="7", from=6617659, to=6633659, include.unknown = TRUE)
Clusters2_AFR <- set.outgroup(Clusters2_AFR, c("Chimp"), diploid=TRUE)
get.sum.data(Clusters2_AFR) 

#Divergence
bial <- get.biallelic.matrix(Clusters2_AFR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites2_AFR <- sum (div & !polym,na.rm=T)
divsites2_AFR
D <- divsites2_AFR/643
D

#Mutation rate
Clusters2_AFR <- neutrality.stats(Clusters2_AFR, FAST = TRUE)
Mu <- (Clusters2_AFR@theta_Watterson/643)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters2_AFR)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters2_AFR,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters2_AFR@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 6617659:6633659))) # N polyallelic sites in that region
m <- 643-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_3
Clusters3_AFR <- readVCF("new_chr7_1.vcf.gz", numcols=10000, tid="7", from=27493034, to=27502607, include.unknown = TRUE)
Clusters3_AFR <- set.outgroup(Clusters3_AFR, c("Chimp"), diploid=TRUE)
get.sum.data(Clusters3_AFR) 

#Divergence
bial <- get.biallelic.matrix(Clusters3_AFR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites3_AFR <- sum (div & !polym,na.rm=T)
divsites3_AFR
D <- divsites3_AFR/7684
D

#Mutation rate
Clusters3_AFR <- neutrality.stats(Clusters3_AFR, FAST = TRUE)
Mu <- (Clusters3_AFR@theta_Watterson/7684)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters3_AFR)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters3_AFR,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters3_AFR@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 27493034:27502607))) # N polyallelic sites in that region
m <- 7684-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_4
Clusters4_AFR <- readVCF("new_chr7_1.vcf.gz", numcols=10000, tid="7", from=35732666, to=35739378, include.unknown = TRUE)
Clusters4_AFR <- set.outgroup(Clusters4_AFR,c("Chimp"), diploid=TRUE)
get.sum.data(Clusters4_AFR) 

#Divergence
bial <- get.biallelic.matrix(Clusters4_AFR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites4_AFR <- sum (div & !polym,na.rm=T)
divsites4_AFR
D <- divsites4_AFR/355
D

#Mutation rate
Clusters4_AFR <- neutrality.stats(Clusters4_AFR, FAST = TRUE)
Mu <- (Clusters4_AFR@theta_Watterson/355)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters4_AFR)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters4_AFR,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters4_AFR@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 35732666:35739378))) # N polyallelic sites in that region
m <- 355-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_5
Clusters5_AFR<- readVCF("new_chr7_1.vcf.gz", numcols=10000, tid="7", from=56870712, to=56905707, include.unknown = TRUE)
Clusters5_AFR <- set.outgroup(Clusters5_AFR,c("Chimp"), diploid=TRUE)
get.sum.data(Clusters5_AFR) 

#Divergence
bial <- get.biallelic.matrix(Clusters5_AFR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites5_AFR <- sum (div & !polym,na.rm=T)
divsites5_AFR
D <- divsites5_AFR/3383
D

#Mutation rate
Clusters5_AFR <- neutrality.stats(Clusters5_AFR, FAST = TRUE)
Mu <- (Clusters5_AFR@theta_Watterson/3383)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters5_AFR)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters5_AFR,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters5_AFR@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 56870712:56905707))) # N polyallelic sites in that region
m <- 3383-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_6
Clusters6_AFR<- readVCF("new_chr7_1.vcf.gz", numcols=10000, tid="7", from=63200389, to=63215405, include.unknown = TRUE)
Clusters6_AFR <- set.outgroup(Clusters6_AFR, c("Chimp"), diploid=TRUE)
get.sum.data(Clusters6_AFR) 

#Divergence
bial <- get.biallelic.matrix(Clusters6_AFR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites6_AFR <- sum (div & !polym,na.rm=T)
divsites6_AFR
D <- divsites6_AFR/15016
D

#Mutation rate
Clusters6_AFR <- neutrality.stats(Clusters6_AFR, FAST = TRUE)
Mu <- (Clusters6_AFR@theta_Watterson/15016)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters6_AFR)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters6_AFR,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters6_AFR@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 63200389:63215405))) # N polyallelic sites in that region
m <- 15016-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_7
Clusters7_AFR <- readVCF("new_chr7_1.vcf.gz", numcols=10000, tid="7", from=64293379, to=64300618, include.unknown = TRUE)
Clusters7_AFR <- set.outgroup(Clusters7_AFR,c("Chimp"), diploid=TRUE)
get.sum.data(Clusters7_AFR) 

#Divergence
bial <- get.biallelic.matrix(Clusters7_AFR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites7_AFR <- sum (div & !polym,na.rm=T)
divsites7_AFR
D <- divsites7_AFR/4957
D

#Mutation rate
Clusters7_AFR <- neutrality.stats(Clusters7_AFR, FAST = TRUE)
Mu <- (Clusters7_AFR@theta_Watterson/4957)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters7_AFR)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters7_AFR,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters7_AFR@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 64293379:64300618))) # N polyallelic sites in that region
m <- 4957-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)


#Cluster_8
Clusters8_AFR <- readVCF("new_chr7_1.vcf.gz", numcols=10000, tid="7", from=66362919, to=66374773, include.unknown = TRUE)
Clusters8_AFR <- set.outgroup(Clusters8_AFR, c("Chimp"), diploid=TRUE)
get.sum.data(Clusters8_AFR) 

#Divergence
bial <- get.biallelic.matrix(Clusters8_AFR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites8_AFR <- sum (div & !polym,na.rm=T)
divsites8_AFR
D <- divsites8_AFR/8414
D

#Mutation rate
Clusters8_AFR <- neutrality.stats(Clusters8_AFR, FAST = TRUE)
Mu <- (Clusters8_AFR@theta_Watterson/8414)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters8_AFR)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters8_AFR,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters8_AFR@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 66362919:66374773))) # N polyallelic sites in that region
m <- 8414-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_9
Clusters9_AFR <- readVCF("new_chr7_1.vcf.gz", numcols=10000, tid="7", from=74437156, to=74447091, include.unknown = TRUE)
Clusters9_AFR <- set.outgroup(Clusters9_AFR,c("Chimp"), diploid=TRUE)
get.sum.data(Clusters9_AFR) 

#Divergence
bial <- get.biallelic.matrix(Clusters9_AFR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites9_AFR <- sum (div & !polym,na.rm=T)
divsites9_AFR
D <- divsites9_AFR/2423
D

#Mutation rate
Clusters9_AFR <- neutrality.stats(Clusters9_AFR, FAST = TRUE)
Mu <- (Clusters9_AFR@theta_Watterson/2423)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters9_AFR)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters9_AFR,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters9_AFR@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 74437156:74447091))) # N polyallelic sites in that region
m <- 2423-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_10
Clusters10_AFR <- readVCF("new_chr7_1.vcf.gz", numcols=10000, tid="7", from=102908736, to=102923212, include.unknown = TRUE)
Clusters10_AFR <- set.outgroup(Clusters10_AFR, c("Chimp"), diploid=TRUE)
get.sum.data(Clusters10_AFR) 

#Divergence
bial <- get.biallelic.matrix(Clusters10_AFR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites10_AFR <- sum (div & !polym,na.rm=T)
divsites10_AFR
D <- divsites10_AFR/2355
D

#Mutation rate
Clusters10_AFR <- neutrality.stats(Clusters10_AFR, FAST = TRUE)
Mu <- (Clusters10_AFR@theta_Watterson/2355)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters10_AFR)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters10_AFR,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters10_AFR@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 102908736:102923212))) # N polyallelic sites in that region
m <- 2355-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_11
Clusters11_AFR <- readVCF("new_chr7_1.vcf.gz", numcols=10000, tid="7", from=117852321, to=117869066, include.unknown = TRUE)
Clusters11_AFR <- set.outgroup(Clusters11_AFR,c("Chimp"), diploid=TRUE)
get.sum.data(Clusters11_AFR) 

#Divergence
bial <- get.biallelic.matrix(Clusters11_AFR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites11_AFR <- sum (div & !polym,na.rm=T)
divsites11_AFR
D <- divsites11_AFR/2402
D

#Mutation rate
Clusters11_AFR <- neutrality.stats(Clusters11_AFR, FAST = TRUE)
Mu <- (Clusters11_AFR@theta_Watterson/2402)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters11_AFR)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters11_AFR,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters11_AFR@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 117852321:117869066))) # N polyallelic sites in that region
m <- 2402-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_12
Clusters12_AFR <- readVCF("new_chr7_1.vcf.gz", numcols=10000, tid="7", from=148943506, to=148956111, include.unknown = TRUE)
Clusters12_AFR <- set.outgroup(Clusters12_AFR,c("Chimp"), diploid=TRUE)
get.sum.data(Clusters12_AFR) 

#Divergence
bial <- get.biallelic.matrix(Clusters12_AFR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites12_AFR <- sum (div & !polym,na.rm=T)
divsites12_AFR
D <- divsites12_AFR/3411
D

#Mutation rate
Clusters12_AFR <- neutrality.stats(Clusters12_AFR, FAST = TRUE)
Mu <- (Clusters12_AFR@theta_Watterson/3411)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters12_AFR)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters12_AFR,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters12_AFR@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 148943506:148956111))) # N polyallelic sites in that region
m <- 3411-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#AMR
Clusters.all_AMR <- readVCF("new_chr7_2.vcf.gz", numcols=10000, tid="7", from=6198867, to=148956111, include.unknown = TRUE)
Clusters.all_AMR <- set.outgroup(Clusters.all_AMR,c("Chimp"), diploid=TRUE)
get.sum.data(Clusters.all_AMR)

#Divergence calculation
bial <- get.biallelic.matrix(Clusters.all_AMR,1) # Biallelic matrix
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
div <- bial[n+1,] == 1
divsites_AMR <- sum (div & !polym,na.rm=T)
divsites_AMR
D=divsites_AMR/51255
D

#Neutrality statistics
Clusters.all_AMR <- neutrality.stats(Clusters.all_AMR, do.R2 = TRUE)
get.neutrality(Clusters.all_AMR, theta=TRUE) [[1]]
Mu <- (Clusters.all_AMR@theta_Watterson/51255)/40000
Mu

#Diversities
Clusters.all_AMR <- diversity.stats(Clusters.all_AMR, pi=TRUE) 
get.diversity(Clusters.all_AMR) [[1]]

#Pi
individuals <- get.individuals(Clusters.all_AMR)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 

bial <- get.biallelic.matrix(Clusters.all_AMR,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters.all_AMR@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 6198867:148956111))) # N polyallelic sites in that region
m <- 51255-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

Clusters.all_AMR.split <- splitting.data (Clusters.all_AMR, positions = list(c(6198867:6207568), c(6617659:6633659), c(27493034:27502607), c(35732666:35739378), c(56870712:56905707), c(63200389:63215405), c(64293379:64300618), c(66362919:66374773), c(74437156:74447091), c(102908736:102923212), c(117852321:117869066), c(148943506:148956111)), type=2)
Clusters.all_AMR.split <- neutrality.stats(Clusters.all_AMR.split, do.R2 = TRUE)
get.neutrality(Clusters.all_AMR.split, theta=TRUE) [[1]]
Clusters.all_AMR.split <- diversity.stats(Clusters.all_AMR.split, pi=TRUE)
get.diversity(Clusters.all_AMR.split) [[1]]

#Cluster_1
Clusters1_AMR<- readVCF("new_chr7_2.vcf.gz", numcols=10000, tid="7", from=6198867, to=6207568, include.unknown = TRUE)
Clusters1_AMR <- set.outgroup(Clusters1_AMR,c("Chimp"), diploid=TRUE)
get.sum.data(Clusters1_AMR) 

#Divergence
bial <- get.biallelic.matrix(Clusters1_AMR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites1_AMR <- sum (div & !polym,na.rm=T)
divsites1_AMR
D <- divsites1_AMR/212
D

#Mutation rate
Clusters1_AMR <- neutrality.stats(Clusters1_AMR, FAST = TRUE)
Mu <- (Clusters1_AMR@theta_Watterson/212)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters1_AMR)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters1_AMR,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters1_AMR@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 6198867:6207568))) # N polyallelic sites in that region
m <- 212-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_2
Clusters2_AMR<- readVCF("new_chr7_2.vcf.gz", numcols=10000, tid="7", from=6617659, to=6633659, include.unknown = TRUE)
Clusters2_AMR <- set.outgroup(Clusters2_AMR, c("Chimp"), diploid=TRUE)
get.sum.data(Clusters2_AMR) 

#Divergence
bial <- get.biallelic.matrix(Clusters2_AMR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites2_AMR <- sum (div & !polym,na.rm=T)
divsites2_AMR
D <- divsites2_AMR/643
D

#Mutation rate
Clusters2_AMR <- neutrality.stats(Clusters2_AMR, FAST = TRUE)
Mu <- (Clusters2_AMR@theta_Watterson/643)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters2_AMR)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters2_AMR,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters2_AMR@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 6617659:6633659))) # N polyallelic sites in that region
m <- 643-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_3
Clusters3_AMR <- readVCF("new_chr7_2.vcf.gz", numcols=10000, tid="7", from=27493034, to=27502607, include.unknown = TRUE)
Clusters3_AMR <- set.outgroup(Clusters3_AMR, c("Chimp"), diploid=TRUE)
get.sum.data(Clusters3_AMR) 

#Divergence
bial <- get.biallelic.matrix(Clusters3_AMR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites3_AMR <- sum (div & !polym,na.rm=T)
divsites3_AMR
D <- divsites3_AMR/7684
D

#Mutation rate
Clusters3_AMR <- neutrality.stats(Clusters3_AMR, FAST = TRUE)
Mu <- (Clusters3_AMR@theta_Watterson/7684)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters3_AMR)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters3_AMR,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters3_AMR@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 27493034:27502607))) # N polyallelic sites in that region
m <- 7684-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_4
Clusters4_AMR <- readVCF("new_chr7_2.vcf.gz", numcols=10000, tid="7", from=35732666, to=35739378, include.unknown = TRUE)
Clusters4_AMR <- set.outgroup(Clusters4_AMR,c("Chimp"), diploid=TRUE)
get.sum.data(Clusters4_AFR) 

#Divergence
bial <- get.biallelic.matrix(Clusters4_AMR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites4_AMR <- sum (div & !polym,na.rm=T)
divsites4_AMR
D <- divsites4_AMR/355
D

#Mutation rate
Clusters4_AMR <- neutrality.stats(Clusters4_AMR, FAST = TRUE)
Mu <- (Clusters4_AMR@theta_Watterson/355)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters4_AMR)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters4_AMR,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters4_AMR@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 35732666:35739378))) # N polyallelic sites in that region
m <- 355-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_5
Clusters5_AMR<- readVCF("new_chr7_2.vcf.gz", numcols=10000, tid="7", from=56870712, to=56905707, include.unknown = TRUE)
Clusters5_AMR <- set.outgroup(Clusters5_AMR,c("Chimp"), diploid=TRUE)
get.sum.data(Clusters5_AMR) 

#Divergence
bial <- get.biallelic.matrix(Clusters5_AMR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites5_AMR <- sum (div & !polym,na.rm=T)
divsites5_AMR
D <- divsites5_AMR/3383
D

#Mutation rate
Clusters5_AMR <- neutrality.stats(Clusters5_AMR, FAST = TRUE)
Mu <- (Clusters5_AMR@theta_Watterson/3383)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters5_AMR)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters5_AMR,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters5_AMR@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 56870712:56905707))) # N polyallelic sites in that region
m <- 3383-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_6
Clusters6_AMR<- readVCF("new_chr7_2.vcf.gz", numcols=10000, tid="7", from=63200389, to=63215405, include.unknown = TRUE)
Clusters6_AMR <- set.outgroup(Clusters6_AMR, c("Chimp"), diploid=TRUE)
get.sum.data(Clusters6_AMR) 

#Divergence
bial <- get.biallelic.matrix(Clusters6_AMR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites6_AMR <- sum (div & !polym,na.rm=T)
divsites6_AMR
D <- divsites6_AMR/15016
D

#Mutation rate
Clusters6_AMR <- neutrality.stats(Clusters6_AMR, FAST = TRUE)
Mu <- (Clusters6_AMR@theta_Watterson/15016)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters6_AMR)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters6_AMR,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters6_AMR@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 63200389:63215405))) # N polyallelic sites in that region
m <- 15016-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_7
Clusters7_AMR <- readVCF("new_chr7_2.vcf.gz", numcols=10000, tid="7", from=64293379, to=64300618, include.unknown = TRUE)
Clusters7_AMR <- set.outgroup(Clusters7_AMR,c("Chimp"), diploid=TRUE)
get.sum.data(Clusters7_AMR) 

#Divergence
bial <- get.biallelic.matrix(Clusters7_AMR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites7_AMR <- sum (div & !polym,na.rm=T)
divsites7_AMR
D <- divsites7_AMR/4957
D

#Mutation rate
Clusters7_AMR <- neutrality.stats(Clusters7_AMR, FAST = TRUE)
Mu <- (Clusters7_AMR@theta_Watterson/4957)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters7_AMR)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters7_AMR,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters7_AMR@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 64293379:64300618))) # N polyallelic sites in that region
m <- 4957-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)


#Cluster_8
Clusters8_AMR <- readVCF("new_chr7_2.vcf.gz", numcols=10000, tid="7", from=66362919, to=66374773, include.unknown = TRUE)
Clusters8_AMR <- set.outgroup(Clusters8_AMR, c("Chimp"), diploid=TRUE)
get.sum.data(Clusters8_AMR) 

#Divergence
bial <- get.biallelic.matrix(Clusters8_AMR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites8_AMR <- sum (div & !polym,na.rm=T)
divsites8_AMR
D <- divsites8_AMR/8414
D

#Mutation rate
Clusters8_AMR <- neutrality.stats(Clusters8_AMR, FAST = TRUE)
Mu <- (Clusters8_AMR@theta_Watterson/8414)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters8_AMR)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters8_AMR,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters8_AMR@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 66362919:66374773))) # N polyallelic sites in that region
m <- 8414-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_9
Clusters9_AMR <- readVCF("new_chr7_2.vcf.gz", numcols=10000, tid="7", from=74437156, to=74447091, include.unknown = TRUE)
Clusters9_AMR <- set.outgroup(Clusters9_AMR,c("Chimp"), diploid=TRUE)
get.sum.data(Clusters9_AMR) 

#Divergence
bial <- get.biallelic.matrix(Clusters9_AMR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites9_AMR <- sum (div & !polym,na.rm=T)
divsites9_AMR
D <- divsites9_AMR/2423
D

#Mutation rate
Clusters9_AMR <- neutrality.stats(Clusters9_AMR, FAST = TRUE)
Mu <- (Clusters9_AMR@theta_Watterson/2423)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters9_AMR)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters9_AMR,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters9_AMR@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 74437156:74447091))) # N polyallelic sites in that region
m <- 2423-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_10
Clusters10_AMR <- readVCF("new_chr7_2.vcf.gz", numcols=10000, tid="7", from=102908736, to=102923212, include.unknown = TRUE)
Clusters10_AMR <- set.outgroup(Clusters10_AMR, c("Chimp"), diploid=TRUE)
get.sum.data(Clusters10_AMR) 

#Divergence
bial <- get.biallelic.matrix(Clusters10_AMR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites10_AMR <- sum (div & !polym,na.rm=T)
divsites10_AMR
D <- divsites10_AMR/2355
D

#Mutation rate
Clusters10_AMR <- neutrality.stats(Clusters10_AMR, FAST = TRUE)
Mu <- (Clusters10_AMR@theta_Watterson/2355)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters10_AMR)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters10_AMR,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters10_AMR@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 102908736:102923212))) # N polyallelic sites in that region
m <- 2355-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_11
Clusters11_AMR <- readVCF("new_chr7_2.vcf.gz", numcols=10000, tid="7", from=117852321, to=117869066, include.unknown = TRUE)
Clusters11_AMR <- set.outgroup(Clusters11_AMR,c("Chimp"), diploid=TRUE)
get.sum.data(Clusters11_AMR) 

#Divergence
bial <- get.biallelic.matrix(Clusters11_AMR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites11_AMR <- sum (div & !polym,na.rm=T)
divsites11_AMR
D <- divsites11_AMR/2402
D

#Mutation rate
Clusters11_AMR <- neutrality.stats(Clusters11_AMR, FAST = TRUE)
Mu <- (Clusters11_AMR@theta_Watterson/2402)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters11_AMR)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters11_AMR,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters11_AMR@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 117852321:117869066))) # N polyallelic sites in that region
m <- 2402-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_12
Clusters12_AMR <- readVCF("new_chr7_2.vcf.gz", numcols=10000, tid="7", from=148943506, to=148956111, include.unknown = TRUE)
Clusters12_AMR <- set.outgroup(Clusters12_AMR,c("Chimp"), diploid=TRUE)
get.sum.data(Clusters12_AMR) 

#Divergence
bial <- get.biallelic.matrix(Clusters12_AMR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites12_AMR <- sum (div & !polym,na.rm=T)
divsites12_AMR
D <- divsites12_AMR/3411
D

#Mutation rate
Clusters12_AMR <- neutrality.stats(Clusters12_AMR, FAST = TRUE)
Mu <- (Clusters12_AMR@theta_Watterson/3411)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters12_AMR)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters12_AMR,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters12_AMR@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 148943506:148956111))) # N polyallelic sites in that region
m <- 3411-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#EAS
Clusters.all_EAS <- readVCF("new_chr7_3.vcf.gz", numcols=10000, tid="7", from=6198867, to=148956111, include.unknown = TRUE)
Clusters.all_EAS <- set.outgroup(Clusters.all_EAS,c("Chimp"), diploid=TRUE)
get.sum.data(Clusters.all_EAS)

#Divergence calculation
bial <- get.biallelic.matrix(Clusters.all_EAS,1) # Biallelic matrix
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
div <- bial[n+1,] == 1
divsites_EAS <- sum (div & !polym,na.rm=T)
divsites_EAS
D=divsites_EAS/51255
D

#Neutrality statistics
Clusters.all_EAS <- neutrality.stats(Clusters.all_EAS, do.R2 = TRUE)
get.neutrality(Clusters.all_EAS, theta=TRUE) [[1]]
Mu <- (Clusters.all_EAS@theta_Watterson/51255)/40000
Mu

#Diversities
Clusters.all_EAS <- diversity.stats(Clusters.all_EAS, pi=TRUE) 
get.diversity(Clusters.all_EAS) [[1]]

#Pi
individuals <- get.individuals(Clusters.all_EAS)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 

bial <- get.biallelic.matrix(Clusters.all_EAS,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters.all_EAS@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 6198867:148956111))) # N polyallelic sites in that region
m <- 51255-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

Clusters.all_EAS.split <- splitting.data (Clusters.all_EAS, positions = list(c(6198867:6207568), c(6617659:6633659), c(27493034:27502607), c(35732666:35739378), c(56870712:56905707), c(63200389:63215405), c(64293379:64300618), c(66362919:66374773), c(74437156:74447091), c(102908736:102923212), c(117852321:117869066), c(148943506:148956111)), type=2)
Clusters.all_EAS.split <- neutrality.stats(Clusters.all_EAS.split, do.R2 = TRUE)
get.neutrality(Clusters.all_EAS.split, theta=TRUE) [[1]]
Clusters.all_EAS.split <- diversity.stats(Clusters.all_EAS.split, pi=TRUE)
get.diversity(Clusters.all_EAS.split) [[1]]

#Cluster_1
Clusters1_EAS<- readVCF("new_chr7_3.vcf.gz", numcols=10000, tid="7", from=6198867, to=6207568, include.unknown = TRUE)
Clusters1_EAS <- set.outgroup(Clusters1_EAS,c("Chimp"), diploid=TRUE)
get.sum.data(Clusters1_EAS) 

#Divergence
bial <- get.biallelic.matrix(Clusters1_EAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites1_EAS <- sum (div & !polym,na.rm=T)
divsites1_EAS
D <- divsites1_EAS/212
D

#Mutation rate
Clusters1_EAS <- neutrality.stats(Clusters1_EAS, FAST = TRUE)
Mu <- (Clusters1_EAS@theta_Watterson/212)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters1_EAS)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters1_EAS,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters1_EAS@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 6198867:6207568))) # N polyallelic sites in that region
m <- 212-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_2
Clusters2_EAS<- readVCF("new_chr7_3.vcf.gz", numcols=10000, tid="7", from=6617659, to=6633659, include.unknown = TRUE)
Clusters2_EAS <- set.outgroup(Clusters2_EAS, c("Chimp"), diploid=TRUE)
get.sum.data(Clusters2_EAS) 

#Divergence
bial <- get.biallelic.matrix(Clusters2_EAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites2_EAS <- sum (div & !polym,na.rm=T)
divsites2_EAS
D <- divsites2_EAS/643
D

#Mutation rate
Clusters2_EAS <- neutrality.stats(Clusters2_EAS, FAST = TRUE)
Mu <- (Clusters2_EAS@theta_Watterson/643)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters2_EAS)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters2_EAS,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters2_EAS@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 6617659:6633659))) # N polyallelic sites in that region
m <- 643-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_3
Clusters3_EAS <- readVCF("new_chr7_3.vcf.gz", numcols=10000, tid="7", from=27493034, to=27502607, include.unknown = TRUE)
Clusters3_EAS <- set.outgroup(Clusters3_EAS, c("Chimp"), diploid=TRUE)
get.sum.data(Clusters3_EAS) 

#Divergence
bial <- get.biallelic.matrix(Clusters3_EAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites3_EAS <- sum (div & !polym,na.rm=T)
divsites3_EAS
D <- divsites3_EAS/7684
D

#Mutation rate
Clusters3_EAS <- neutrality.stats(Clusters3_EAS, FAST = TRUE)
Mu <- (Clusters3_EAS@theta_Watterson/7684)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters3_EAS)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters3_EAS,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters3_EAS@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 27493034:27502607))) # N polyallelic sites in that region
m <- 7684-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_4
Clusters4_EAS <- readVCF("new_chr7_3.vcf.gz", numcols=10000, tid="7", from=35732666, to=35739378, include.unknown = TRUE)
Clusters4_EAS <- set.outgroup(Clusters4_EAS,c("Chimp"), diploid=TRUE)
get.sum.data(Clusters4_EAS) 

#Divergence
bial <- get.biallelic.matrix(Clusters4_EAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites4_EAS <- sum (div & !polym,na.rm=T)
divsites4_EAS
D <- divsites4_EAS/355
D

#Mutation rate
Clusters4_EAS <- neutrality.stats(Clusters4_EAS, FAST = TRUE)
Mu <- (Clusters4_EAS@theta_Watterson/355)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters4_EAS)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters4_EAS,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters4_EAS@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 35732666:35739378))) # N polyallelic sites in that region
m <- 355-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_5
Clusters5_EAS<- readVCF("new_chr7_3.vcf.gz", numcols=10000, tid="7", from=56870712, to=56905707, include.unknown = TRUE)
Clusters5_EAS <- set.outgroup(Clusters5_EAS,c("Chimp"), diploid=TRUE)
get.sum.data(Clusters5_EAS) 

#Divergence
bial <- get.biallelic.matrix(Clusters5_EAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites5_EAS <- sum (div & !polym,na.rm=T)
divsites5_EAS
D <- divsites5_EAS/3383
D

#Mutation rate
Clusters5_EAS <- neutrality.stats(Clusters5_EAS, FAST = TRUE)
Mu <- (Clusters5_EAS@theta_Watterson/3383)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters5_EAS)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters5_EAS,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters5_EAS@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 56870712:56905707))) # N polyallelic sites in that region
m <- 3383-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_6
Clusters6_EAS<- readVCF("new_chr7_3.vcf.gz", numcols=10000, tid="7", from=63200389, to=63215405, include.unknown = TRUE)
Clusters6_EAS <- set.outgroup(Clusters6_EAS, c("Chimp"), diploid=TRUE)
get.sum.data(Clusters6_EAS) 

#Divergence
bial <- get.biallelic.matrix(Clusters6_EAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites6_EAS <- sum (div & !polym,na.rm=T)
divsites6_EAS
D <- divsites6_EAS/15016
D

#Mutation rate
Clusters6_EAS <- neutrality.stats(Clusters6_EAS, FAST = TRUE)
Mu <- (Clusters6_EAS@theta_Watterson/15016)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters6_EAS)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters6_EAS,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters6_EAS@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 63200389:63215405))) # N polyallelic sites in that region
m <- 15016-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_7
Clusters7_EAS <- readVCF("new_chr7_3.vcf.gz", numcols=10000, tid="7", from=64293379, to=64300618, include.unknown = TRUE)
Clusters7_EAS <- set.outgroup(Clusters7_EAS,c("Chimp"), diploid=TRUE)
get.sum.data(Clusters7_EAS) 

#Divergence
bial <- get.biallelic.matrix(Clusters7_EAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites7_EAS <- sum (div & !polym,na.rm=T)
divsites7_EAS
D <- divsites7_EAS/4957
D

#Mutation rate
Clusters7_EAS <- neutrality.stats(Clusters7_EAS, FAST = TRUE)
Mu <- (Clusters7_EAS@theta_Watterson/4957)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters7_EAS)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters7_EAS,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters7_EAS@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 64293379:64300618))) # N polyallelic sites in that region
m <- 4957-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)


#Cluster_8
Clusters8_EAS <- readVCF("new_chr7_3.vcf.gz", numcols=10000, tid="7", from=66362919, to=66374773, include.unknown = TRUE)
Clusters8_EAS <- set.outgroup(Clusters8_EAS, c("Chimp"), diploid=TRUE)
get.sum.data(Clusters8_EAS) 

#Divergence
bial <- get.biallelic.matrix(Clusters8_EAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites8_EAS <- sum (div & !polym,na.rm=T)
divsites8_EAS
D <- divsites8_EAS/8414
D

#Mutation rate
Clusters8_EAS <- neutrality.stats(Clusters8_EAS, FAST = TRUE)
Mu <- (Clusters8_EAS@theta_Watterson/8414)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters8_EAS)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters8_EAS,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters8_EAS@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 66362919:66374773))) # N polyallelic sites in that region
m <- 8414-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_9
Clusters9_EAS <- readVCF("new_chr7_3.vcf.gz", numcols=10000, tid="7", from=74437156, to=74447091, include.unknown = TRUE)
Clusters9_EAS <- set.outgroup(Clusters9_EAS,c("Chimp"), diploid=TRUE)
get.sum.data(Clusters9_EAS) 

#Divergence
bial <- get.biallelic.matrix(Clusters9_EAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites9_EAS <- sum (div & !polym,na.rm=T)
divsites9_EAS
D <- divsites9_EAS/2423
D

#Mutation rate
Clusters9_EAS <- neutrality.stats(Clusters9_EAS, FAST = TRUE)
Mu <- (Clusters9_EAS@theta_Watterson/2423)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters9_EAS)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters9_EAS,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters9_EAS@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 74437156:74447091))) # N polyallelic sites in that region
m <- 2423-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_10
Clusters10_EAS <- readVCF("new_chr7_3.vcf.gz", numcols=10000, tid="7", from=102908736, to=102923212, include.unknown = TRUE)
Clusters10_EAS <- set.outgroup(Clusters10_EAS, c("Chimp"), diploid=TRUE)
get.sum.data(Clusters10_EAS) 

#Divergence
bial <- get.biallelic.matrix(Clusters10_EAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites10_EAS <- sum (div & !polym,na.rm=T)
divsites10_EAS
D <- divsites10_EAS/2355
D

#Mutation rate
Clusters10_EAS <- neutrality.stats(Clusters10_EAS, FAST = TRUE)
Mu <- (Clusters10_EAS@theta_Watterson/2355)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters10_EAS)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters10_EAS,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters10_EAS@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 102908736:102923212))) # N polyallelic sites in that region
m <- 2355-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_11
Clusters11_EAS <- readVCF("new_chr7_3.vcf.gz", numcols=10000, tid="7", from=117852321, to=117869066, include.unknown = TRUE)
Clusters11_EAS <- set.outgroup(Clusters11_EAS,c("Chimp"), diploid=TRUE)
get.sum.data(Clusters11_EAS) 

#Divergence
bial <- get.biallelic.matrix(Clusters11_EAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites11_EAS <- sum (div & !polym,na.rm=T)
divsites11_EAS
D <- divsites11_EAS/2402
D

#Mutation rate
Clusters11_EAS <- neutrality.stats(Clusters11_EAS, FAST = TRUE)
Mu <- (Clusters11_EAS@theta_Watterson/2402)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters11_EAS)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters11_EAS,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters11_EAS@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 117852321:117869066))) # N polyallelic sites in that region
m <- 2402-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_12
Clusters12_EAS <- readVCF("new_chr7_3.vcf.gz", numcols=10000, tid="7", from=148943506, to=148956111, include.unknown = TRUE)
Clusters12_EAS <- set.outgroup(Clusters12_EAS,c("Chimp"), diploid=TRUE)
get.sum.data(Clusters12_EAS) 

#Divergence
bial <- get.biallelic.matrix(Clusters12_EAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites12_EAS <- sum (div & !polym,na.rm=T)
divsites12_EAS
D <- divsites12_EAS/3411
D

#Mutation rate
Clusters12_EAS <- neutrality.stats(Clusters12_EAS, FAST = TRUE)
Mu <- (Clusters12_EAS@theta_Watterson/3411)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters12_EAS)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters12_EAS,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters12_EAS@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 148943506:148956111))) # N polyallelic sites in that region
m <- 3411-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#EUR
Clusters.all_EUR <- readVCF("new_chr7_4.vcf.gz", numcols=10000, tid="7", from=6198867, to=148956111, include.unknown = TRUE)
Clusters.all_EUR <- set.outgroup(Clusters.all_EUR,c("Chimp"), diploid=TRUE)
get.sum.data(Clusters.all_EUR)

#Divergence calculation
bial <- get.biallelic.matrix(Clusters.all_EUR,1) # Biallelic matrix
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
div <- bial[n+1,] == 1
divsites_EUR <- sum (div & !polym,na.rm=T)
divsites_EUR
D=divsites_EUR/51255
D

#Neutrality statistics
Clusters.all_EUR <- neutrality.stats(Clusters.all_EUR, do.R2 = TRUE)
get.neutrality(Clusters.all_EUR, theta=TRUE) [[1]]
Mu <- (Clusters.all_EUR@theta_Watterson/51255)/40000
Mu

#Diversities
Clusters.all_EUR <- diversity.stats(Clusters.all_EUR, pi=TRUE) 
get.diversity(Clusters.all_EUR) [[1]]

#Pi
individuals <- get.individuals(Clusters.all_EUR)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 

bial <- get.biallelic.matrix(Clusters.all_EUR,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters.all_EUR@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 6198867:148956111))) # N polyallelic sites in that region
m <- 51255-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

Clusters.all_EUR.split <- splitting.data (Clusters.all_EUR, positions = list(c(6198867:6207568), c(6617659:6633659), c(27493034:27502607), c(35732666:35739378), c(56870712:56905707), c(63200389:63215405), c(64293379:64300618), c(66362919:66374773), c(74437156:74447091), c(102908736:102923212), c(117852321:117869066), c(148943506:148956111)), type=2)
Clusters.all_EUR.split <- neutrality.stats(Clusters.all_EUR.split, do.R2 = TRUE)
get.neutrality(Clusters.all_EUR.split, theta=TRUE) [[1]]
Clusters.all_EUR.split <- diversity.stats(Clusters.all_EUR.split, pi=TRUE)
get.diversity(Clusters.all_EUR.split) [[1]]

#Cluster_1
Clusters1_EUR<- readVCF("new_chr7_4.vcf.gz", numcols=10000, tid="7", from=6198867, to=6207568, include.unknown = TRUE)
Clusters1_EUR <- set.outgroup(Clusters1_EUR,c("Chimp"), diploid=TRUE)
get.sum.data(Clusters1_EUR) 

#Divergence
bial <- get.biallelic.matrix(Clusters1_EUR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites1_EUR <- sum (div & !polym,na.rm=T)
divsites1_EUR
D <- divsites1_EUR/212
D

#Mutation rate
Clusters1_EUR <- neutrality.stats(Clusters1_EUR, FAST = TRUE)
Mu <- (Clusters1_EUR@theta_Watterson/212)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters1_EUR)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters1_EUR,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters1_EUR@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 6198867:6207568))) # N polyallelic sites in that region
m <- 212-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_2
Clusters2_EUR<- readVCF("new_chr7_4.vcf.gz", numcols=10000, tid="7", from=6617659, to=6633659, include.unknown = TRUE)
Clusters2_EUR <- set.outgroup(Clusters2_EUR, c("Chimp"), diploid=TRUE)
get.sum.data(Clusters2_EUR) 

#Divergence
bial <- get.biallelic.matrix(Clusters2_EUR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites2_EUR <- sum (div & !polym,na.rm=T)
divsites2_EUR
D <- divsites2_EUR/643
D

#Mutation rate
Clusters2_EUR <- neutrality.stats(Clusters2_EUR, FAST = TRUE)
Mu <- (Clusters2_EUR@theta_Watterson/643)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters2_EUR)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters2_EUR,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters2_EUR@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 6617659:6633659))) # N polyallelic sites in that region
m <- 643-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_3
Clusters3_EUR <- readVCF("new_chr7_4.vcf.gz", numcols=10000, tid="7", from=27493034, to=27502607, include.unknown = TRUE)
Clusters3_EUR <- set.outgroup(Clusters3_EUR, c("Chimp"), diploid=TRUE)
get.sum.data(Clusters3_EUR) 

#Divergence
bial <- get.biallelic.matrix(Clusters3_EUR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites3_EUR <- sum (div & !polym,na.rm=T)
divsites3_EUR
D <- divsites3_EUR/7684
D

#Mutation rate
Clusters3_EUR <- neutrality.stats(Clusters3_EUR, FAST = TRUE)
Mu <- (Clusters3_EUR@theta_Watterson/7684)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters3_EUR)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters3_EUR,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters3_EUR@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 27493034:27502607))) # N polyallelic sites in that region
m <- 7684-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_4
Clusters4_EUR <- readVCF("new_chr7_4.vcf.gz", numcols=10000, tid="7", from=35732666, to=35739378, include.unknown = TRUE)
Clusters4_EUR <- set.outgroup(Clusters4_EUR,c("Chimp"), diploid=TRUE)
get.sum.data(Clusters4_EUR) 

#Divergence
bial <- get.biallelic.matrix(Clusters4_EUR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites4_EUR <- sum (div & !polym,na.rm=T)
divsites4_EUR
D <- divsites4_EUR/355
D

#Mutation rate
Clusters4_EUR <- neutrality.stats(Clusters4_EUR, FAST = TRUE)
Mu <- (Clusters4_EUR@theta_Watterson/355)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters4_EUR)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters4_EUR,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters4_EUR@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 35732666:35739378))) # N polyallelic sites in that region
m <- 355-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_5
Clusters5_EUR<- readVCF("new_chr7_4.vcf.gz", numcols=10000, tid="7", from=56870712, to=56905707, include.unknown = TRUE)
Clusters5_EUR <- set.outgroup(Clusters5_EUR,c("Chimp"), diploid=TRUE)
get.sum.data(Clusters5_EUR) 

#Divergence
bial <- get.biallelic.matrix(Clusters5_EUR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites5_EUR <- sum (div & !polym,na.rm=T)
divsites5_EUR
D <- divsites5_EUR/3383
D

#Mutation rate
Clusters5_EUR <- neutrality.stats(Clusters5_EUR, FAST = TRUE)
Mu <- (Clusters5_EUR@theta_Watterson/3383)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters5_EUR)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters5_EUR,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters5_EUR@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 56870712:56905707))) # N polyallelic sites in that region
m <- 3383-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_6
Clusters6_EUR<- readVCF("new_chr7_4.vcf.gz", numcols=10000, tid="7", from=63200389, to=63215405, include.unknown = TRUE)
Clusters6_EUR <- set.outgroup(Clusters6_EUR, c("Chimp"), diploid=TRUE)
get.sum.data(Clusters6_EUR) 

#Divergence
bial <- get.biallelic.matrix(Clusters6_EUR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites6_EUR <- sum (div & !polym,na.rm=T)
divsites6_EUR
D <- divsites6_EUR/15016
D

#Mutation rate
Clusters6_EUR <- neutrality.stats(Clusters6_EUR, FAST = TRUE)
Mu <- (Clusters6_EUR@theta_Watterson/15016)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters6_EUR)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters6_EUR,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters6_EUR@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 63200389:63215405))) # N polyallelic sites in that region
m <- 15016-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_7
Clusters7_EUR <- readVCF("new_chr7_4.vcf.gz", numcols=10000, tid="7", from=64293379, to=64300618, include.unknown = TRUE)
Clusters7_EUR <- set.outgroup(Clusters7_EUR,c("Chimp"), diploid=TRUE)
get.sum.data(Clusters7_EUR) 

#Divergence
bial <- get.biallelic.matrix(Clusters7_EUR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites7_EUR <- sum (div & !polym,na.rm=T)
divsites7_EUR
D <- divsites7_EUR/4957
D

#Mutation rate
Clusters7_EUR <- neutrality.stats(Clusters7_EUR, FAST = TRUE)
Mu <- (Clusters7_EUR@theta_Watterson/4957)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters7_EUR)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters7_EUR,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters7_EUR@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 64293379:64300618))) # N polyallelic sites in that region
m <- 4957-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)


#Cluster_8
Clusters8_EUR <- readVCF("new_chr7_4.vcf.gz", numcols=10000, tid="7", from=66362919, to=66374773, include.unknown = TRUE)
Clusters8_EUR <- set.outgroup(Clusters8_EUR, c("Chimp"), diploid=TRUE)
get.sum.data(Clusters8_EUR) 

#Divergence
bial <- get.biallelic.matrix(Clusters8_EUR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites8_EUR <- sum (div & !polym,na.rm=T)
divsites8_EUR
D <- divsites8_EUR/8414
D

#Mutation rate
Clusters8_EUR <- neutrality.stats(Clusters8_EUR, FAST = TRUE)
Mu <- (Clusters8_EUR@theta_Watterson/8414)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters8_EUR)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters8_EUR,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters8_EUR@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 66362919:66374773))) # N polyallelic sites in that region
m <- 8414-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_9
Clusters9_EUR <- readVCF("new_chr7_4.vcf.gz", numcols=10000, tid="7", from=74437156, to=74447091, include.unknown = TRUE)
Clusters9_EUR <- set.outgroup(Clusters9_EUR,c("Chimp"), diploid=TRUE)
get.sum.data(Clusters9_EUR) 

#Divergence
bial <- get.biallelic.matrix(Clusters9_EUR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites9_EUR <- sum (div & !polym,na.rm=T)
divsites9_EUR
D <- divsites9_EUR/2423
D

#Mutation rate
Clusters9_EUR <- neutrality.stats(Clusters9_EUR, FAST = TRUE)
Mu <- (Clusters9_EUR@theta_Watterson/2423)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters9_EUR)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters9_EUR,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters9_EUR@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 74437156:74447091))) # N polyallelic sites in that region
m <- 2423-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_10
Clusters10_EUR <- readVCF("new_chr7_4.vcf.gz", numcols=10000, tid="7", from=102908736, to=102923212, include.unknown = TRUE)
Clusters10_EUR <- set.outgroup(Clusters10_EUR, c("Chimp"), diploid=TRUE)
get.sum.data(Clusters10_EUR) 

#Divergence
bial <- get.biallelic.matrix(Clusters10_EUR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites10_EUR <- sum (div & !polym,na.rm=T)
divsites10_EUR
D <- divsites10_EUR/2355
D

#Mutation rate
Clusters10_EUR <- neutrality.stats(Clusters10_EUR, FAST = TRUE)
Mu <- (Clusters10_EUR@theta_Watterson/2355)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters10_EUR)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters10_EUR,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters10_EUR@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 102908736:102923212))) # N polyallelic sites in that region
m <- 2355-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_11
Clusters11_EUR <- readVCF("new_chr7_4.vcf.gz", numcols=10000, tid="7", from=117852321, to=117869066, include.unknown = TRUE)
Clusters11_EUR <- set.outgroup(Clusters11_EUR,c("Chimp"), diploid=TRUE)
get.sum.data(Clusters11_EUR) 

#Divergence
bial <- get.biallelic.matrix(Clusters11_EUR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites11_EUR <- sum (div & !polym,na.rm=T)
divsites11_EUR
D <- divsites11_EUR/2402
D

#Mutation rate
Clusters11_EUR <- neutrality.stats(Clusters11_EUR, FAST = TRUE)
Mu <- (Clusters11_EUR@theta_Watterson/2402)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters11_EUR)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters11_EUR,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters11_EUR@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 117852321:117869066))) # N polyallelic sites in that region
m <- 2402-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_12
Clusters12_EUR <- readVCF("new_chr7_4.vcf.gz", numcols=10000, tid="7", from=148943506, to=148956111, include.unknown = TRUE)
Clusters12_EUR <- set.outgroup(Clusters12_EUR,c("Chimp"), diploid=TRUE)
get.sum.data(Clusters12_EUR) 

#Divergence
bial <- get.biallelic.matrix(Clusters12_EUR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites12_EUR <- sum (div & !polym,na.rm=T)
divsites12_EUR
D <- divsites12_EUR/3411
D

#Mutation rate
Clusters12_EUR <- neutrality.stats(Clusters12_EUR, FAST = TRUE)
Mu <- (Clusters12_EUR@theta_Watterson/3411)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters12_EUR)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters12_EUR,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters12_EUR@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 148943506:148956111))) # N polyallelic sites in that region
m <- 3411-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#SAS
Clusters.all_SAS <- readVCF("new_chr7_5.vcf.gz", numcols=10000, tid="7", from=6198867, to=148956111, include.unknown = TRUE)
Clusters.all_SAS <- set.outgroup(Clusters.all_SAS,c("Chimp"), diploid=TRUE)
get.sum.data(Clusters.all_SAS)

#Divergence calculation
bial <- get.biallelic.matrix(Clusters.all_SAS,1) # Biallelic matrix
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
div <- bial[n+1,] == 1
divsites_SAS <- sum (div & !polym,na.rm=T)
divsites_SAS
D=divsites_SAS/51255
D

#Neutrality statistics
Clusters.all_SAS <- neutrality.stats(Clusters.all_SAS, do.R2 = TRUE)
get.neutrality(Clusters.all_SAS, theta=TRUE) [[1]]
Mu <- (Clusters.all_SAS@theta_Watterson/51255)/40000
Mu

#Diversities
Clusters.all_SAS <- diversity.stats(Clusters.all_SAS, pi=TRUE) 
get.diversity(Clusters.all_SAS) [[1]]

#Pi
individuals <- get.individuals(Clusters.all_SAS)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 

bial <- get.biallelic.matrix(Clusters.all_SAS,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters.all_SAS@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 6198867:148956111))) # N polyallelic sites in that region
m <- 51255-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

Clusters.all_SAS.split <- splitting.data (Clusters.all_SAS, positions = list(c(6198867:6207568), c(6617659:6633659), c(27493034:27502607), c(35732666:35739378), c(56870712:56905707), c(63200389:63215405), c(64293379:64300618), c(66362919:66374773), c(74437156:74447091), c(102908736:102923212), c(117852321:117869066), c(148943506:148956111)), type=2)
Clusters.all_SAS.split <- neutrality.stats(Clusters.all_SAS.split, do.R2 = TRUE)
get.neutrality(Clusters.all_EAS.split, theta=TRUE) [[1]]
Clusters.all_SAS.split <- diversity.stats(Clusters.all_SAS.split, pi=TRUE)
get.diversity(Clusters.all_EAS.split) [[1]]

#Cluster_1
Clusters1_SAS<- readVCF("new_chr7_5.vcf.gz", numcols=10000, tid="7", from=6198867, to=6207568, include.unknown = TRUE)
Clusters1_SAS <- set.outgroup(Clusters1_SAS,c("Chimp"), diploid=TRUE)
get.sum.data(Clusters1_SAS) 

#Divergence
bial <- get.biallelic.matrix(Clusters1_SAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites1_SAS <- sum (div & !polym,na.rm=T)
divsites1_SAS
D <- divsites1_SAS/212
D

#Mutation rate
Clusters1_SAS <- neutrality.stats(Clusters1_SAS, FAST = TRUE)
Mu <- (Clusters1_SAS@theta_Watterson/212)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters1_SAS)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters1_SAS,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters1_SAS@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 6198867:6207568))) # N polyallelic sites in that region
m <- 212-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_2
Clusters2_SAS<- readVCF("new_chr7_5.vcf.gz", numcols=10000, tid="7", from=6617659, to=6633659, include.unknown = TRUE)
Clusters2_SAS <- set.outgroup(Clusters2_SAS, c("Chimp"), diploid=TRUE)
get.sum.data(Clusters2_SAS) 

#Divergence
bial <- get.biallelic.matrix(Clusters2_SAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites2_SAS <- sum (div & !polym,na.rm=T)
divsites2_SAS
D <- divsites2_SAS/643
D

#Mutation rate
Clusters2_SAS <- neutrality.stats(Clusters2_SAS, FAST = TRUE)
Mu <- (Clusters2_SAS@theta_Watterson/643)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters2_SAS)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters2_SAS,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters2_SAS@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 6617659:6633659))) # N polyallelic sites in that region
m <- 643-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_3
Clusters3_SAS <- readVCF("new_chr7_5.vcf.gz", numcols=10000, tid="7", from=27493034, to=27502607, include.unknown = TRUE)
Clusters3_SAS <- set.outgroup(Clusters3_SAS, c("Chimp"), diploid=TRUE)
get.sum.data(Clusters3_SAS) 

#Divergence
bial <- get.biallelic.matrix(Clusters3_SAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites3_SAS <- sum (div & !polym,na.rm=T)
divsites3_SAS
D <- divsites3_SAS/7684
D

#Mutation rate
Clusters3_SAS <- neutrality.stats(Clusters3_SAS, FAST = TRUE)
Mu <- (Clusters3_SAS@theta_Watterson/7684)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters3_SAS)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters3_SAS,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters3_SAS@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 27493034:27502607))) # N polyallelic sites in that region
m <- 7684-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_4
Clusters4_SAS <- readVCF("new_chr7_5.vcf.gz", numcols=10000, tid="7", from=35732666, to=35739378, include.unknown = TRUE)
Clusters4_SAS <- set.outgroup(Clusters4_SAS,c("Chimp"), diploid=TRUE)
get.sum.data(Clusters4_SAS) 

#Divergence
bial <- get.biallelic.matrix(Clusters4_SAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites4_SAS <- sum (div & !polym,na.rm=T)
divsites4_SAS
D <- divsites4_SAS/355
D

#Mutation rate
Clusters4_SAS <- neutrality.stats(Clusters4_SAS, FAST = TRUE)
Mu <- (Clusters4_SAS@theta_Watterson/355)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters4_SAS)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters4_SAS,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters4_SAS@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 35732666:35739378))) # N polyallelic sites in that region
m <- 355-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_5
Clusters5_SAS<- readVCF("new_chr7_5.vcf.gz", numcols=10000, tid="7", from=56870712, to=56905707, include.unknown = TRUE)
Clusters5_SAS <- set.outgroup(Clusters5_SAS,c("Chimp"), diploid=TRUE)
get.sum.data(Clusters5_SAS) 

#Divergence
bial <- get.biallelic.matrix(Clusters5_SAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites5_SAS <- sum (div & !polym,na.rm=T)
divsites5_SAS
D <- divsites5_SAS/3383
D

#Mutation rate
Clusters5_SAS <- neutrality.stats(Clusters5_SAS, FAST = TRUE)
Mu <- (Clusters5_SAS@theta_Watterson/3383)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters5_SAS)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters5_SAS,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters5_SAS@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 56870712:56905707))) # N polyallelic sites in that region
m <- 3383-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_6
Clusters6_SAS<- readVCF("new_chr7_5.vcf.gz", numcols=10000, tid="7", from=63200389, to=63215405, include.unknown = TRUE)
Clusters6_SAS <- set.outgroup(Clusters6_SAS, c("Chimp"), diploid=TRUE)
get.sum.data(Clusters6_SAS) 

#Divergence
bial <- get.biallelic.matrix(Clusters6_SAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites6_SAS <- sum (div & !polym,na.rm=T)
divsites6_SAS
D <- divsites6_SAS/15016
D

#Mutation rate
Clusters6_SAS <- neutrality.stats(Clusters6_SAS, FAST = TRUE)
Mu <- (Clusters6_SAS@theta_Watterson/15016)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters6_SAS)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters6_SAS,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters6_SAS@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 63200389:63215405))) # N polyallelic sites in that region
m <- 15016-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_7
Clusters7_SAS <- readVCF("new_chr7_5.vcf.gz", numcols=10000, tid="7", from=64293379, to=64300618, include.unknown = TRUE)
Clusters7_SAS <- set.outgroup(Clusters7_SAS,c("Chimp"), diploid=TRUE)
get.sum.data(Clusters7_SAS) 

#Divergence
bial <- get.biallelic.matrix(Clusters7_SAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites7_SAS <- sum (div & !polym,na.rm=T)
divsites7_SAS
D <- divsites7_SAS/4957
D

#Mutation rate
Clusters7_SAS <- neutrality.stats(Clusters7_SAS, FAST = TRUE)
Mu <- (Clusters7_SAS@theta_Watterson/4957)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters7_SAS)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters7_SAS,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters7_SAS@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 64293379:64300618))) # N polyallelic sites in that region
m <- 4957-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)


#Cluster_8
Clusters8_SAS <- readVCF("new_chr7_5.vcf.gz", numcols=10000, tid="7", from=66362919, to=66374773, include.unknown = TRUE)
Clusters8_SAS <- set.outgroup(Clusters8_SAS, c("Chimp"), diploid=TRUE)
get.sum.data(Clusters8_SAS) 

#Divergence
bial <- get.biallelic.matrix(Clusters8_SAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites8_SAS <- sum (div & !polym,na.rm=T)
divsites8_SAS
D <- divsites8_SAS/8414
D

#Mutation rate
Clusters8_SAS <- neutrality.stats(Clusters8_SAS, FAST = TRUE)
Mu <- (Clusters8_SAS@theta_Watterson/8414)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters8_SAS)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters8_SAS,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters8_SAS@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 66362919:66374773))) # N polyallelic sites in that region
m <- 8414-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_9
Clusters9_SAS <- readVCF("new_chr7_5.vcf.gz", numcols=10000, tid="7", from=74437156, to=74447091, include.unknown = TRUE)
Clusters9_SAS <- set.outgroup(Clusters9_SAS,c("Chimp"), diploid=TRUE)
get.sum.data(Clusters9_SAS) 

#Divergence
bial <- get.biallelic.matrix(Clusters9_SAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites9_SAS <- sum (div & !polym,na.rm=T)
divsites9_SAS
D <- divsites9_SAS/2423
D

#Mutation rate
Clusters9_SAS <- neutrality.stats(Clusters9_SAS, FAST = TRUE)
Mu <- (Clusters9_SAS@theta_Watterson/2423)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters9_SAS)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters9_SAS,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters9_SAS@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 74437156:74447091))) # N polyallelic sites in that region
m <- 2423-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_10
Clusters10_SAS <- readVCF("new_chr7_5.vcf.gz", numcols=10000, tid="7", from=102908736, to=102923212, include.unknown = TRUE)
Clusters10_SAS <- set.outgroup(Clusters10_SAS, c("Chimp"), diploid=TRUE)
get.sum.data(Clusters10_SAS) 

#Divergence
bial <- get.biallelic.matrix(Clusters10_SAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites10_SAS <- sum (div & !polym,na.rm=T)
divsites10_SAS
D <- divsites10_SAS/2355
D

#Mutation rate
Clusters10_SAS <- neutrality.stats(Clusters10_SAS, FAST = TRUE)
Mu <- (Clusters10_SAS@theta_Watterson/2355)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters10_SAS)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters10_SAS,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters10_SAS@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 102908736:102923212))) # N polyallelic sites in that region
m <- 2355-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_11
Clusters11_SAS <- readVCF("new_chr7_5.vcf.gz", numcols=10000, tid="7", from=117852321, to=117869066, include.unknown = TRUE)
Clusters11_SAS <- set.outgroup(Clusters11_SAS,c("Chimp"), diploid=TRUE)
get.sum.data(Clusters11_SAS) 

#Divergence
bial <- get.biallelic.matrix(Clusters11_SAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites11_SAS <- sum (div & !polym,na.rm=T)
divsites11_SAS
D <- divsites11_SAS/2402
D

#Mutation rate
Clusters11_SAS <- neutrality.stats(Clusters11_SAS, FAST = TRUE)
Mu <- (Clusters11_SAS@theta_Watterson/2402)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters11_SAS)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters11_SAS,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters11_SAS@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 117852321:117869066))) # N polyallelic sites in that region
m <- 2402-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Cluster_12
Clusters12_SAS <- readVCF("new_chr7_5.vcf.gz", numcols=10000, tid="7", from=148943506, to=148956111, include.unknown = TRUE)
Clusters12_SAS <- set.outgroup(Clusters12_SAS,c("Chimp"), diploid=TRUE)
get.sum.data(Clusters12_SAS) 

#Divergence
bial <- get.biallelic.matrix(Clusters12_SAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites12_SAS <- sum (div & !polym,na.rm=T)
divsites12_SAS
D <- divsites12_SAS/3411
D

#Mutation rate
Clusters12_SAS <- neutrality.stats(Clusters12_SAS, FAST = TRUE)
Mu <- (Clusters12_SAS@theta_Watterson/3411)/(4*10000)
Mu

#Pi
individuals <- get.individuals(Clusters12_SAS)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Clusters12_SAS,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Clusters12_SAS@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 148943506:148956111))) # N polyallelic sites in that region
m <- 3411-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])

Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

####################################INTERGENIC REGIONS###################################################

setwd("~/Dropbox (CRG)/Bioinformatics/PiRNA/populations/new_intergenic_regions")

Intergenic.all <- readVCF("new_chr7_intergenic.vcf.gz", numcols=10000, tid="7", from=6132716, to=148959262, include.unknown = TRUE)
Intergenic.all <- set.outgroup(Intergenic.all,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic.all) 

#Divergence calculation
bial <- get.biallelic.matrix(Intergenic.all,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter <- sum (div & !polym,na.rm=T)
divsites_inter
D = divsites_inter/294984
D

Intergenic.all <- neutrality.stats(Intergenic.all, do.R2 = TRUE)
get.neutrality(Intergenic.all, theta=TRUE) [[1]]

Mu <- (Intergenic.all@theta_Watterson/294984)/(4*10000)
Mu

Intergenic.all <- diversity.stats(Intergenic.all, pi=TRUE)
get.diversity(Intergenic.all) [[1]]

#Pi
individuals <- get.individuals(Intergenic.all)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 
bial <- get.biallelic.matrix(Intergenic.all,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Intergenic.all@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 6132716:148959262))) # N polyallelic sites in that region
m <- 294984-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])


Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Region 1
Intergenic1 <- readVCF("new_chr7_intergenic.vcf.gz", numcols=10000, tid="7", from=6132716, to=6144515, include.unknown = TRUE)
Intergenic1 <- set.outgroup(Intergenic1, c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic1) 

#Divergence
bial <- get.biallelic.matrix(Intergenic1,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter1 <- sum (div & !polym,na.rm=T)
divsites_inter1
D <- divsites_inter1/11799
D

#Region 2
Intergenic2 <- readVCF("new_chr7_intergenic.vcf.gz", numcols=10000, tid="7", from=6591067, to=6617065, include.unknown = TRUE)
Intergenic2 <- set.outgroup(Intergenic2,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic2) 

#Divergence
bial <- get.biallelic.matrix(Intergenic2,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter2 <- sum (div & !polym,na.rm=T)
divsites_inter2
D <- divsites_inter2/25992
D

#Region 3
Intergenic3 <- readVCF("new_chr7_intergenic.vcf.gz", numcols=10000, tid="7", from=27452510, to=27493033, include.unknown = TRUE)
Intergenic3 <- set.outgroup(Intergenic3,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic3) 

#Divergence
bial <- get.biallelic.matrix(Intergenic3,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter3 <- sum (div & !polym,na.rm=T)
divsites_inter3
D <- divsites_inter3/37490
D

#Region 4
Intergenic4 <- readVCF("new_chr7_intergenic.vcf.gz", numcols=10000, tid="7", from=35739379, to=35754644, include.unknown = TRUE)
Intergenic4 <- set.outgroup(Intergenic4,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic4) 

#Divergence
bial <- get.biallelic.matrix(Intergenic4,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter4 <- sum (div & !polym,na.rm=T)
divsites_inter4
D <- divsites_inter4/15259
D

#Region 5
Intergenic5 <- readVCF("new_chr7_intergenic.vcf.gz", numcols=10000, tid="7", from=56804283, to=56870711, include.unknown = TRUE)
Intergenic5 <- set.outgroup(Intergenic5, c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic5) 

#Divergence
bial <- get.biallelic.matrix(Intergenic5,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter5 <- sum (div & !polym,na.rm=T)
divsites_inter5
D <- divsites_inter5/64114
D

#Region 6
Intergenic6 <- readVCF("new_chr7_intergenic.vcf.gz", numcols=10000, tid="7", from=63160819, to=63200388, include.unknown = TRUE)
Intergenic6 <- set.outgroup(Intergenic6,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic6) 

#Divergence
bial <- get.biallelic.matrix(Intergenic6,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter6 <- sum (div & !polym,na.rm=T)
divsites_inter6
D <- divsites_inter6/39569
D

#Region 7
Intergenic7 <- readVCF("new_chr7_intergenic.vcf.gz", numcols=10000, tid="7", from=64300619, to=64312775, include.unknown = TRUE)
Intergenic7 <- set.outgroup(Intergenic7,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic7) 

#Divergence
bial <- get.biallelic.matrix(Intergenic7,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter7 <- sum (div & !polym,na.rm=T)
divsites_inter7
D <- divsites_inter7/12150
D

#Region 8
Intergenic8 <- readVCF("new_chr7_intergenic.vcf.gz", numcols=10000, tid="7", from=66356278, to=66362918, include.unknown = TRUE)
Intergenic8 <- set.outgroup(Intergenic8, c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic8)

#Divergence
bial <- get.biallelic.matrix(Intergenic8,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter8 <- sum (div & !polym,na.rm=T)
divsites_inter8
D <- divsites_inter8/1619
D

#Region 9
Intergenic9 <- readVCF("new_chr7_intergenic.vcf.gz", numcols=10000, tid="7", from=74329339, to=74379083, include.unknown = TRUE)
Intergenic9 <- set.outgroup(Intergenic9, c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic9) 

#Divergence
bial <- get.biallelic.matrix(Intergenic9,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter9 <- sum (div & !polym,na.rm=T)
divsites_inter9
D <- divsites_inter9/49744
D

#Region 10
Intergenic10 <- readVCF("new_chr7_intergenic.vcf.gz", numcols=10000, tid="7", from=102923213, to=102937869, include.unknown = TRUE)
Intergenic10 <- set.outgroup(Intergenic10,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic10) 

#Divergence
bial <- get.biallelic.matrix(Intergenic10,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter10 <- sum (div & !polym,na.rm=T)
divsites_inter10
D <- divsites_inter10/14656
D

#Region 11
Intergenic11 <- readVCF("new_chr7_intergenic.vcf.gz", numcols=10000, tid="7", from=117832878, to=117852320, include.unknown = TRUE)
Intergenic11 <- set.outgroup(Intergenic11,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic11) 

#Divergence
bial <- get.biallelic.matrix(Intergenic11,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter11 <- sum (div & !polym,na.rm=T)
divsites_inter11
D <- divsites_inter11/19442
D

#Region 12
Intergenic12 <- readVCF("new_chr7_intergenic.vcf.gz", numcols=10000, tid="7", from=148956112, to=148959262, include.unknown = TRUE)
Intergenic12 <- set.outgroup(Intergenic12, c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic12) 

#Divergence
bial <- get.biallelic.matrix(Intergenic12,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter12 <- sum (div & !polym,na.rm=T)
divsites_inter12
D <- divsites_inter12/3150
D

###################POPULATIONS####################################################

#AFR
Intergenic.all_AFR <- readVCF("new_chr7_1_intergenic.vcf.gz", numcols=10000, tid="7", from=6132716, to=148959262, include.unknown = TRUE)
Intergenic.all_AFR <- set.outgroup(Intergenic.all_AFR, c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic.all_AFR) 

#Divergence calculation
bial <- get.biallelic.matrix(Intergenic.all_AFR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter_AFR <- sum (div & !polym,na.rm=T)
divsites_inter_AFR
D <- divsites_inter_AFR/11799
D

Intergenic.all_AFR <- neutrality.stats(Intergenic.all_AFR, do.R2 = TRUE)
get.neutrality(Intergenic.all_AFR, theta=TRUE) [[1]]
Mu <- (Intergenic.all_AFR@theta_Watterson/11799)/(4*10000)
Mu

Intergenic.all_AFR <- diversity.stats(Intergenic.all_AFR, pi=TRUE)
get.diversity(Intergenic.all_AFR) [[1]]

#Pi
individuals <- get.individuals(Intergenic.all_AFR)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 

bial <- get.biallelic.matrix(Intergenic.all_AFR,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Intergenic.all_AFR@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 6132716:148959262))) # N of olylelic sites in that region
m <- 11799-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])


Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Region 1
Intergenic1_AFR <- readVCF("new_chr7_1_intergenic.vcf.gz", numcols=10000, tid="7", from=6132716, to=6144515, include.unknown = TRUE)
Intergenic1_AFR <- set.outgroup(Intergenic1_AFR,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic1_AFR) 

#Divergence
bial <- get.biallelic.matrix(Intergenic1_AFR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter1_AFR <- sum (div & !polym,na.rm=T)
divsites_inter1_AFR
D <- divsites_inter1_AFR/11799
D

#Region 2
Intergenic2_AFR <- readVCF("new_chr7_1_intergenic.vcf.gz", numcols=10000, tid="7", from=6591067, to=6617065, include.unknown = TRUE)
Intergenic2_AFR <- set.outgroup(Intergenic2_AFR,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic2_AFR) 

#Divergence
bial <- get.biallelic.matrix(Intergenic2_AFR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter2_AFR <- sum (div & !polym,na.rm=T)
divsites_inter2_AFR
D <- divsites_inter2_AFR/25992
D

#Region 3
Intergenic3_AFR <- readVCF("new_chr7_1_intergenic.vcf.gz", numcols=10000, tid="7", from=27452510, to=27493033, include.unknown = TRUE)
Intergenic3_AFR <- set.outgroup(Intergenic3_AFR,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic3_AFR) 

#Divergence
bial <- get.biallelic.matrix(Intergenic3_AFR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter3_AFR <- sum (div & !polym,na.rm=T)
divsites_inter3_AFR
D <- divsites_inter3_AFR/37490
D

#Region 4
Intergenic4_AFR <- readVCF("new_chr7_1_intergenic.vcf.gz", numcols=10000, tid="7", from=35739379, to=35754644, include.unknown = TRUE)
Intergenic4_AFR <- set.outgroup(Intergenic4_AFR,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic4_AFR) 

#Divergence
bial <- get.biallelic.matrix(Intergenic4_AFR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter4_AFR <- sum (div & !polym,na.rm=T)
divsites_inter4_AFR
D <- divsites_inter4_AFR/15259
D

#Region 5
Intergenic5_AFR <- readVCF("new_chr7_1_intergenic.vcf.gz", numcols=10000, tid="7", from=56804283, to=56870711, include.unknown = TRUE)
Intergenic5_AFR <- set.outgroup(Intergenic5_AFR,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic5_AFR) 

#Divergence
bial <- get.biallelic.matrix(Intergenic5_AFR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter5_AFR <- sum (div & !polym,na.rm=T)
divsites_inter5_AFR
D <- divsites_inter5_AFR/64114
D

#Region 6
Intergenic6_AFR <- readVCF("new_chr7_1_intergenic.vcf.gz", numcols=10000, tid="7", from=63160819, to=63200388, include.unknown = TRUE)
Intergenic6_AFR <- set.outgroup(Intergenic6_AFR,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic6_AFR) 

#Divergence
bial <- get.biallelic.matrix(Intergenic6_AFR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter6_AFR <- sum (div & !polym,na.rm=T)
divsites_inter6_AFR
D <- divsites_inter6_AFR/39569
D

#Region 7
Intergenic7_AFR <- readVCF("new_chr7_1_intergenic.vcf.gz", numcols=10000, tid="7", from=64300619, to=64312775, include.unknown = TRUE)
Intergenic7_AFR <- set.outgroup(Intergenic7_AFR,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic7_AFR) 

#Divergence
bial <- get.biallelic.matrix(Intergenic7_AFR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter7_AFR <- sum (div & !polym,na.rm=T)
divsites_inter7_AFR
D <- divsites_inter7_AFR/12150
D

#Region 8
Intergenic8_AFR <- readVCF("new_chr7_1_intergenic.vcf.gz", numcols=10000, tid="7", from=66356278, to=66362918, include.unknown = TRUE)
Intergenic8_AFR <- set.outgroup(Intergenic8_AFR,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic8_AFR) 

#Divergence
bial <- get.biallelic.matrix(Intergenic8_AFR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter8_AFR <- sum (div & !polym,na.rm=T)
divsites_inter8_AFR
D <- divsites_inter8_AFR/1619
D

#Region 9
Intergenic9_AFR <- readVCF("new_chr7_1_intergenic.vcf.gz", numcols=10000, tid="7", from=74329339, to=74379083, include.unknown = TRUE)
Intergenic9_AFR <- set.outgroup(Intergenic9_AFR,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic9_AFR) 

#Divergence
bial <- get.biallelic.matrix(Intergenic9_AFR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter9_AFR <- sum (div & !polym,na.rm=T)
divsites_inter9_AFR
D <- divsites_inter9_AFR/49744
D

#Region 10
Intergenic10_AFR <- readVCF("new_chr7_1_intergenic.vcf.gz", numcols=10000, tid="7", from=102923213, to=102937869, include.unknown = TRUE)
Intergenic10_AFR <- set.outgroup(Intergenic10_AFR,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic10_AFR) 

#Divergence
bial <- get.biallelic.matrix(Intergenic10_AFR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter10_AFR <- sum (div & !polym,na.rm=T)
divsites_inter10_AFR
D <- divsites_inter10_AFR/14656
D

#Region 11
Intergenic11_AFR <- readVCF("new_chr7_1_intergenic.vcf.gz", numcols=10000, tid="7", from=117832878, to=117852320, include.unknown = TRUE)
Intergenic11_AFR <- set.outgroup(Intergenic11_AFR,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic11_AFR) 

#Divergence
bial <- get.biallelic.matrix(Intergenic11_AFR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter11_AFR <- sum (div & !polym,na.rm=T)
divsites_inter11_AFR
D <- divsites_inter11_AFR/19442
D

#Region 12
Intergenic12_AFR <- readVCF("new_chr7_1_intergenic.vcf.gz", numcols=10000, tid="7", from=148956112, to=148959262, include.unknown = TRUE)
Intergenic12_AFR <- set.outgroup(Intergenic12_AFR,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic12_AFR) 

#Divergence
bial <- get.biallelic.matrix(Intergenic12_AFR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter12_AFR <- sum (div & !polym,na.rm=T)
divsites_inter12_AFR
D <- divsites_inter12_AFR/3150
D

#AMR
Intergenic.all_AMR <- readVCF("new_chr7_2_intergenic.vcf.gz", numcols=10000, tid="7", from=6132716, to=148959262, include.unknown = TRUE)
Intergenic.all_AMR <- set.outgroup(Intergenic.all_AMR, c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic.all_AMR) 

#Divergence calculation
bial <- get.biallelic.matrix(Intergenic.all_AMR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter_AMR <- sum (div & !polym,na.rm=T)
divsites_inter_AMR
D <- divsites_inter_AMR/11799
D

Intergenic.all_AMR <- neutrality.stats(Intergenic.all_AMR, do.R2 = TRUE)
get.neutrality(Intergenic.all_AMR, theta=TRUE) [[1]]
Mu <- (Intergenic.all_AMR@theta_Watterson/11799)/(4*10000)
Mu

Intergenic.all_AMR <- diversity.stats(Intergenic.all_AMR, pi=TRUE)
get.diversity(Intergenic.all_AMR) [[1]]

#Pi
individuals <- get.individuals(Intergenic.all_AMR)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 

bial <- get.biallelic.matrix(Intergenic.all_AMR,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Intergenic.all_AMR@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 6132716:148959262))) # N polyallelic sites in that region
m <- 11799-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])


Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Region 1
Intergenic1_AMR <- readVCF("new_chr7_2_intergenic.vcf.gz", numcols=10000, tid="7", from=6132716, to=6144515, include.unknown = TRUE)
Intergenic1_AMR <- set.outgroup(Intergenic1_AMR,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic1_AMR) 

#Divergence
bial <- get.biallelic.matrix(Intergenic1_AMR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter1_AMR <- sum (div & !polym,na.rm=T)
divsites_inter1_AMR
D <- divsites_inter1_AMR/11799
D

#Region 2
Intergenic2_AMR <- readVCF("new_chr7_2_intergenic.vcf.gz", numcols=10000, tid="7", from=6591067, to=6617065, include.unknown = TRUE)
Intergenic2_AMR <- set.outgroup(Intergenic2_AMR,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic2_AMR) 

#Divergence
bial <- get.biallelic.matrix(Intergenic2_AMR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter2_AMR <- sum (div & !polym,na.rm=T)
divsites_inter2_AMR
D <- divsites_inter2_AMR/25992
D

#Region 3
Intergenic3_AMR <- readVCF("new_chr7_2_intergenic.vcf.gz", numcols=10000, tid="7", from=27452510, to=27493033, include.unknown = TRUE)
Intergenic3_AMR <- set.outgroup(Intergenic3_AMR,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic3_AMR) 

#Divergence
bial <- get.biallelic.matrix(Intergenic3_AMR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter3_AMR <- sum (div & !polym,na.rm=T)
divsites_inter3_AMR
D <- divsites_inter3_AMR/37490
D

#Region 4
Intergenic4_AMR <- readVCF("new_chr7_2_intergenic.vcf.gz", numcols=10000, tid="7", from=35739379, to=35754644, include.unknown = TRUE)
Intergenic4_AMR <- set.outgroup(Intergenic4_AMR,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic4_AMR) 

#Divergence
bial <- get.biallelic.matrix(Intergenic4_AMR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter4_AMR <- sum (div & !polym,na.rm=T)
divsites_inter4_AMR
D <- divsites_inter4_AMR/15259
D

#Region 5
Intergenic5_AMR <- readVCF("new_chr7_2_intergenic.vcf.gz", numcols=10000, tid="7", from=56804283, to=56870711, include.unknown = TRUE)
Intergenic5_AMR <- set.outgroup(Intergenic5_AMR,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic5_AMR) 

#Divergence
bial <- get.biallelic.matrix(Intergenic5_AMR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter5_AMR <- sum (div & !polym,na.rm=T)
divsites_inter5_AMR
D <- divsites_inter5_AMR/64114
D

#Region 6
Intergenic6_AMR <- readVCF("new_chr7_2_intergenic.vcf.gz", numcols=10000, tid="7", from=63160819, to=63200388, include.unknown = TRUE)
Intergenic6_AMR <- set.outgroup(Intergenic6_AMR,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic6_AMR) 

#Divergence
bial <- get.biallelic.matrix(Intergenic6_AMR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter6_AMR <- sum (div & !polym,na.rm=T)
divsites_inter6_AMR
D <- divsites_inter6_AMR/39569
D

#Region 7
Intergenic7_AMR <- readVCF("new_chr7_2_intergenic.vcf.gz", numcols=10000, tid="7", from=64300619, to=64312775, include.unknown = TRUE)
Intergenic7_AMR <- set.outgroup(Intergenic7_AMR,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic7_AMR) 

#Divergence
bial <- get.biallelic.matrix(Intergenic7_AMR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter7_AMR <- sum (div & !polym,na.rm=T)
divsites_inter7_AMR
D <- divsites_inter7_AMR/12150
D

#Region 8
Intergenic8_AMR <- readVCF("new_chr7_2_intergenic.vcf.gz", numcols=10000, tid="7", from=66356278, to=66362918, include.unknown = TRUE)
Intergenic8_AMR <- set.outgroup(Intergenic8_AMR,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic8_AMR) 

#Divergence
bial <- get.biallelic.matrix(Intergenic8_AMR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter8_AMR <- sum (div & !polym,na.rm=T)
divsites_inter8_AMR
D <- divsites_inter8_AMR/1619
D

#Region 9
Intergenic9_AMR <- readVCF("new_chr7_2_intergenic.vcf.gz", numcols=10000, tid="7", from=74329339, to=74379083, include.unknown = TRUE)
Intergenic9_AMR <- set.outgroup(Intergenic9_AMR,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic9_AMR) 

#Divergence
bial <- get.biallelic.matrix(Intergenic9_AMR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter9_AMR <- sum (div & !polym,na.rm=T)
divsites_inter9_AMR
D <- divsites_inter9_AMR/49744
D

#Region 10
Intergenic10_AMR <- readVCF("new_chr7_2_intergenic.vcf.gz", numcols=10000, tid="7", from=102923213, to=102937869, include.unknown = TRUE)
Intergenic10_AMR <- set.outgroup(Intergenic10_AMR,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic10_AMR) 

#Divergence
bial <- get.biallelic.matrix(Intergenic10_AMR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter10_AMR <- sum (div & !polym,na.rm=T)
divsites_inter10_AMR
D <- divsites_inter10_AMR/14656
D

#Region 11
Intergenic11_AMR <- readVCF("new_chr7_2_intergenic.vcf.gz", numcols=10000, tid="7", from=117832878, to=117852320, include.unknown = TRUE)
Intergenic11_AMR <- set.outgroup(Intergenic11_AMR,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic11_AMR) 

#Divergence
bial <- get.biallelic.matrix(Intergenic11_AMR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter11_AMR <- sum (div & !polym,na.rm=T)
divsites_inter11_AMR
D <- divsites_inter11_AMR/19442
D

#Region 12
Intergenic12_AMR <- readVCF("new_chr7_2_intergenic.vcf.gz", numcols=10000, tid="7", from=148956112, to=148959262, include.unknown = TRUE)
Intergenic12_AMR <- set.outgroup(Intergenic12_AMR,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic12_AMR) 

#Divergence
bial <- get.biallelic.matrix(Intergenic12_AMR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter12_AMR <- sum (div & !polym,na.rm=T)
divsites_inter12_AMR
D <- divsites_inter12_AMR/3150
D

#EAS
Intergenic.all_EAS <- readVCF("new_chr7_3_intergenic.vcf.gz", numcols=10000, tid="7", from=6132716, to=148959262,  include.unknown = TRUE)
Intergenic.all_EAS <- set.outgroup(Intergenic.all_EAS, c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic.all_EAS) 

#Divergence calculation
bial <- get.biallelic.matrix(Intergenic.all_EAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter_EAS <- sum (div & !polym,na.rm=T)
divsites_inter_EAS
D <- divsites_inter_EAS/11799
D

Intergenic.all_EAS <- neutrality.stats(Intergenic.all_EAS, do.R2 = TRUE)
get.neutrality(Intergenic.all_EAS, theta=TRUE) [[1]]
Mu <- (Intergenic.all_EAS@theta_Watterson/11799)/(4*10000)
Mu

Intergenic.all_EAS <- diversity.stats(Intergenic.all_EAS, pi=TRUE)
get.diversity(Intergenic.all_EAS) [[1]]

#Pi
individuals <- get.individuals(Intergenic.all_EAS)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 

bial <- get.biallelic.matrix(Intergenic.all_EAS,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Intergenic.all_EAS@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 6132716:148959262))) # N polyallelic sites in that region
m <- 11799-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])


Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Region 1
Intergenic1_EAS <- readVCF("new_chr7_3_intergenic.vcf.gz", numcols=10000, tid="7", from=6132716, to=6144515, include.unknown = TRUE)
Intergenic1_EAS <- set.outgroup(Intergenic1_EAS,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic1_EAS) 

#Divergence
bial <- get.biallelic.matrix(Intergenic1_EAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter1_EAS <- sum (div & !polym,na.rm=T)
divsites_inter1_EAS
D <- divsites_inter1_EAS/11799
D

#Region 2
Intergenic2_EAS <- readVCF("new_chr7_3_intergenic.vcf.gz", numcols=10000, tid="7", from=6591067, to=6617065, include.unknown = TRUE)
Intergenic2_EAS <- set.outgroup(Intergenic2_EAS,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic2_EAS) 

#Divergence
bial <- get.biallelic.matrix(Intergenic2_EAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter2_EAS <- sum (div & !polym,na.rm=T)
divsites_inter2_EAS
D <- divsites_inter2_EAS/25992
D

#Region 3
Intergenic3_EAS<- readVCF("new_chr7_3_intergenic.vcf.gz", numcols=10000, tid="7", from=27452510, to=27493033, include.unknown = TRUE)
Intergenic3_EAS <- set.outgroup(Intergenic3_EAS,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic3_EAS) 

#Divergence
bial <- get.biallelic.matrix(Intergenic3_EAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter3_EAS <- sum (div & !polym,na.rm=T)
divsites_inter3_EAS
D <- divsites_inter3_EAS/37490
D

#Region 4
Intergenic4_EAS <- readVCF("new_chr7_3_intergenic.vcf.gz", numcols=10000, tid="7", from=35739379, to=35754644, include.unknown = TRUE)
Intergenic4_EAS <- set.outgroup(Intergenic4_EAS,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic4_EAS) 

#Divergence
bial <- get.biallelic.matrix(Intergenic4_EAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter4_EAS <- sum (div & !polym,na.rm=T)
divsites_inter4_EAS
D <- divsites_inter4_EAS/15259
D

#Region 5
Intergenic5_EAS <- readVCF("new_chr7_3_intergenic.vcf.gz", numcols=10000, tid="7", from=56804283, to=56870711, include.unknown = TRUE)
Intergenic5_EAS <- set.outgroup(Intergenic5_EAS,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic5_EAS) 

#Divergence
bial <- get.biallelic.matrix(Intergenic5_EAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter5_EAS <- sum (div & !polym,na.rm=T)
divsites_inter5_EAS
D <- divsites_inter5_EAS/64114
D

#Region 6
Intergenic6_EAS <- readVCF("new_chr7_3_intergenic.vcf.gz", numcols=10000, tid="7", from=63160819, to=63200388, include.unknown = TRUE)
Intergenic6_EAS <- set.outgroup(Intergenic6_EAS,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic6_EAS) 

#Divergence
bial <- get.biallelic.matrix(Intergenic6_EAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter6_EAS <- sum (div & !polym,na.rm=T)
divsites_inter6_EAS
D <- divsites_inter6_EAS/39569
D

#Region 7
Intergenic7_EAS <- readVCF("new_chr7_3_intergenic.vcf.gz", numcols=10000, tid="7", from=64300619, to=64312775, include.unknown = TRUE)
Intergenic7_EAS <- set.outgroup(Intergenic7_EAS,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic7_EAS) 

#Divergence
bial <- get.biallelic.matrix(Intergenic7_EAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter7_EAS <- sum (div & !polym,na.rm=T)
divsites_inter7_EAS
D <- divsites_inter7_EAS/12150
D

#Region 8
Intergenic8_EAS <- readVCF("new_chr7_3_intergenic.vcf.gz", numcols=10000, tid="7", from=66356278, to=66362918, include.unknown = TRUE)
Intergenic8_EAS <- set.outgroup(Intergenic8_EAS,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic8_EAS) 

#Divergence
bial <- get.biallelic.matrix(Intergenic8_EAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter8_EAS <- sum (div & !polym,na.rm=T)
divsites_inter8_EAS
D <- divsites_inter8_EAS/1619
D

#Region 9
Intergenic9_EAS <- readVCF("new_chr7_3_intergenic.vcf.gz", numcols=10000, tid="7", from=74329339, to=74379083, include.unknown = TRUE)
Intergenic9_EAS <- set.outgroup(Intergenic9_EAS,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic9_EAS) 

#Divergence
bial <- get.biallelic.matrix(Intergenic9_EAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter9_EAS <- sum (div & !polym,na.rm=T)
divsites_inter9_EAS
D <- divsites_inter9_EAS/49744
D

#Region 10
Intergenic10_EAS <- readVCF("new_chr7_3_intergenic.vcf.gz", numcols=10000, tid="7", from=102923213, to=102937869, include.unknown = TRUE)
Intergenic10_EAS <- set.outgroup(Intergenic10_EAS,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic10_EAS) 

#Divergence
bial <- get.biallelic.matrix(Intergenic10_EAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter10_EAS <- sum (div & !polym,na.rm=T)
divsites_inter10_EAS
D <- divsites_inter10_EAS/14656
D

#Region 11
Intergenic11_EAS <- readVCF("new_chr7_3_intergenic.vcf.gz", numcols=10000, tid="7", from=117832878, to=117852320, include.unknown = TRUE)
Intergenic11_EAS <- set.outgroup(Intergenic11_EAS,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic11_EAS) 

#Divergence
bial <- get.biallelic.matrix(Intergenic11_EAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter11_EAS <- sum (div & !polym,na.rm=T)
divsites_inter11_EAS
D <- divsites_inter11_EAS/19442
D

#Region 12
Intergenic12_EAS <- readVCF("new_chr7_3_intergenic.vcf.gz", numcols=10000, tid="7", from=148956112, to=148959262, include.unknown = TRUE)
Intergenic12_EAS <- set.outgroup(Intergenic12_EAS,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic12_EAS) 

#Divergence
bial <- get.biallelic.matrix(Intergenic12_EAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter12_EAS <- sum (div & !polym,na.rm=T)
divsites_inter12_EAS
D <- divsites_inter12_EAS/3150
D

#EUR
Intergenic.all_EUR <- readVCF("new_chr7_4_intergenic.vcf.gz", numcols=10000, tid="7", from=6132716, to=148959262,  include.unknown = TRUE)
Intergenic.all_EUR <- set.outgroup(Intergenic.all_EUR, c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic.all_EUR) 

#Divergence calculation
bial <- get.biallelic.matrix(Intergenic.all_EUR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter_EUR <- sum (div & !polym,na.rm=T)
divsites_inter_EUR
D <- divsites_inter_EUR/11799
D

Intergenic.all_EUR <- neutrality.stats(Intergenic.all_EUR, do.R2 = TRUE)
get.neutrality(Intergenic.all_EUR, theta=TRUE) [[1]]
Mu <- (Intergenic.all_EUR@theta_Watterson/11799)/(4*10000)
Mu

Intergenic.all_EUR <- diversity.stats(Intergenic.all_EUR, pi=TRUE)
get.diversity(Intergenic.all_EUR) [[1]]

#Pi
individuals <- get.individuals(Intergenic.all_EUR)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 

bial <- get.biallelic.matrix(Intergenic.all_EUR,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Intergenic.all_EUR@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 6132716:148959262))) # N polyallelic sites in that region
m <- 11799-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])


Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Region 1
Intergenic1_EUR <- readVCF("new_chr7_4_intergenic.vcf.gz", numcols=10000, tid="7", from=6132716, to=6144515, include.unknown = TRUE)
Intergenic1_EUR <- set.outgroup(Intergenic1_EUR,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic1_EUR) 

#Divergence
bial <- get.biallelic.matrix(Intergenic1_EUR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter1_EUR <- sum (div & !polym,na.rm=T)
divsites_inter1_EUR
D <- divsites_inter1_EUR/11799
D

#Region 2
Intergenic2_EUR <- readVCF("new_chr7_4_intergenic.vcf.gz", numcols=10000, tid="7", from=6591067, to=6617065, include.unknown = TRUE)
Intergenic2_EUR <- set.outgroup(Intergenic2_EUR,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic2_EUR) 

#Divergence
bial <- get.biallelic.matrix(Intergenic2_EUR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter2_EUR <- sum (div & !polym,na.rm=T)
divsites_inter2_EUR
D <- divsites_inter2_EUR/25992
D

#Region 3
Intergenic3_EUR <- readVCF("new_chr7_4_intergenic.vcf.gz", numcols=10000, tid="7", from=27452510, to=27493033, include.unknown = TRUE)
Intergenic3_EUR <- set.outgroup(Intergenic3_EUR,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic3_EUR) 

#Divergence
bial <- get.biallelic.matrix(Intergenic3_EUR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter3_EUR <- sum (div & !polym,na.rm=T)
divsites_inter3_EUR
D <- divsites_inter3_EUR/37490
D

#Region 4
Intergenic4_EUR <- readVCF("new_chr7_4_intergenic.vcf.gz", numcols=10000, tid="7", from=35739379, to=35754644, include.unknown = TRUE)
Intergenic4_EUR <- set.outgroup(Intergenic4_EUR,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic4_EUR) 

#Divergence
bial <- get.biallelic.matrix(Intergenic4_EUR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter4_EUR <- sum (div & !polym,na.rm=T)
divsites_inter4_EUR
D <- divsites_inter4_EUR/15259
D

#Region 5
Intergenic5_EUR <- readVCF("new_chr7_4_intergenic.vcf.gz", numcols=10000, tid="7", from=56804283, to=56870711, include.unknown = TRUE)
Intergenic5_EUR <- set.outgroup(Intergenic5_EUR,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic5_EUR) 

#Divergence
bial <- get.biallelic.matrix(Intergenic5_EUR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter5_EUR <- sum (div & !polym,na.rm=T)
divsites_inter5_EUR
D <- divsites_inter5_EUR/64114
D

#Region 6
Intergenic6_EUR <- readVCF("new_chr7_4_intergenic.vcf.gz", numcols=10000, tid="7", from=63160819, to=63200388, include.unknown = TRUE)
Intergenic6_EUR <- set.outgroup(Intergenic6_EUR,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic6_EUR) 

#Divergence
bial <- get.biallelic.matrix(Intergenic6_EUR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter6_EUR <- sum (div & !polym,na.rm=T)
divsites_inter6_EUR
D <- divsites_inter6_EUR/39569
D

#Region 7
Intergenic7_EUR <- readVCF("new_chr7_4_intergenic.vcf.gz", numcols=10000, tid="7", from=64300619, to=64312775, include.unknown = TRUE)
Intergenic7_EUR <- set.outgroup(Intergenic7_EUR,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic7_EUR) 

#Divergence
bial <- get.biallelic.matrix(Intergenic7_EUR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter7_EUR <- sum (div & !polym,na.rm=T)
divsites_inter7_EUR
D <- divsites_inter7_EUR/12150
D

#Region 8
Intergenic8_EUR <- readVCF("new_chr7_4_intergenic.vcf.gz", numcols=10000, tid="7", from=66356278, to=66362918, include.unknown = TRUE)
Intergenic8_EUR <- set.outgroup(Intergenic8_EUR,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic8_EUR) 

#Divergence
bial <- get.biallelic.matrix(Intergenic8_EUR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter8_EUR <- sum (div & !polym,na.rm=T)
divsites_inter8_EUR
D <- divsites_inter8_EUR/1619
D

#Region 9
Intergenic9_EUR <- readVCF("new_chr7_4_intergenic.vcf.gz", numcols=10000, tid="7", from=74329339, to=74379083, include.unknown = TRUE)
Intergenic9_EUR <- set.outgroup(Intergenic9_EUR,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic9_EUR) 

#Divergence
bial <- get.biallelic.matrix(Intergenic9_EUR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter9_EUR <- sum (div & !polym,na.rm=T)
divsites_inter9_EUR
D <- divsites_inter9_EUR/49744
D

#Region 10
Intergenic10_EUR <- readVCF("new_chr7_4_intergenic.vcf.gz", numcols=10000, tid="7", from=102923213, to=102937869, include.unknown = TRUE)
Intergenic10_EUR <- set.outgroup(Intergenic10_EUR,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic10_EUR) 

#Divergence
bial <- get.biallelic.matrix(Intergenic10_EUR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter10_EUR <- sum (div & !polym,na.rm=T)
divsites_inter10_EUR
D <- divsites_inter10_EUR/14656
D

#Region 11
Intergenic11_EUR <- readVCF("new_chr7_4_intergenic.vcf.gz", numcols=10000, tid="7", from=117832878, to=117852320, include.unknown = TRUE)
Intergenic11_EUR <- set.outgroup(Intergenic11_EUR,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic11_EUR) 

#Divergence
bial <- get.biallelic.matrix(Intergenic11_EUR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter11_EUR <- sum (div & !polym,na.rm=T)
divsites_inter11_EUR
D <- divsites_inter11_EUR/19442
D

#Region 12
Intergenic12_EUR <- readVCF("new_chr7_4_intergenic.vcf.gz", numcols=10000, tid="7", from=148956112, to=148959262, include.unknown = TRUE)
Intergenic12_EUR <- set.outgroup(Intergenic12_EUR,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic12_EUR) 

#Divergence
bial <- get.biallelic.matrix(Intergenic12_EUR,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter12_EUR <- sum (div & !polym,na.rm=T)
divsites_inter12_EUR
D <- divsites_inter12_EUR/3150
D

#SAS
Intergenic.all_SAS <- readVCF("new_chr7_5_intergenic.vcf.gz", numcols=10000, tid="7", from=6132716, to=148959262,  include.unknown = TRUE)
Intergenic.all_SAS <- set.outgroup(Intergenic.all_SAS, c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic.all_SAS) 

#Divergence calculation
bial <- get.biallelic.matrix(Intergenic.all_SAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter_SAS <- sum (div & !polym,na.rm=T)
divsites_inter_SAS
D <- divsites_inter_SAS/11799
D

Intergenic.all_SAS <- neutrality.stats(Intergenic.all_SAS, do.R2 = TRUE)
get.neutrality(Intergenic.all_SAS, theta=TRUE) [[1]]
Mu <- (Intergenic.all_SAS@theta_Watterson/11799)/(4*10000)
Mu

Intergenic.all_SAS <- diversity.stats(Intergenic.all_SAS, pi=TRUE)
get.diversity(Intergenic.all_SAS) [[1]]

#Pi
individuals <- get.individuals(Intergenic.all_SAS)[[1]]
humans <- individuals[which(individuals != c("Chimp","Chimp.2"))]
n <- length(humans) 

bial <- get.biallelic.matrix(Intergenic.all_SAS,1) # Biallelic matrix
bialhuman <- bial[1:n,,drop=F] # Remove outgroup (drop = F to keep 1 dimension)
polym <- apply(bialhuman,2,sum)>0 # Sites polymorphic in humans: non REF (0) alleles
bialhuman <- bialhuman[,polym,drop=F] # Remove sites monomorphic in humans
misshuman <- colSums(is.na(bialhuman))>0 # Sites missing in humans (e.g. structural variants)
bialhuman <- bialhuman[,!misshuman,drop=FALSE] # Remove missing
polyal <- Intergenic.all_SAS@region.data@polyallelic.sites[[1]] # Positions of all polyalleles
polysites <- sum(!is.na(match(polyal, 6132716:148959262))) # N polyallelic sites in that region
m <- 11799-sum(misshuman,na.rm=T)-polysites

freqs <- apply(bialhuman,2,table)
k <- sum(freqs[1,]*freqs[2,])


Pi <- function(k,m,n) { 
  comb <- choose(n,2) # Binomial coefficient = combination without repetition
  pi <- k/(comb*m)
  return(round(pi,7))
}

Pi(k,m,n)

#Region 1
Intergenic1_SAS <- readVCF("new_chr7_5_intergenic.vcf.gz", numcols=10000, tid="7", from=6132716, to=6144515, include.unknown = TRUE)
Intergenic1_SAS <- set.outgroup(Intergenic1_SAS,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic1_SAS) 

#Divergence
bial <- get.biallelic.matrix(Intergenic1_SAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter1_SAS <- sum (div & !polym,na.rm=T)
divsites_inter1_SAS
D <- divsites_inter1_SAS/11799
D

#Region 2
Intergenic2_SAS <- readVCF("new_chr7_5_intergenic.vcf.gz", numcols=10000, tid="7", from=6591067, to=6617065, include.unknown = TRUE)
Intergenic2_SAS <- set.outgroup(Intergenic2_SAS,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic2_SAS) 

#Divergence
bial <- get.biallelic.matrix(Intergenic2_SAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter2_SAS <- sum (div & !polym,na.rm=T)
divsites_inter2_SAS
D <- divsites_inter2_SAS/25992
D

#Region 3
Intergenic3_SAS<- readVCF("new_chr7_5_intergenic.vcf.gz", numcols=10000, tid="7", from=27452510, to=27493033, include.unknown = TRUE)
Intergenic3_SAS <- set.outgroup(Intergenic3_SAS,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic3_SAS) 

#Divergence
bial <- get.biallelic.matrix(Intergenic3_SAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter3_SAS <- sum (div & !polym,na.rm=T)
divsites_inter3_SAS
D <- divsites_inter3_SAS/37490
D

#Region 4
Intergenic4_SAS <- readVCF("new_chr7_5_intergenic.vcf.gz", numcols=10000, tid="7", from=35739379, to=35754644, include.unknown = TRUE)
Intergenic4_SAS <- set.outgroup(Intergenic4_SAS,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic4_SAS) 

#Divergence
bial <- get.biallelic.matrix(Intergenic4_SAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter4_SAS <- sum (div & !polym,na.rm=T)
divsites_inter4_SAS
D <- divsites_inter4_SAS/15259
D

#Region 5
Intergenic5_SAS <- readVCF("new_chr7_5_intergenic.vcf.gz", numcols=10000, tid="7", from=56804283, to=56870711, include.unknown = TRUE)
Intergenic5_SAS <- set.outgroup(Intergenic5_SAS,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic5_SAS) 

#Divergence
bial <- get.biallelic.matrix(Intergenic5_SAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter5_SAS <- sum (div & !polym,na.rm=T)
divsites_inter5_SAS
D <- divsites_inter5_SAS/64114
D

#Region 6
Intergenic6_SAS <- readVCF("new_chr7_5_intergenic.vcf.gz", numcols=10000, tid="7", from=63160819, to=63200388, include.unknown = TRUE)
Intergenic6_SAS <- set.outgroup(Intergenic6_SAS,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic6_SAS) 

#Divergence
bial <- get.biallelic.matrix(Intergenic6_SAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter6_SAS <- sum (div & !polym,na.rm=T)
divsites_inter6_SAS
D <- divsites_inter6_SAS/39569
D

#Region 7
Intergenic7_SAS <- readVCF("new_chr7_5_intergenic.vcf.gz", numcols=10000, tid="7", from=64300619, to=64312775, include.unknown = TRUE)
Intergenic7_SAS <- set.outgroup(Intergenic7_SAS,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic7_SAS) 

#Divergence
bial <- get.biallelic.matrix(Intergenic7_SAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter7_SAS <- sum (div & !polym,na.rm=T)
divsites_inter7_SAS
D <- divsites_inter7_SAS/12150
D

#Region 8
Intergenic8_SAS <- readVCF("new_chr7_5_intergenic.vcf.gz", numcols=10000, tid="7", from=66356278, to=66362918, include.unknown = TRUE)
Intergenic8_SAS <- set.outgroup(Intergenic8_SAS,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic8_SAS) 

#Divergence
bial <- get.biallelic.matrix(Intergenic8_SAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter8_SAS <- sum (div & !polym,na.rm=T)
divsites_inter8_SAS
D <- divsites_inter8_SAS/1619
D

#Region 9
Intergenic9_SAS <- readVCF("new_chr7_5_intergenic.vcf.gz", numcols=10000, tid="7", from=74329339, to=74379083, include.unknown = TRUE)
Intergenic9_SAS <- set.outgroup(Intergenic9_SAS,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic9_SAS) 

#Divergence
bial <- get.biallelic.matrix(Intergenic9_SAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter9_SAS <- sum (div & !polym,na.rm=T)
divsites_inter9_SAS
D <- divsites_inter9_SAS/49744
D

#Region 10
Intergenic10_SAS <- readVCF("new_chr7_5_intergenic.vcf.gz", numcols=10000, tid="7", from=102923213, to=102937869, include.unknown = TRUE)
Intergenic10_SAS <- set.outgroup(Intergenic10_SAS,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic10_SAS) 

#Divergence
bial <- get.biallelic.matrix(Intergenic10_SAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter10_SAS <- sum (div & !polym,na.rm=T)
divsites_inter10_SAS
D <- divsites_inter10_SAS/14656
D

#Region 11
Intergenic11_SAS <- readVCF("new_chr7_5_intergenic.vcf.gz", numcols=10000, tid="7", from=117832878, to=117852320, include.unknown = TRUE)
Intergenic11_SAS <- set.outgroup(Intergenic11_SAS,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic11_SAS) 

#Divergence
bial <- get.biallelic.matrix(Intergenic11_SAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter11_SAS <- sum (div & !polym,na.rm=T)
divsites_inter11_SAS
D <- divsites_inter11_SAS/19442
D

#Region 12
Intergenic12_SAS <- readVCF("new_chr7_5_intergenic.vcf.gz", numcols=10000, tid="7", from=148956112, to=148959262, include.unknown = TRUE)
Intergenic12_SAS <- set.outgroup(Intergenic12_SAS,c("Chimp"), diploid=TRUE)
get.sum.data(Intergenic12_SAS) 

#Divergence
bial <- get.biallelic.matrix(Intergenic12_SAS,1)
n <- nrow(bial)-2
polym <- apply(bial[1:n,,drop=F],2,sum)>0 
div <- bial[n+1,] == 1
divsites_inter12_SAS <- sum (div & !polym,na.rm=T)
divsites_inter12_SAS
D <- divsites_inter12_SAS/3150
D

#MKT
#chi-square
MKT =rbind(c(Intergenic.all@n.biallelic.sites, divsites_inter), c(Clusters.all@n.biallelic.sites, divsites))
MKT
chisq.test(MKT, simulate.p.value=TRUE)

MKT_1=rbind(c(Intergenic1@n.biallelic.sites, divsites_inter1), c(Clusters_1@n.biallelic.sites, divsites1))
MKT_1
chisq.test(MKT_1, simulate.p.value=TRUE)

MKT_2=rbind(c(Intergenic2@n.biallelic.sites, divsites_inter2), c(Clusters_2@n.biallelic.sites, divsites2))
MKT_2
chisq.test(MKT_2, simulate.p.value=TRUE)

MKT_3=rbind(c(Intergenic3@n.biallelic.sites, divsites_inter3), c(Clusters_3@n.biallelic.sites, divsites3))
MKT_3
chisq.test(MKT_3, simulate.p.value=TRUE)

MKT_4=rbind(c(Intergenic4@n.biallelic.sites, divsites_inter4), c(Clusters_4@n.biallelic.sites, divsites4))
MKT_4
chisq.test(MKT_4, simulate.p.value=TRUE)

MKT_5=rbind(c(Intergenic5@n.biallelic.sites, divsites_inter5), c(Clusters_5@n.biallelic.sites, divsites5))
MKT_5
chisq.test(MKT_5, simulate.p.value=TRUE)

MKT_6=rbind(c(Intergenic6@n.biallelic.sites, divsites_inter6), c(Clusters_6@n.biallelic.sites, divsites6))
MKT_6
chisq.test(MKT_6, simulate.p.value=TRUE)

MKT_7=rbind(c(Intergenic7@n.biallelic.sites, divsites_inter7), c(Clusters_7@n.biallelic.sites, divsites7))
MKT_7
chisq.test(MKT_7, simulate.p.value=TRUE)

MKT_8=rbind(c(Intergenic8@n.biallelic.sites, divsites_inter8), c(Clusters_8@n.biallelic.sites, divsites8))
MKT_8
chisq.test(MKT_8, simulate.p.value=TRUE)

MKT_9=rbind(c(Intergenic9@n.biallelic.sites, divsites_inter9), c(Clusters_9@n.biallelic.sites, divsites9))
MKT_9
chisq.test(MKT_9, simulate.p.value=TRUE)

MKT_10=rbind(c(Intergenic10@n.biallelic.sites, divsites_inter10), c(Clusters_10@n.biallelic.sites, divsites10))
MKT_10
chisq.test(MKT_10, simulate.p.value=TRUE)

MKT_11=rbind(c(Intergenic11@n.biallelic.sites, divsites_inter11), c(Clusters_11@n.biallelic.sites, divsites11))
MKT_11
chisq.test(MKT_11, simulate.p.value=TRUE)

MKT_12=rbind(c(Intergenic12@n.biallelic.sites, divsites_inter12), c(Clusters_12@n.biallelic.sites, divsites12))
MKT_12
chisq.test(MKT_12, simulate.p.value=TRUE)

MKT_AFR=rbind(c(Intergenic.all_AFR@n.biallelic.sites, divsites_inter_AFR), c(Clusters.all_AFR@n.biallelic.sites, divsites_AFR))
MKT_AFR
chisq.test(MKT_AFR, simulate.p.value=TRUE)

MKT_AFR_1=rbind(c(Intergenic1_AFR@n.biallelic.sites, divsites_inter1_AFR), c(Clusters1_AFR@n.biallelic.sites, divsites1_AFR))
MKT_AFR_1
chisq.test(MKT_AFR_1, simulate.p.value=TRUE)

MKT_AFR_2=rbind(c(Intergenic2_AFR@n.biallelic.sites, divsites_inter2_AFR), c(Clusters2_AFR@n.biallelic.sites, divsites2_AFR))
MKT_AFR_2
chisq.test(MKT_AFR_2, simulate.p.value=TRUE)

MKT_AFR_3=rbind(c(Intergenic3_AFR@n.biallelic.sites, divsites_inter3_AFR), c(Clusters3_AFR@n.biallelic.sites, divsites3_AFR))
MKT_AFR_3
chisq.test(MKT_AFR_3, simulate.p.value=TRUE)

MKT_AFR_4=rbind(c(Intergenic4_AFR@n.biallelic.sites, divsites_inter4_AFR), c(Clusters4_AFR@n.biallelic.sites, divsites4_AFR))
MKT_AFR_4
chisq.test(MKT_AFR_4, simulate.p.value=TRUE)

MKT_AFR_5=rbind(c(Intergenic5_AFR@n.biallelic.sites, divsites_inter5_AFR), c(Clusters5_AFR@n.biallelic.sites, divsites5_AFR))
MKT_AFR_5
chisq.test(MKT_AFR_5, simulate.p.value=TRUE)

MKT_AFR_6=rbind(c(Intergenic6_AFR@n.biallelic.sites, divsites_inter6_AFR), c(Clusters6_AFR@n.biallelic.sites, divsites6_AFR))
MKT_AFR_6
chisq.test(MKT_AFR_6, simulate.p.value=TRUE)

MKT_AFR_7=rbind(c(Intergenic7_AFR@n.biallelic.sites, divsites_inter7_AFR), c(Clusters7_AFR@n.biallelic.sites, divsites7_AFR))
MKT_AFR_7
chisq.test(MKT_AFR_7, simulate.p.value=TRUE)

MKT_AFR_8=rbind(c(Intergenic8_AFR@n.biallelic.sites, divsites_inter8_AFR), c(Clusters8_AFR@n.biallelic.sites, divsites8_AFR))
MKT_AFR_8
chisq.test(MKT_AFR_8, simulate.p.value=TRUE)

MKT_AFR_9=rbind(c(Intergenic9_AFR@n.biallelic.sites, divsites_inter9_AFR), c(Clusters9_AFR@n.biallelic.sites, divsites9_AFR))
MKT_AFR_9
chisq.test(MKT_AFR_9, simulate.p.value=TRUE)

MKT_AFR_10=rbind(c(Intergenic10_AFR@n.biallelic.sites, divsites_inter10_AFR), c(Clusters10_AFR@n.biallelic.sites, divsites10_AFR))
MKT_AFR_10
chisq.test(MKT_AFR_10, simulate.p.value=TRUE)

MKT_AFR_11=rbind(c(Intergenic11_AFR@n.biallelic.sites, divsites_inter11_AFR), c(Clusters11_AFR@n.biallelic.sites, divsites11_AFR))
MKT_AFR_11
chisq.test(MKT_AFR_11, simulate.p.value=TRUE)

MKT_AFR_12=rbind(c(Intergenic12_AFR@n.biallelic.sites, divsites_inter12_AFR), c(Clusters12_AFR@n.biallelic.sites, divsites12_AFR))
MKT_AFR_12
chisq.test(MKT_AFR_12, simulate.p.value=TRUE)

MKT_AMR=rbind(c(Intergenic.all_AMR@n.biallelic.sites, divsites_inter_AMR), c(Clusters.all_AMR@n.biallelic.sites, divsites_AMR))
MKT_AMR
chisq.test(MKT_AMR, simulate.p.value=TRUE)

MKT_AMR_1=rbind(c(Intergenic1_AMR@n.biallelic.sites, divsites_inter1_AMR), c(Clusters1_AMR@n.biallelic.sites, divsites1_AMR))
MKT_AMR_1
chisq.test(MKT_AMR_1, simulate.p.value=TRUE)

MKT_AMR_2=rbind(c(Intergenic2_AMR@n.biallelic.sites, divsites_inter2_AMR), c(Clusters2_AMR@n.biallelic.sites, divsites2_AMR))
MKT_AMR_2
chisq.test(MKT_AMR_2, simulate.p.value=TRUE)

MKT_AMR_3=rbind(c(Intergenic3_AMR@n.biallelic.sites, divsites_inter3_AMR), c(Clusters3_AMR@n.biallelic.sites, divsites3_AMR))
MKT_AMR_3
chisq.test(MKT_AMR_3, simulate.p.value=TRUE)

MKT_AMR_4=rbind(c(Intergenic4_AMR@n.biallelic.sites, divsites_inter4_AMR), c(Clusters4_AMR@n.biallelic.sites, divsites4_AMR))
MKT_AMR_4
chisq.test(MKT_AMR_4, simulate.p.value=TRUE)

MKT_AMR_5=rbind(c(Intergenic5_AMR@n.biallelic.sites, divsites_inter5_AMR), c(Clusters5_AMR@n.biallelic.sites, divsites5_AMR))
MKT_AMR_5
chisq.test(MKT_AMR_5, simulate.p.value=TRUE)

MKT_AMR_6=rbind(c(Intergenic6_AMR@n.biallelic.sites, divsites_inter6_AMR), c(Clusters6_AMR@n.biallelic.sites, divsites6_AMR))
MKT_AMR_6
chisq.test(MKT_AMR_6, simulate.p.value=TRUE)

MKT_AMR_7=rbind(c(Intergenic7_AMR@n.biallelic.sites, divsites_inter7_AMR), c(Clusters7_AMR@n.biallelic.sites, divsites7_AMR))
MKT_AMR_7
chisq.test(MKT_AMR_7, simulate.p.value=TRUE)

MKT_AMR_8=rbind(c(Intergenic8_AMR@n.biallelic.sites, divsites_inter8_AMR), c(Clusters8_AMR@n.biallelic.sites, divsites8_AMR))
MKT_AMR_8
chisq.test(MKT_AMR_8, simulate.p.value=TRUE)

MKT_AMR_9=rbind(c(Intergenic9_AMR@n.biallelic.sites, divsites_inter9_AMR), c(Clusters9_AMR@n.biallelic.sites, divsites9_AMR))
MKT_AMR_9
chisq.test(MKT_AMR_9, simulate.p.value=TRUE)

MKT_AMR_10=rbind(c(Intergenic10_AMR@n.biallelic.sites, divsites_inter10_AMR), c(Clusters10_AMR@n.biallelic.sites, divsites10_AMR))
MKT_AMR_10
chisq.test(MKT_AMR_10, simulate.p.value=TRUE)

MKT_AMR_11=rbind(c(Intergenic11_AMR@n.biallelic.sites, divsites_inter11_AMR), c(Clusters11_AMR@n.biallelic.sites, divsites11_AMR))
MKT_AMR_11
chisq.test(MKT_AMR_11, simulate.p.value=TRUE)

MKT_AMR_12=rbind(c(Intergenic12_AMR@n.biallelic.sites, divsites_inter12_AMR), c(Clusters12_AMR@n.biallelic.sites, divsites12_AMR))
MKT_AMR_12
chisq.test(MKT_AMR_12, simulate.p.value=TRUE)


MKT_EAS=rbind(c(Intergenic.all_EAS@n.biallelic.sites, divsites_inter_EAS), c(Clusters.all_EAS@n.biallelic.sites, divsites_EAS))
MKT_EAS
chisq.test(MKT_EAS, simulate.p.value=TRUE)

MKT_EAS_1=rbind(c(Intergenic1_EAS@n.biallelic.sites, divsites_inter1_EAS), c(Clusters1_EAS@n.biallelic.sites, divsites1_EAS))
MKT_EAS_1
chisq.test(MKT_EAS_1, simulate.p.value=TRUE)

MKT_EAS_2=rbind(c(Intergenic2_EAS@n.biallelic.sites, divsites_inter2_EAS), c(Clusters2_EAS@n.biallelic.sites, divsites2_EAS))
MKT_EAS_2
chisq.test(MKT_EAS_2, simulate.p.value=TRUE)

MKT_EAS_3=rbind(c(Intergenic3_EAS@n.biallelic.sites, divsites_inter3_EAS), c(Clusters3_EAS@n.biallelic.sites, divsites3_EAS))
MKT_EAS_3
chisq.test(MKT_EAS_3, simulate.p.value=TRUE)

MKT_EAS_4=rbind(c(Intergenic4_EAS@n.biallelic.sites, divsites_inter4_EAS), c(Clusters4_EAS@n.biallelic.sites, divsites4_EAS))
MKT_EAS_4
chisq.test(MKT_EAS_4, simulate.p.value=TRUE)

MKT_EAS_5=rbind(c(Intergenic5_EAS@n.biallelic.sites, divsites_inter5_EAS), c(Clusters5_EAS@n.biallelic.sites, divsites5_EAS))
MKT_EAS_5
chisq.test(MKT_EAS_5, simulate.p.value=TRUE)

MKT_EAS_6=rbind(c(Intergenic6_EAS@n.biallelic.sites, divsites_inter6_EAS), c(Clusters6_EAS@n.biallelic.sites, divsites6_EAS))
MKT_EAS_6
chisq.test(MKT_EAS_6, simulate.p.value=TRUE)

MKT_EAS_7=rbind(c(Intergenic7_EAS@n.biallelic.sites, divsites_inter7_EAS), c(Clusters7_EAS@n.biallelic.sites, divsites7_EAS))
MKT_EAS_7
chisq.test(MKT_EAS_7, simulate.p.value=TRUE)

MKT_EAS_8=rbind(c(Intergenic8_EAS@n.biallelic.sites, divsites_inter8_EAS), c(Clusters8_EAS@n.biallelic.sites, divsites8_EAS))
MKT_EAS_8
chisq.test(MKT_EAS_8, simulate.p.value=TRUE)

MKT_EAS_9=rbind(c(Intergenic9_EAS@n.biallelic.sites, divsites_inter9_EAS), c(Clusters9_EAS@n.biallelic.sites, divsites9_EAS))
MKT_EAS_9
chisq.test(MKT_EAS_9, simulate.p.value=TRUE)

MKT_EAS_10=rbind(c(Intergenic10_EAS@n.biallelic.sites, divsites_inter10_EAS), c(Clusters10_EAS@n.biallelic.sites, divsites10_EAS))
MKT_EAS_10
chisq.test(MKT_EAS_10, simulate.p.value=TRUE)

MKT_EAS_11=rbind(c(Intergenic11_EAS@n.biallelic.sites, divsites_inter11_EAS), c(Clusters11_EAS@n.biallelic.sites, divsites11_EAS))
MKT_EAS_11
chisq.test(MKT_EAS_11, simulate.p.value=TRUE)

MKT_EAS_12=rbind(c(Intergenic12_EAS@n.biallelic.sites, divsites_inter12_EAS), c(Clusters12_EAS@n.biallelic.sites, divsites12_EAS))
MKT_EAS_12
chisq.test(MKT_EAS_12, simulate.p.value=TRUE)

MKT_EUR=rbind(c(Intergenic.all_EUR@n.biallelic.sites, divsites_inter_EUR), c(Clusters.all_EUR@n.biallelic.sites, divsites_EUR))
MKT_EUR
chisq.test(MKT_EUR, simulate.p.value=TRUE)

MKT_EUR_1=rbind(c(Intergenic1_EUR@n.biallelic.sites, divsites_inter1_EUR), c(Clusters1_EUR@n.biallelic.sites, divsites1_EUR))
MKT_EUR_1
chisq.test(MKT_EUR_1, simulate.p.value=TRUE)

MKT_EUR_2=rbind(c(Intergenic2_EUR@n.biallelic.sites, divsites_inter2_EUR), c(Clusters2_EUR@n.biallelic.sites, divsites2_EUR))
MKT_EUR_2
chisq.test(MKT_EUR_2, simulate.p.value=TRUE)

MKT_EUR_3=rbind(c(Intergenic3_EUR@n.biallelic.sites, divsites_inter3_EUR), c(Clusters3_EUR@n.biallelic.sites, divsites3_EUR))
MKT_EUR_3
chisq.test(MKT_EUR_3, simulate.p.value=TRUE)

MKT_EUR_4=rbind(c(Intergenic4_EUR@n.biallelic.sites, divsites_inter4_EUR), c(Clusters4_EUR@n.biallelic.sites, divsites4_EUR))
MKT_EUR_4
chisq.test(MKT_EUR_4, simulate.p.value=TRUE)

MKT_EUR_5=rbind(c(Intergenic5_EUR@n.biallelic.sites, divsites_inter5_EUR), c(Clusters5_EUR@n.biallelic.sites, divsites5_EUR))
MKT_EUR_5
chisq.test(MKT_EUR_5, simulate.p.value=TRUE)

MKT_EUR_6=rbind(c(Intergenic6_EUR@n.biallelic.sites, divsites_inter6_EUR), c(Clusters6_EUR@n.biallelic.sites, divsites6_EUR))
MKT_EUR_6
chisq.test(MKT_EUR_6, simulate.p.value=TRUE)

MKT_EUR_7=rbind(c(Intergenic7_EUR@n.biallelic.sites, divsites_inter7_EUR), c(Clusters7_EUR@n.biallelic.sites, divsites7_EUR))
MKT_EUR_7
chisq.test(MKT_EUR_7, simulate.p.value=TRUE)

MKT_EUR_8=rbind(c(Intergenic8_EUR@n.biallelic.sites, divsites_inter8_EUR), c(Clusters8_EUR@n.biallelic.sites, divsites8_EUR))
MKT_EUR_8
chisq.test(MKT_EUR_8, simulate.p.value=TRUE)

MKT_EUR_9=rbind(c(Intergenic9_EUR@n.biallelic.sites, divsites_inter9_EUR), c(Clusters9_EUR@n.biallelic.sites, divsites9_EUR))
MKT_EUR_9
chisq.test(MKT_EUR_9, simulate.p.value=TRUE)

MKT_EUR_10=rbind(c(Intergenic10_EUR@n.biallelic.sites, divsites_inter10_EUR), c(Clusters10_EUR@n.biallelic.sites, divsites10_EUR))
MKT_EUR_10
chisq.test(MKT_EUR_10, simulate.p.value=TRUE)

MKT_EUR_11=rbind(c(Intergenic11_EUR@n.biallelic.sites, divsites_inter11_EUR), c(Clusters11_EUR@n.biallelic.sites, divsites11_EUR))
MKT_EUR_11
chisq.test(MKT_EUR_11, simulate.p.value=TRUE)

MKT_EUR_12=rbind(c(Intergenic12_EUR@n.biallelic.sites, divsites_inter12_EUR), c(Clusters12_EUR@n.biallelic.sites, divsites12_EUR))
MKT_EUR_12
chisq.test(MKT_EUR_12, simulate.p.value=TRUE)

MKT_SAS=rbind(c(Intergenic.all_SAS@n.biallelic.sites, divsites_inter_SAS), c(Clusters.all_SAS@n.biallelic.sites, divsites_SAS))
MKT_SAS
chisq.test(MKT_SAS, simulate.p.value=TRUE)

MKT_SAS_1=rbind(c(Intergenic1_SAS@n.biallelic.sites, divsites_inter1_SAS), c(Clusters1_SAS@n.biallelic.sites, divsites1_SAS))
MKT_SAS_1
chisq.test(MKT_SAS_1, simulate.p.value=TRUE)

MKT_SAS_2=rbind(c(Intergenic2_SAS@n.biallelic.sites, divsites_inter2_SAS), c(Clusters2_SAS@n.biallelic.sites, divsites2_SAS))
MKT_SAS_2
chisq.test(MKT_SAS_2, simulate.p.value=TRUE)

MKT_SAS_3=rbind(c(Intergenic3_SAS@n.biallelic.sites, divsites_inter3_SAS), c(Clusters3_SAS@n.biallelic.sites, divsites3_SAS))
MKT_SAS_3
chisq.test(MKT_SAS_3, simulate.p.value=TRUE)

MKT_SAS_4=rbind(c(Intergenic4_SAS@n.biallelic.sites, divsites_inter4_SAS), c(Clusters4_SAS@n.biallelic.sites, divsites4_SAS))
MKT_SAS_4
chisq.test(MKT_SAS_4, simulate.p.value=TRUE)

MKT_SAS_5=rbind(c(Intergenic5_SAS@n.biallelic.sites, divsites_inter5_SAS), c(Clusters5_SAS@n.biallelic.sites, divsites5_SAS))
MKT_SAS_5
chisq.test(MKT_SAS_5, simulate.p.value=TRUE)

MKT_SAS_6=rbind(c(Intergenic6_SAS@n.biallelic.sites, divsites_inter6_SAS), c(Clusters6_SAS@n.biallelic.sites, divsites6_SAS))
MKT_SAS_6
chisq.test(MKT_SAS_6, simulate.p.value=TRUE)

MKT_SAS_7=rbind(c(Intergenic7_SAS@n.biallelic.sites, divsites_inter7_SAS), c(Clusters7_SAS@n.biallelic.sites, divsites7_SAS))
MKT_SAS_7
chisq.test(MKT_SAS_7, simulate.p.value=TRUE)

MKT_SAS_8=rbind(c(Intergenic8_SAS@n.biallelic.sites, divsites_inter8_SAS), c(Clusters8_SAS@n.biallelic.sites, divsites8_SAS))
MKT_SAS_8
chisq.test(MKT_SAS_8, simulate.p.value=TRUE)

MKT_SAS_9=rbind(c(Intergenic9_SAS@n.biallelic.sites, divsites_inter9_SAS), c(Clusters9_SAS@n.biallelic.sites, divsites9_SAS))
MKT_SAS_9
chisq.test(MKT_SAS_9, simulate.p.value=TRUE)

MKT_SAS_10=rbind(c(Intergenic10_SAS@n.biallelic.sites, divsites_inter10_SAS), c(Clusters10_SAS@n.biallelic.sites, divsites10_SAS))
MKT_SAS_10
chisq.test(MKT_SAS_10, simulate.p.value=TRUE)

MKT_SAS_11=rbind(c(Intergenic11_SAS@n.biallelic.sites, divsites_inter11_SAS), c(Clusters11_SAS@n.biallelic.sites, divsites11_SAS))
MKT_SAS_11
chisq.test(MKT_SAS_11, simulate.p.value=TRUE)

MKT_SAS_12=rbind(c(Intergenic12_SAS@n.biallelic.sites, divsites_inter12_SAS), c(Clusters12_SAS@n.biallelic.sites, divsites12_SAS))
MKT_SAS_12
chisq.test(MKT_SAS_12, simulate.p.value=TRUE)

